<h1>
<a name="select-API%3ADB%3Aselect"></a>API:DB:select
</h1>

<div class='panelMacro'>
<table class='infoMacro'>
<colgroup>
<col width='24' />
<col />
</colgroup>

<tr>
<td valign='top'>
<img src="/images/icons/emoticons/information.gif" width="16" height="16" align="absmiddle" alt="" border="0" />
</td>
<td>
<b>API Quick reference</b>
<br />

<div class='table-wrap'>
<table class='confluenceTable'>
<tbody>
<tr>
<td class='confluenceTd'>
Variable name:
</td>
<td class='confluenceTd'>
select
</td>
</tr>

<tr>
<td class='confluenceTd'>
Modx versions:
</td>
<td class='confluenceTd'>
0.9.x + Evolution
</td>
</tr>

<tr>
<td class='confluenceTd'>
Input parameters:
</td>
<td class='confluenceTd'>
([string $fields [, string $from [, string $where [, string $orderby [, string $limit]]]]])
</td>
</tr>

<tr>
<td class='confluenceTd'>
Return if successful:
</td>
<td class='confluenceTd'>
resource
</td>
</tr>

<tr>
<td class='confluenceTd'>
Return type:
</td>
<td class='confluenceTd'>
resource
</td>
</tr>

<tr>
<td class='confluenceTd'>
Return on failure:
</td>
<td class='confluenceTd'>
false
</td>
</tr>

<tr>
<td class='confluenceTd'>
Object parent:
</td>
<td class='confluenceTd'>
<a href="/display/MODx096/DocumentParser+Object" title="DocumentParser Object">DocumentParser</a> -&gt; <a href="/display/MODx096/DBAPI" title="DBAPI">DBAPI</a>
</td>
</tr>
</tbody>
</table>
</div>
</td>
</tr>
</table>
</div>

<h2>
<a name="select-Description"></a>Description
</h2>

<div class="code panel" style="border-width: 1px;">
<div class="codeContent panelContent">
<pre class="code-java">
resource select([string $fields [, string $from [, string $where [, string $orderby [, string $limit]]]]])
</pre>
</div>
</div>

<p>
The select function is a simple wrapper for the SQL SELECT query. select() sends a query to the currently active database, $this-&gt;conn as created when connect() is called. This function is analogous to mysql_query() except the query string is broken up into 5 parts. Only the $from field is required for a meaningful result.
</p>

<p>
*Parameter $fields are the field or column name(s) that you want returned. If left blank it will default to all (*).
<br />
*$from is the table to query. If left blank function will return false.
<br />
*$where is the full string of the WHERE clause of the mysql query. Leave blank to do no WHERE matching.
<br />
*$orderby, if needed, can either be 'ASC' or 'DESC'.
<br />
*$limit is the limit of the number of results to return, leave blank for all
</p>

<h2>
<a name="select-Usage%2FExamples"></a>Usage / Examples
</h2>

<div class="code panel" style="border-width: 1px;">
<div class="codeContent panelContent">
<pre class="code-java">
$results = $modx-&gt;db-&gt;select(<span class="code-quote">"field1, field2"</span>, <span class="code-quote">"table"</span>, <span class="code-quote">"field = value"</span>, <span class="code-quote">"field to order by"</span>, <span class="code-quote">"limit value"</span>); 
</pre>
</div>
</div>

<p>
This example login function uses the select function to get the id of a user given the username and password.
</p>

<div class="code panel" style="border-width: 1px;">
<div class="codeContent panelContent">
<pre class="code-java">
function login($username, $password)
{
   global $modx;
   $username = $modx-&gt;db-&gt;escape($username); <span class="code-comment">// <span class="code-keyword">this</span> should have been done with the POST
</span>   $password = $modx-&gt;db-&gt;escape($password); <span class="code-comment">// values before passing them to the function
</span> 
   $res = $modx-&gt;db-&gt;select(<span class="code-quote">"id"</span>, $modx-&gt;getFullTableName('web_users'), 
      <span class="code-quote">"username='"</span> . $username .<span class="code-quote">"' AND password='"</span>.md5($password).<span class="code-quote">"'"</span>);
   <span class="code-keyword">if</span>($modx-&gt;db-&gt;getRecordCount($res))
   {
      $id = $modx-&gt;db-&gt;getValue($res);
      $_SESSION['userid'] = $id;
      <span class="code-comment">//other log in things...
</span>   }
   <span class="code-keyword">else</span>
   {
      <span class="code-comment">//incorrect login
</span>   }
}
</pre>
</div>
</div>

<p>
Example2:
</p>

<div class="code panel" style="border-width: 1px;">
<div class="codeContent panelContent">
<pre class="code-java">
$userId = $modx-&gt;getLoginUserID();
$table = $modx-&gt;getFullTableName(<span class="code-quote">"user_messages"</span>);
$messages = $modx-&gt;db-&gt;select(<span class="code-quote">"subject, message, sender"</span>, $table, <span class="code-quote">"recipient = $userId"</span>, <span class="code-quote">"postdate DESC"</span>, <span class="code-quote">"10"</span>); 
</pre>
</div>
</div>

<p>
This will return the subject, message and sender of the latest 10 messages for the current user.
</p>

<h2>
<a name="select-Related"></a>Related
</h2>

<p>
<span class="error">[getRecordCount]</span>(), <a href="/display/MODx096/query" title="query">query</a>(), <span class="error">[getRow]</span>(), <span class="error">[makeArray]</span>().
</p>

<h2>
<a name="select-Notes"></a>Notes
</h2>

<p>
One could easily use mysql_query($qry) instead of this function, however it is preferred to use this function, especially for modx table calls, to ensure future compatibility should their be any changes to the way modx queries the database (eg: changing to mysqli_query(), or using another database type altogether).
</p>

<h2>
<a name="select-FunctionSource"></a>Function Source
</h2>

<p>
File: manager/includes/extenders/dbapi.class.inc.php
<br />
Line: 169
</p>

<div class="code panel" style="border-width: 1px;">
<div class="codeContent panelContent">
<pre class="code-java">
function select($fields = <span class="code-quote">"*"</span>, $from = <span class="code-quote">"", $where = "</span><span class="code-quote">", $orderby = "</span><span class="code-quote">", $limit = "</span>") {
   <span class="code-keyword">if</span> (!$from)
      <span class="code-keyword">return</span> <span class="code-keyword">false</span>;
   <span class="code-keyword">else</span> {
      $table = $from;
      $where = ($where != <span class="code-quote">"") ? "</span>WHERE $where<span class="code-quote">" : "</span>";
      $orderby = ($orderby != <span class="code-quote">"") ? "</span>ORDER BY $orderby <span class="code-quote">" : "</span>";
      $limit = ($limit != <span class="code-quote">"") ? "</span>LIMIT $limit<span class="code-quote">" : "</span>";
      <span class="code-keyword">return</span> $<span class="code-keyword">this</span>-&gt;query(<span class="code-quote">"SELECT $fields FROM $table $where $orderby $limit"</span>);
   }
}
</pre>
</div>
</div>