<div class="panel" style="border-width: 1px;">
<div class="panelContent">
<p>
Supported In: Revolution 2.0
</p>
</div>
</div>

<p>
Used in a plugin that fires on the "OnBeforeDocFormSave" event, this code will&nbsp;
</p>

<ul>
<li>collect all MODx tags in the resource content
</li>

<li>Add an output filter to each link tag (only if the linked resource is a weblink resource)
</li>
</ul>

<div class="code panel" style="border-width: 1px;">
<div class="codeContent panelContent">
<pre class="code-java">
  $content = $resource-&gt;get('content');
  $parser = $modx-&gt;getParser();
  $tags = array();
  $count = $parser-&gt;collectElementTags($content, $tags);

  foreach($tags as $v) {

    $idx = strpos($v[1],'~');
    <span class="code-keyword">if</span> ( in_array($idx, array(0,1)) ) {
      $idx+= 1; 
      $resID = '';
      <span class="code-keyword">while</span> (is_numeric(substr($v[1],$idx,1))) {
        $resID .= substr($v[1],$idx,1);
        $idx++;
      }
      $res = $modx-&gt;getObject('modResource',$resID);
      
      <span class="code-keyword">if</span> ($res-&gt;get('class_key') == 'modWebLink') {
        <span class="code-keyword">if</span> (!(strstr($v[1],':ex'))) {
          $content = str_replace($v[1], $v[1] . ':ex',$content);
        }
      }  
    }
  }
  $resource-&gt;set('content',  $content );?????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????

</pre>
</div>
</div>

<p>
If the resource content looks like this when the user hits "save" :
</p>

<div class="code panel" style="border-width: 1px;">
<div class="codeContent panelContent">
<pre class="code-java">
&lt;p&gt;&lt;a href=<span class="code-quote">"[[~33]]"</span>&gt;Resource #33 is a standard document resource&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=<span class="code-quote">"[[~44]]"</span>&gt;Resource #44 is a weblink resource&lt;/a&gt;&lt;/p&gt;
</pre>
</div>
</div>

<p>
...it will look like this after the save:
</p>

<div class="code panel" style="border-width: 1px;">
<div class="codeContent panelContent">
<pre class="code-java">
&lt;p&gt;&lt;a href=<span class="code-quote">"[[~33]]"</span>&gt;Resource #33 is a standard document resource&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=<span class="code-quote">"[[~44:ex]]"</span>&gt;Resource #44 is a weblink resource&lt;/a&gt;&lt;/p&gt;
</pre>
</div>
</div>

<p>
<br class="atl-forced-newline" />
</p>