<h2>
<a name="SELECTBinding-Whatisthe@SELECTBinding%3F"></a>What is the @SELECT Binding?
</h2>

<p>
The @SELECT binding calls a database query based on the provided value and returns the result.
</p>

<h2>
<a name="SELECTBinding-Syntax" id="SELECTBinding-Syntax"></a>Syntax
</h2>

<pre class="brush: php">
    @SELECT `username` AS `name`,`id` FROM `[[+PREFIX]]users` WHERE `active` = 1
    
</pre>
<h2>
<a name="SELECTBinding-Alternatives" id="SELECTBinding-Alternatives"></a>Alternatives
</h2>

<p>
Before we get any more complicated, consider doing this a different way. A <a href="display/revolution20/Snippets" title="Snippets">Snippet</a> might do the job more easily than a binding.
</p>

<p>
If your query needs to work with template variables and you need specialized formatting for the output, the @SELECT binding is probably not the way to go. Pretty much everything that's done with the bindings is also possible with <a href="display/revolution20/Snippets" title="Snippets">Snippets</a>; the bindings just provide a shortcut. When you start over-using the shortcut, you may run into headaches.
</p>

<h2>
<a name="SELECTBinding-HavingablankOption" id="SELECTBinding-HavingablankOption"></a>Having a blank Option
</h2>

<p>
Select queries are a great way to power a listbox dropdown, but since they ALWAYS return results, it can be problematic if you want your dropdown to have an empty option? We can rely on MySQL's "UNION ALL" feature to accomplish this.
</p>

<p>
Consider the following query:
</p>

<pre class="brush: php">
    
SELECT
        page.alias,
        tv_val.value,
        DATE_FORMAT(STR_TO_DATE(tv_val.value, '%d-%m-%Y %H:%i:%s'), '%Y-%m-%d %H:%i:%s') as `Formatted Opening Date`,

FROM site_content as page
JOIN site_tmplvar_contentvalues as tv_val ON page.id=tv_val.id
WHERE
        page.parent='95'
        AND tv_val.tmplvarid='6' /* 6 is the opening_date */
        AND DATE_FORMAT(STR_TO_DATE(tv_val.value, '%d-%m-%Y %H:%i:%s'), '%Y-%m-%d %H:%i:%s')&gt;'2008-10-24 13:04:57'
;

    
</pre>
<div class="note">
MODx uses the MyISAM table engine, not InnoDB, so it does not rigidly enforce the foreign key constraints that are inferred by the table structure.
</div>

<h2>
<a name="SELECTBinding-Errors" id="SELECTBinding-Errors"></a>Errors
</h2>

<p>
What if your MySQL statement executes perfectly, but once you put it in your SELECT binding, it fails? Well, there are some pit-falls. The implementation isn't perfect. Pay close attention to the following:
</p>

<ul>
<li>Your query <b>MUST</b> appear on one line. Newline characters cause the @SELECT binding to choke.
</li>

<li>Delete all MySQL comments /* this style */ and -- this style
</li>

<li>Make sure you have entered the table names correctly! Many sites use table-prefixes, so it is imperative that you test your queries before trying to use them in a @SELECT Binding. If your query has an error, MODx will log the error to the error log.
</li>
</ul>

<h2>
<a name="SELECTBinding-NextStep%3AFormatting"></a>Next Step: Formatting
</h2>

<p>
Ok, so you can return a bunch of data from the database... now what? If you need to format it intelligently, you might get some mileage out of the Output Renders, but you might find the available options limiting to you. You can write your own <a href="display/revolution20/Snippets" title="Snippets">Snippet</a> that formats the value of a Template Variable.
</p>

<h2>
<a name="SELECTBinding-Security" id="SELECTBinding-Security"></a>Security
</h2>

<p>
Does this binding let you execute UPDATE, INSERT, or DELETE queries (or, <b>gasp</b>, DROP TABLE statements)? Even if it doesn't <em>directly</em> support this, you may be able to construct and execute a complex query that SELECT's the result of a such a destructive query. At the very least, a user could construct a query to select another user's password hash or to see documents that the user isn't supposed to have access to. A lot of the CMS's out there give <b>full</b> access to the database (including DROP and DELETE statements) with the database handle used by the application. That's dangerous, and the @SELECT binding may expose some of those same vulnerabilities.
</p>

<h2>
<a name="SELECTBinding-SeeAlso" id="SELECTBinding-SeeAlso"></a>See Also
</h2>

<ul>
<li>
<a href="display/revolution20/Template+Variables" title="Template Variables">Template Variables</a>
</li>

<li>
<a href="display/revolution20/Bindings" title="Bindings">Bindings</a>
</li>
</ul>