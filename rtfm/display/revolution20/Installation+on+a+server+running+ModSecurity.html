<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
            <title>Installation on a server running ModSecurity - MODx Revolution 2.x - MODX Documentation</title>
    
        

                        
    

            
<meta id="confluence-context-path" name="confluence-context-path" content="">
<meta id="atlassian-token" name="atlassian-token" content="eLRsD4PArs">
<meta id="confluence-space-key" name="confluence-space-key" content="revolution20">

<script type="text/javascript">
    // Deprecated global variables. To be removed in a future version of Confluence.
    var contextPath = '';
</script>

    

<!-- include system css resources -->
<link type="text/css" rel="stylesheet" href="/s/1911/69/2/_/download/superbatch/css/batch.css" media="all">
<!--[if IE]>
<link type="text/css" rel="stylesheet" href="/s/1911/69/2/_/download/superbatch/css/batch.css?ieonly=true" media="all">
<![endif]-->
<link type="text/css" rel="stylesheet" href="/s/1911/69/2/_/download/superbatch/css/batch.css?media=print" media="print">
<link type="text/css" rel="stylesheet" href="/s/1911/69/1.20/_/download/batch/com.atlassian.confluence.plugins.pagetree:pagetree-resources/com.atlassian.confluence.plugins.pagetree:pagetree-resources.css" media="all">
<link type="text/css" rel="stylesheet" href="/s/1911/69/1.0/_/download/batch/confluence.web.resources:view-comment/confluence.web.resources:view-comment.css" media="all">
<!--[if IE]>
<link type="text/css" rel="stylesheet" href="/s/1911/69/1.0/_/download/batch/confluence.web.resources:view-comment/confluence.web.resources:view-comment.css?ieonly=true" media="all">
<![endif]-->
<link type="text/css" rel="stylesheet" href="/s/1911/69/1.9.3/_/download/batch/confluence.macros.advanced:fancy-box/confluence.macros.advanced:fancy-box.css" media="all">
<link type="text/css" rel="stylesheet" href="/s/1911/69/1.0.8/_/download/batch/com.atlassian.confluence.plugins.drag-and-drop:support/com.atlassian.confluence.plugins.drag-and-drop:support.css" media="all">
<link type="text/css" rel="stylesheet" href="/s/1911/69/1.0/_/download/resources/confluence.web.resources:aui-forms/confluence-forms.css" media="all">
<!--[if IE]>
<link type="text/css" rel="stylesheet" href="/s/1911/69/1.0/_/download/batch/confluence.web.resources:aui-forms/confluence.web.resources:aui-forms.css?ieonly=true" media="all">
<![endif]-->

<!-- end system css resources -->

    <link rel="stylesheet" href="/s/1911/69/6/_/styles/combined.css?spaceKey=revolution20" type="text/css">

    <meta name="confluence-request-time" content="1381730225201">

<meta name="loggedInUsername" content="">
    
    <link rel="shortcut icon" href="/favicon.ico">
    <link rel="icon" type="image/png" href="/s/1911/69/_/images/logo/confluence_16.png">

<link rel="search" type="application/opensearchdescription+xml" href="/opensearch/osd.action" title="MODX Documentation"/>

        <!-- include system javascript resources -->
                        
    
    <script type="text/javascript" src="/s/1911/69/2/_/download/superbatch/js/batch.js" ></script>
<script type="text/javascript" src="/s/1911/69/1.20/_/download/batch/com.atlassian.confluence.plugins.pagetree:pagetree-resources/com.atlassian.confluence.plugins.pagetree:pagetree-resources.js" ></script>
<script type="text/javascript" src="/s/1911/69/1.9.3/_/download/batch/confluence.macros.advanced:fancy-box/confluence.macros.advanced:fancy-box.js" ></script>
<script type="text/javascript" src="/s/1911/69/1.9.3/_/download/batch/confluence.macros.advanced:thumbnail-images/confluence.macros.advanced:thumbnail-images.js" ></script>
<script type="text/javascript" src="/s/1911/69/3.3/_/download/batch/com.atlassian.confluence.plugins.fixedwidth-theme:fixedwidth-resources/com.atlassian.confluence.plugins.fixedwidth-theme:fixedwidth-resources.js" ></script>
<script type="text/javascript" src="/s/1911/69/1.0.8/_/download/batch/com.atlassian.confluence.plugins.drag-and-drop:support/com.atlassian.confluence.plugins.drag-and-drop:support.js" ></script>
<script type="text/javascript" src="/s/1911/69/1.0.8/_/download/batch/com.atlassian.confluence.plugins.drag-and-drop:drag-and-drop-for-view-content/com.atlassian.confluence.plugins.drag-and-drop:drag-and-drop-for-view-content.js" ></script>
<script type="text/javascript" src="/s/1911/69/1.2/_/download/batch/com.atlassian.confluence.plugins.doctheme:splitter/com.atlassian.confluence.plugins.doctheme:splitter.js" ></script>
<script type="text/javascript" src="/s/1911/69/1.0/_/download/batch/legacy.confluence.web.resources:prototype/legacy.confluence.web.resources:prototype.js" ></script>

    <!-- end system javascript resources -->

    <link type="text/css" rel="stylesheet" href="http://misc.modx.com/confluence/docs.css" />
<link type="text/css" rel="stylesheet" href="http://misc.modx.com/confluence/syntaxhighlighter/css/all.css" />
<!--<script type="text/javascript" src="http://misc.modx.com/js/jquery-1.3.2.min.js"></script>-->
<script type="text/javascript" src="http://misc.modx.com/confluence/syntaxhighlighter/js/all.js"></script>
<script type="text/javascript" src="http://misc.modx.com/confluence/loadcode.js"></script>
<link type="text/css" rel="stylesheet" href="http://misc.modx.com/confluence/promo/ad.css" />

    
    <link rel="canonical" href="http://oldrtfm.modx.com/display/revolution20/Installation+on+a+server+running+ModSecurity">
    <link rel="shortlink" href="http://oldrtfm.modx.com/x/_gAvAg">
    <meta name="wikilink" content="[revolution20:Installation on a server running ModSecurity]">

</head>

<body             onload="placeFocus()"
     id="com-atlassian-confluence" class="theme-documentation ">
<div id="full-height-container">
<!-- CODE FOR AD THAT SEEMS TO BE INSERTABLE DIRECTLY AFTER OPEN BODY TAG IN CONFLUENCE THEME ADMIN -->
<!--<a href="https://modxcloud.com/signup/lab-account.html?utm_source=rtfm&utm_medium=banner&utm_campaign=one_percent%2B" class="modx-cloud-link">
    <div class="modx-cloud-ad-wrap">
        <div class="modx-cloud-ad">
            <div class="logo-wrap">
                <img src="http://misc.modx.com/confluence/promo/modx-cloud-logo.png" alt="MODX Cloud" width="161" height="40">
            </div>
            <p>The Most Productive MODX Learning Playground Ever</p>
            <span class="faux-btn">
                Claim Free Lab Account
            </span>

        </div>
    </div>
</a>-->
<!-- END OF AD -->

<div class="editors_note" style="background-color:#ff9a91;border: 1px solid red; padding:5px;color:black;">
    <strong>Important Note:</strong> This is an archive of the official MODX Documentation. Please do not edit or make changes here.  The current documentation is located at <a href="rtfm.modx.com">rtfm.modx.com</a>.
</div>


<fieldset class="hidden parameters">
    <input type="hidden" id="statusDialogHeading" value="What are you working on?">
    <input type="hidden" id="statusDialogAccessibilityLabel" value="Enter your status (140 character limit)">
    <input type="hidden" id="statusDialogLatestLabel" value="Last update:">
    <input type="hidden" id="statusDialogUpdateButtonLabel" value="Update">
    <input type="hidden" id="statusDialogCancelButtonLabel" value="Cancel">
</fieldset>

<fieldset class="hidden parameters">
    <input type="hidden" id="globalSettingsAttachmentMaxSize" value="10485760">
    <input type="hidden" id="userLocale" value="en_GB">
    <input type="hidden" id="staticResourceUrlPrefix" value="/s/1911/69/_">
    <input type="hidden" id="contextPath" value="">
</fieldset>

    
<div id="header" class="sectionbottom ">
        <form id="quick-search" class="quick-search" method="get" action="/dosearchsite.action">
        <fieldset>
            <legend>Quick Search</legend>
            <input class="quick-search-query" id="quick-search-query" type="text" accessKey="q" autocomplete="off" name="queryString" size="25" />
            <input class="quick-search-submit" id="quick-search-submit" type="submit" value="Search" />
            <div class="aui-dd-parent quick-nav-drop-down"><!-- Quick nav appears here --></div>
        </fieldset>
        <fieldset class="hidden parameters">
            <input type="hidden" id="quickNavEnabled" value="true" />
                    </fieldset>
    </form>
    <ul id="header-menu-bar" class="ajs-menu-bar">
                    
        
            <li class="normal ajs-menu-item">
        <a id="browse-menu-link" class="browse trigger ajs-menu-title" href="#"><span><span>Browse</span></span></a>         <div class="hidden ajs-drop-down">
                        <ul  id="browse-menu-link-leading"                 class="section-leading first">
                                        <li>
    
        
    
    <a  id="space-pages-link" href="/pages/listpages.action?key=revolution20"  class=""   title="Attachments: 1">
                   <span>Pages</span></a>        </li>
                                        <li>
    
        
    
    <a  id="space-blogposts-link" href="/pages/viewrecentblogposts.action?key=revolution20"  class=""   title="Attachments: 1">
                   <span>Blog</span></a>        </li>
                                        <li>
    
        
    
    <a  id="space-labels-link" href="/labels/listlabels-heatmap.action?key=revolution20"  class=""   title="Attachments: 1">
                   <span>Labels</span></a>        </li>
                                        <li>
    
        
    
    <a  id="space-attachments-link" href="/spaces/listattachmentsforspace.action?key=revolution20"  class=""   title="Attachments: 1">
                   <span>Attachments</span></a>        </li>
                                        <li>
    
        
    
    <a  href="/spaces/space-bookmarks.action?spaceKey=revolution20"  class=""   title="Browse bookmarks in the MODx Revolution 2.x space">
                   <span>Bookmarks</span></a>        </li>
                                        <li>
    
        
    
    <a  id="space-mail-link" href="/spaces/viewmailarchive.action?key=revolution20"  class=""   title="Browse bookmarks in the MODx Revolution 2.x space">
                   <span>Mail</span></a>        </li>
                                        <li>
    
        
    
    <a  id="space-advanced-link" href="/spaces/viewspacesummary.action?key=revolution20"  class=""   title="Browse bookmarks in the MODx Revolution 2.x space">
                   <span>Advanced</span></a>        </li>
                            </ul>
                        <ul  id="browse-menu-link-global"                 class="section-global">
                                        <li>
    
            
    
    <a  id="gadget-directory-link" href="#"  class="user-item administration-link"   title="Browse gadgets provided by Confluence">
                   <span>Confluence Gadgets</span></a>        </li>
                            </ul>
                    </div>
    </li>
        
                                                         <li class="ajs-menu-item normal">
        
        
    
    <a  id="login-link" href="/login.action?os_destination=%2Fdisplay%2Frevolution20%2FInstallation%2Bon%2Ba%2Bserver%2Brunning%2BModSecurity"  class="user-item login-link"  >
                   <span>Log In</span></a>        </li>
                                <li class="normal ajs-menu-item">
            <div id="splitter-button" class="hidden" title="Sidebar"></div>
        </li>

    </ul>
    
    
    <ol id="breadcrumbs">
                    
        <li class="first" >
                                    <span><a href="/dashboard.action">Dashboard</a></span>
                </li>
                    
        <li>
                                    <span><a href="/display/revolution20">MODx Revolution 2.x</a></span>
                </li>
                                        <li id="ellipsis" title="    &#8230;
                    Home
             &gt;         Getting Started
             &gt;         Installation
        &#8230;
"><span><strong>&#8230;</strong></span></li>
                                    
        <li class="hidden-crumb" >
                                    <span><a href="/display/revolution20/Home">Home</a></span>
                </li>
                                
        <li class="hidden-crumb" >
                                    <span><a href="/display/revolution20/Getting+Started">Getting Started</a></span>
                </li>
                                
        <li class="hidden-crumb" >
                                    <span><a href="/display/revolution20/Installation">Installation</a></span>
                </li>
                    
        <li>
                                    <span><a href="/display/revolution20/Basic+Installation">Basic Installation</a></span>
                </li>
                    
        <li>
                                    <span>Installation on a server running ModSecurity</span>
                </li>
        </ol>

</div>

    <div id="splitter">
    <div id="splitter-sidebar">

        

                    
    
    

<div class="plugin_pagetree">

                <div id="pagetreesearch">
            <form method="POST" action="/plugins/pagetreesearch/pagetreesearch.action" name="pagetreesearchform">
                                    <input type="hidden" name="ancestorId" value="18678050">
                                <input type="hidden" name="spaceKey" value="revolution20">
                <input type="text"  size="20" name="queryString">
                <input type="submit" value="Search">
            </form>
        </div>
    
        
    <ul class="plugin_pagetree_children_list plugin_pagetree_children_list_noleftspace">
        <div class="plugin_pagetree_children">
        </div>
    </ul>

    <fieldset class="hidden">
        <input type="hidden" name="treeId" value="">
        <input type="hidden" name="treeRequestId" value="/plugins/pagetree/naturalchildren.action?decorator=none&amp;excerpt=false&amp;sort=position&amp;reverse=false&amp;disableLinks=false">
        <input type="hidden" name="treePageId" value="36634874">

        <input type="hidden" name="noRoot" value="false">
        <input type="hidden" name="rootPageId" value="18678050">

        <input type="hidden" name="rootPage" value="">
        <input type="hidden" name="startDepth" value="0">
        <input type="hidden" name="spaceKey" value="revolution20" >

        <input type="hidden" name="i18n-pagetree.loading" value="Loading...">
        <input type="hidden" name="i18n-pagetree.error.permission" value="Unable to load page tree. It seems that you do not have permission to view the root page.">
        <input type="hidden" name="i18n-pagetree.eeror.general" value="There was a problem retrieving the page tree. Please check the server log file for more information.">
        <input type="hidden" name="loginUrl" value="/login.action?os_destination=%2Fdisplay%2Frevolution20%2FInstallation%2Bon%2Ba%2Bserver%2Brunning%2BModSecurity">

                <fieldset class="hidden">
                                                <input type="hidden" name="ancestorId" value="18678053">
                                    <input type="hidden" name="ancestorId" value="18678541">
                                    <input type="hidden" name="ancestorId" value="18678198">
                                    <input type="hidden" name="ancestorId" value="18678050">
                                    </fieldset>
    </fieldset>
</div>



            </div>
    <div id="splitter-content">

                    <script type="text/javascript" src="/s/1911/69/2/_/download/resources/com.atlassian.confluence.plugins.doctheme:resources/doc-theme.js"></script>
    
            
    
<div id="main" >
    
    
    <div id="navigation" class="content-navigation view">
        <fieldset class="hidden parameters">
            <input type="hidden" id="pageId" value="36634874">
        </fieldset>
        <ul class="ajs-menu-bar">
                                
                        
            <li class="normal ajs-menu-item">
        <a id="action-menu-link" class="action trigger ajs-menu-title" href="#"><span><span>Tools</span></span></a>         <div class="hidden ajs-drop-down">
                        <ul  id="action-menu-link-primary"                 class="section-primary first">
                                        <li>
    
        
    
    <a  id="view-attachments-link" href="/pages/viewpageattachments.action?pageId=36634874"  class="action-view-attachments"  accessKey="a" >
                   <span><u>A</u>ttachments (1)</span></a>        </li>
                                        <li>
    
        
    
    <a  id="action-view-history-link" href="/pages/viewpreviousversions.action?pageId=36634874"  class="action-view-history"  >
                   <span>Page History</span></a>        </li>
                                        <li>
    
        
    
    <a  id="mailPageLink" href="/pages/mailpage/mailpage.action?pageId=36634874"  class=""  >
                    <span>
                <img alt="E-mail" src="/images/icons/mail_content_16.gif" height="16" width="16" title="E-mail">
                E-mail
            </span></a>        </li>
                                        <li>
    
        
    
    <a  id="action-page-permissions-link" href="/pages/viewinfo.action?pageId=36634874"  class="action-page-permissions"  >
                   <span>Restrictions</span></a>        </li>
                            </ul>
                        <ul  id="action-menu-link-secondary"                 class="section-secondary">
                                        <li>
    
        
    
    <a  id="view-page-info-link" href="/pages/viewinfo.action?pageId=36634874"  class="action-view-info"  >
                   <span>Info</span></a>        </li>
                                        <li>
    
        
    
    <a  id="link-to-page-link" href="/pages/viewinfo.action?pageId=36634874"  class=""  >
                   <span>Link to this Page&hellip;</span></a>        </li>
                                        <li>
    
        
    
    <a  id="view-in-hierarchy-link" href="/pages/listpages-dirview.action?key=revolution20&openId=36634874#selectedPageInHierarchy"  class=""  >
                   <span>View in Hierarchy</span></a>        </li>
                                        <li>
    
        
    
    <a  id="action-view-source-link" href="/pages/viewpagesrc.action?pageId=36634874"  class="action-view-source popup-link"  >
                   <span>View Wiki Markup</span></a>        </li>
                            </ul>
                    </div>
    </li>
            </ul>
    </div>

    
    <h1 id="title-heading" class="pagetitle">
                    <a href="/display/revolution20"><img class="logo global custom" src="/download/attachments/9109505/global.logo?version=2&modificationDate=1356105314000" alt=""></a>        
		<span id="title-text">
					            <a href="/display/revolution20/Installation+on+a+server+running+ModSecurity">Installation on a server running ModSecurity</a>
    				</span>
    </h1>

    

    
    
    
    <div id="content" class="page view">
    



<fieldset id="link-to-page-fields" class="hidden parameters">
    <input type="hidden" id="linkToThisPageHeading" value="Link to this Page">
    <input type="hidden" id="linkToThisPageLink" value="Link">
    <input type="hidden" id="linkToThisPageTinyLink" value="Tiny Link">
    <input type="hidden" id="linkToThisPageWikiMarkup" value="Wiki Markup">
    <input type="hidden" id="linkToThisPageClose" value="Close">
</fieldset>
<fieldset class="hidden parameters">
    <input type="hidden" title="movePageDialogViewPageTitle" value="Move Page &ndash; &#8216;Installation on a server running ModSecurity&#8217;">
    <input type="hidden" title="movePageDialogEditPageTitle" value="Set Page Location">
    <input type="hidden" title="movePageDialogMoveButton" value="Move">
    <input type="hidden" title="movePageDialogOkButton" value="OK">
    <input type="hidden" title="movePageDialogCancelButton" value="Cancel">
    <input type="hidden" title="movePageDialogBrowsePanelTip" value="Click to select the new parent page for this page and its children.">
    <input type="hidden" title="movePageDialogSearchPanel" value="Search">
    <input type="hidden" title="movePageDialogHistoryPanel" value="Recently Viewed">
    <input type="hidden" title="movePageDialogHistoryNoResults" value="There were no recently viewed pages found.">
    <input type="hidden" title="movePageDialogLocationPanel" value="Known Location">
    <input type="hidden" title="movePageDialogLocationNotFound" value="The specified page was not found.">
    <input type="hidden" title="movePageDialogBrowsePanel" value="Browse">
    <input type="hidden" title="movePageDialogPanelLoadErrorMsg" value="Error reading the panel content from the server.">
    <input type="hidden" title="movePageDialogPanelLoadErrorTip" value="You could try reloading the page and launching the dialog again.">
    <input type="hidden" title="movePageDialogPanelLoadErrorStatus" value="HTTP Status">
    <input type="hidden" title="movePageDialogNoSelectionErrorMsg" value="You must make a selection in the tree before you can move the page.">
    <input type="hidden" title="movePageDialogSearchError" value="Failed to retrieve search results from the server.">
    <input type="hidden" title="movePageDialogSearchNoResults" value="There were no pages found containing <b>{0}</b>.">
    <input type="hidden" title="movePageDialogSearchResultCount" value="Showing <b>{0}</b>-<b>{1}</b> of <b>{2}</b> pages containing <b>{3}</b>.">
    <input type="hidden" title="movePageDialogMoveFailed" value="Move failed. There was a problem contacting the server.">
    <input type="hidden" title="movePageDialogCannotChangeSpace" value="You cannot move this page to another space because you do not have permission to remove it from this space.">
    <input type="hidden" title="pageTitle" value="Installation on a server running ModSecurity"/>
    <input type="hidden" title="parentPageTitle" value="Basic Installation"/>
    <input type="hidden" title="fromPageTitle" value=""/>
    <input type="hidden" title="spaceKey" value="revolution20"/>
    <input type="hidden" title="spaceName" value="MODx Revolution 2.x"/>
    <input type="hidden" title="movePageDialogInvalidLocation" value="You cannot move a page to be underneath itself or its children."/>
    <input type="hidden" title="movePageDialogOrderingTitle" value="Page Ordering"/>
    <input type="hidden" title="movePageDialogBackButton" value="Back"/>
    <input type="hidden" title="movePageDialogMoveAndOrderButton" value="Reorder"/>
    <input type="hidden" title="movePageDialogNextButton" value="Move"/>    
</fieldset>

<script type="text/x-template" title="movePageDialog">
    <div class="row information">
        Specify the new parent page for this page and its children by space and title.
    </div>
    <div class="form">
        <fieldset>
            

    <legend class="assistive"><span>Change the Parent Page to a Known Page</span></legend>
            <div class="row">
                <label for="new-space">New space:</label>
                <div class="value new-space-value">
                    <input id="new-space-key" name="new-space-key" type="hidden" value="revolution20">
                                            <span class="space-input">
                            <input id="new-space" name="new-space" value="MODx Revolution 2.x" disabled="disabled">
                        </span>
                        <span class="description warning">You cannot move this page to another space because you do not have permission to remove it from this space.</span>
                                        <div class="new-space-dropdown aui-dd-parent"></div>
                </div>
            </div>
            <div class="row">
                <label for="new-parent-page">New parent page:</label>
                <div class="value new-parent-page-value">
                    <span class="page-input">
                        <input id="new-parent-page" name="new-parent-page" value="Basic Installation">
                    </span>
                    <span class="description">Start typing a page title to see a list of suggestions.</span>
                    <div class="new-parent-page-dropdown aui-dd-parent autocomplete"></div>
                </div>
            </div>
        </fieldset>
    </div>
    <div class="location-info">
        <div class="row">
            <label>Current location:</label>
            <div class="value breadcrumbs-container">
                <div class="breadcrumbs-line">
                    <ul id="current-parent-breadcrumbs" class="breadcrumbs">
                    </ul>
                </div>
            </div>
        </div>
        <div class="row">
            <label>New location:</label>
            <div class="value breadcrumbs-container">
                <div class="breadcrumbs-line">
                    <ul id="new-parent-breadcrumbs" class="breadcrumbs">
                    </ul>
                </div>
            </div>
        </div>
    </div>
</script>
<script type="text/x-template" title="movePageErrors">
    <div id="move-errors" class="hidden warning"></div>
</script>
<script type="text/x-template" title="movePageBreadcrumb">
    <li><a class="{2}" title="{3}" tabindex="-1"><span>{0}</span></a></li>
</script>
<script type="text/x-template" title="movePageBreadcrumbLoading">
    <li class="loading"><span>Loading breadcrumbs&hellip;</span></li>
</script>
<script type="text/x-template" title="movePageBreadcrumbError">
    <li class="warning last"><span>Error retrieving breadcrumbs.</span></li>
</script>
<script type="text/x-template" title="movePageNoMatchingPages">
    <ol><li><span class="warning">No matching pages found.</span></li></ol>
</script>
<script type="text/x-template" title="movePageNoMatchingSpaces">
    <ol><li><span class="warning">No matching spaces found.</span></li></ol>
</script>

<script type="text/x-template" title="movePageSearchPanel">
<div class="row information">
    Search for and select the new parent page for this page and its children.
</div>
<div id="move-page-search-container" class="row">
    <div class="search-form">
        <fieldset>
            

    <legend class="assistive"><span>Search for a New Parent Page</span></legend>
            

    <label  for="move-page-search-query" class="assistive">Search keywords</label>
            <input class="search-query" id="move-page-search-query">
            

    <label  for="move-page-search-space" class="assistive">Search in space</label>
                            <select id="move-page-search-space" class="search-space" disabled="disabled">
                    <option value="revolution20" selected="selected">MODx Revolution 2.x</option>
                </select>
                        <input type="button" value="Search">
                            <div class="description warning">You cannot move this page to another space because you do not have permission to remove it from this space.</div>
                    </fieldset>
    </div>
    <div class="search-results">
    </div>
</div>
</script>
<script type="text/x-template" title="movePageSearchResultsLoading">
    <div class="searching">Searching…</div>
</script>

<script type="text/x-template" title="movePageHistoryPanel">
<div class="row information">
    Select the new parent page for this page and its children from your history.
</div>
<div id="move-page-search-container" class="row">
    <div class="search-results">
    </div>
</div>
</script>
<script type="text/x-template" title="movePageHistoryLoading">
    <div class="searching">Loading…</div>
</script>
<script type="text/x-template" title="movePageBrowsePanel">
    <div class="row information">
        Click to select the new parent page for this page and its children.
    </div>
    <div class="tree"></div>
</script>
<script type="text/x-template" title="movePagePanelLoading">
    <span>Loading…</span>
</script>
<script type="text/x-template" title="movePageBrowsePanelSpace">
    <ul><li id='tree-root-node-item' class='root-node-list-item'><a class='root-node' href='#'>{0}</a></li></ul>
</script>
<script type="text/x-template" title="orderingPagePanel">
<div id="orderingPlaceHolder"></div>
</script>
<script type="text/x-template" title="reorderCheckbox">
<span id="reorderRequirement"><input id="reorderCheck" type="checkbox" name="reorderFlag" title="Choose the position of this page within the list of child pages."/><label for="reorderCheck" title="Choose the position of this page within the list of child pages.">Reorder</label></span>
</script>
<script type="text/x-template" title="move-help-link">
    <div class="dialog-help-link">
            <a href="http://docs.atlassian.com/confluence/docs-33/Moving+a+Page" target="_blank">Help</a>
    </div>
</script>
<script type="text/x-template" title="searchResultsGrid">
    <table>
        <thead>
            <tr class="header">
                <th class="search-result-title">Page Title</th>
                <th class="search-result-space">Space</th>
                <th class="search-result-date">Updated</th>
            </tr>
        </thead>
    </table>
</script>
<script type="text/x-template" title="searchResultsGridCount">
    <p class="search-result-count">{0}</p>
</script>
<script type="text/x-template" title="searchResultsGridRow">
    <tr class="search-result">
        <th class="search-result-title"><a href="{1}" class="content-type-{2}"><span>{0}</span></a></th>
        <td class="search-result-space"><a class="space" href="/display/{4}/" title="{3}">{3}</a></td>
        <td class="search-result-date"><span class="date" title="{6}">{5}</span></td>
    </tr>
</script>
<!-- Start restrictions section -->
<fieldset class="hidden parameters i18n">
        <input type="hidden" id="i18n.page.perms.error.invalid.entity.names" value="Unknown user or group:">
        <input type="hidden" id="i18n.page.perms.dialog.heading" value="Page Restrictions">
        <input type="hidden" id="i18n.page.perms.editing.restricted.to" value="Editing restricted to:">
        <input type="hidden" id="i18n.cancel.name" value="Cancel">
        <input type="hidden" id="i18n.close.name" value="Close">
        <input type="hidden" id="i18n.update.name" value="Save">
</fieldset>

<script type="text/x-template" title="page-permissions-div">
<div id="page-permissions-div">
    <div id="page-permissions-editor-form">

                <div id="page-permissions-error-div" class="hidden">
            <a href="#" id="permissions-error-div-close">Ok</a>
            <div></div>
        </div>

                <div id="page-permissions-type-radios" class="page-permissions-label-rows">
            <div>
                <input id="restrictViewRadio" type="radio" checked="checked" name="pagePermissionTypeRadio" value="view"/>
                <label for="restrictViewRadio">Restrict viewing of this page</label>
                <input id="restrictEditRadio" type="radio" name="pagePermissionTypeRadio" value="edit"/>
                <label for="restrictEditRadio">Restrict editing of this page</label>
            </div>
        </div>
        <div id="page-permissions-input" class="page-permissions-label-rows">
            <div class="page-permissions-label">To:</div>
            <div id="page-permissions-chooser-box">
                                <span id="page-permissions-choose-user" class="ajs-button">
                    



    



<a href="#" id='userpicker-popup-link-image' onClick="var picker = window.open('/spaces/openuserpicker.action?key=revolution20&amp;startIndex=0&amp;onPopupSubmit=AJS.PagePermissions.addUserPermissions', 'EntitiesPicker', 'status=yes,resizable=yes,top=100,left=200,width=700,height=680,scrollbars=yes'); picker.focus(); return false;"><img src="/s/1911/69/_/images/icons/user_16.gif" height=16 width=16 border=0 align="absmiddle"  title="Choose users" /></a>
<a href="#" id='userpicker-popup-link-text' onClick="var picker = window.open('/spaces/openuserpicker.action?key=revolution20&amp;startIndex=0&amp;onPopupSubmit=AJS.PagePermissions.addUserPermissions', 'EntitiesPicker', 'status=yes,resizable=yes,top=100,left=200,width=700,height=680,scrollbars=yes'); picker.focus(); return false;">Person...</a>


                </span>
                <span id="page-permissions-choose-group" class="ajs-button">
                    



    

 

<a href="#" id='grouppicker-popup-link-image' onClick="var picker = window.open('/spaces/opengrouppicker.action?key=revolution20&amp;startIndex=0&amp;actionName=dosearchgroups.action&amp;onPopupSubmit=AJS.PagePermissions.addGroupPermissions', 'EntitiesPicker', 'status=yes,resizable=yes,top=100,left=200,width=580,height=550,scrollbars=yes'); picker.focus(); return false;"><img src="/s/1911/69/_/images/icons/group_16.gif" height=16 width=16 border=0 align="absmiddle"  title="Choose groups" /></a>
<a href="#" id='grouppicker-popup-link-text' onClick="var picker = window.open('/spaces/opengrouppicker.action?key=revolution20&amp;startIndex=0&amp;actionName=dosearchgroups.action&amp;onPopupSubmit=AJS.PagePermissions.addGroupPermissions', 'EntitiesPicker', 'status=yes,resizable=yes,top=100,left=200,width=580,height=550,scrollbars=yes'); picker.focus(); return false;">Group...</a>


                </span>
            </div>
            <div id="page-permissions-input-box">
                                <span>
                    <input type="text" id="page-permissions-names-input" class="input-placeholder" value="Enter user or group name" name="permissionNames" size="30" autocomplete="off"/>
                </span>
                <input
    type="hidden"
                            id="page-permissions-names-hidden"           />                <img height="16px" width="1px" src="/s/1911/69/_/images/border/spacer.gif"/>
                <input type="button" id="add-typed-names" value="Restrict">
            </div>
        </div>
    </div>
    <div id="page-permissions-tables">
        <div id="page-permissions-table-div">
                        <table id="page-permissions-table" class="page-permissions-table">
                <tr id="page-permissions-no-views" class="marker-row">
                    <td colspan="3" class="page-permissions-marker-cell"><span>No view restrictions are defined for this page</span></td>
                </tr>
                <tr id="page-permissions-no-edits" class="marker-row">
                    <td colspan="3" class="page-permissions-marker-cell"><span>No edit restrictions are defined for this page</span></td>
                </tr>
            </table>
        </div>
        <div id="page-inherited-permissions-table-div" class="hidden">
            <span id="page-inherited-permissions-table-desc">
                <a class="icon twisty-closed">Show/Hide</a>
                <a id="toggle-inherited-permissions" title="Click to see inherited restrictions">This page has restricted parent pages. It can only be seen by users who can see those parent pages.</a>
            </span>
            <div id="page-inherited-permissions-tables" class="hidden page-inheritance-togglable"></div>
        </div>
    </div>
</div>
</script>

<script type="text/x-template" title="permissions-row-template">
    <tr class="permission-row">
                                
                <td class="page-permissions-marker-cell" width="20%">
            <span>Viewing restricted to:</span>
        </td>
                <td class="permission-entity" nowrap="true" width="40%">
            <span class="entity-container">
                <img class="permission-entity-picture"/>
                <span class="permission-entity-display-name"></span>
                <span class="permission-entity-name-wrap">&nbsp;(<span class="permission-entity-name"></span>)</span>
            </span>
        </td>
        <td class="permission-detail-column">
            <div class="permission-remove-div">
                <a href="#" class="remove-permission-link">Remove restriction</a>
            </div>
        </td>
    </tr>
</script>
<script type="text/x-template" title="permissions-username-no-suggestion-template">
    <ol>
        <li><a href="#" class="message"><span>No matches</span></a></li>
    </ol>
</script>
<script type="text/x-template" title="page-inherited-permissions-table-div-template">
        <div class="page-inherited-permissions-owner-div">
        <div class="page-inherited-permissions-table-desc">Viewing restrictions apply to “<a></a>”. In order to see “<span></span>”, a user must be in the following list of users and groups:</div>
        <table class="page-permissions-table"></table>
    </div>
</script>
<script type="text/x-template" title="page-restrictions-help-link">
    <div class="dialog-help-link">
            <a href="http://docs.atlassian.com/confluence/docs-33/Page+Restrictions" target="_blank">Help</a>
    </div>
</script>
<!-- End restrictions section -->

        
    
    
        <fieldset class="hidden parameters">
            <input type="hidden" title="parentPageId" value="18678053">
        </fieldset>

        
                            
    

                    

        
        <a href="#page-metadata-end" class="assistive">Skip to end of metadata</a>
<div id="page-metadata-start" class="assistive"></div>

    <div class="page-metadata">
        <ul>
                            <li class="page-metadata-item noprint">
    
            
    
    <a  id="content-metadata-page-restrictions" href="#"  class="page-metadata-icon page-restrictions hidden"   title="Page restrictions apply. Click the lock icon to view or edit the restriction.">
                   <span>Page restrictions apply</span></a>        </li>
                            <li class="page-metadata-item noprint">
    
        
    
    <a  id="content-metadata-attachments" href="/pages/viewpageattachments.action?pageId=36634874&metadataLink=true"  class="page-metadata-icon action-view-attachments"  accessKey="a"  title="Attachments: 1">
                   <span><span class="page-metadata-attachments-text">Attachments:</span><span class="page-metadata-attachments-count">1</span></span></a>        </li>
                        <li class="page-metadata-modification-info">
                                    Added by <a href="/display/~everettg_99"
                          class="url fn"
                   >Everett Griffiths</a>, last edited by <a href="/display/~everettg_99"
                          class="url fn"
                   >Everett Griffiths</a> on May 03, 2012
                                                                <span class="noprint">&nbsp;(<a id="view-change-link" href="/pages/diffpages.action?pageId=36634874&originalId=39355428">view change</a>)</span>
                                                </li>
                    </ul>
          <div id="version-comment" class="noteMacro" style="display: none;">
      <strong>Comment:</strong>
      <br />
  </div>
    </div>


<a href="#page-metadata-start" class="assistive">Go to start of metadata</a>
<div id="page-metadata-end" class="assistive"></div>
        
        <fieldset class="hidden parameters">
                        <input type="hidden" title="browsePageTreeMode" value="view">
        </fieldset>

        <div class="wiki-content">
           <!-- wiki content -->
            <p><br class="atl-forced-newline" /></p>

<div>
<ul>
    <li><a href='#InstallationonaserverrunningModSecurity-ModSecurity%28akamodsecurityormodsec%29'>ModSecurity (aka mod_security or mod_sec)</a></li>
    <li><a href='#InstallationonaserverrunningModSecurity-HowDoIKnowifIhaveModSecurityInstalled%3F'>How Do I Know if I have ModSecurity Installed?</a></li>
<ul>
    <li><a href='#InstallationonaserverrunningModSecurity-CheckingonaWHMServer'>Checking on a WHM Server</a></li>
    <li><a href='#InstallationonaserverrunningModSecurity-CheckingviatheCommandLine'>Checking via the Command Line</a></li>
    <li><a href='#InstallationonaserverrunningModSecurity-OtherRecon'>Other Recon</a></li>
</ul>
    <li><a href='#InstallationonaserverrunningModSecurity-LogFiles'>Log Files</a></li>
<ul>
    <li><a href='#InstallationonaserverrunningModSecurity-SampleError'>Sample Error</a></li>
</ul>
    <li><a href='#InstallationonaserverrunningModSecurity-WhitelistingaRuleforaDomain'>Whitelisting a Rule for a Domain</a></li>
<ul>
    <li><a href='#InstallationonaserverrunningModSecurity-RebuildtheApacheConfiguration'>Rebuild the Apache Configuration</a></li>
    <li><a href='#InstallationonaserverrunningModSecurity-EdittheVirtualHostsfile'>Edit the Virtual Hosts file</a></li>
</ul>
    <li><a href='#InstallationonaserverrunningModSecurity-AddtheWhitelistRule'>Add the Whitelist Rule</a></li>
<ul>
    <li><a href='#InstallationonaserverrunningModSecurity-GenericExample'>Generic Example</a></li>
    <li><a href='#InstallationonaserverrunningModSecurity-SpecificExample'>Specific Example</a></li>
    <li><a href='#InstallationonaserverrunningModSecurity-BroaderExample'>Broader Example</a></li>
</ul>
    <li><a href='#InstallationonaserverrunningModSecurity-RestartApache'>Restart Apache</a></li>
<ul>
    <li><a href='#InstallationonaserverrunningModSecurity-cPanel%3ARebuildConffile'>cPanel: Rebuild Conf file</a></li>
    <li><a href='#InstallationonaserverrunningModSecurity-RestartApache'>Restart Apache</a></li>
</ul>
    <li><a href='#InstallationonaserverrunningModSecurity-StaticResources'>Static Resources</a></li>
    <li><a href='#InstallationonaserverrunningModSecurity-SeeAlso'>See Also</a></li>
</ul></div>

<p>This document covers a fairly technical topic and it's not recommended that amateurs attempt this.  Command-line noobs best leave this to a professional system admin or to their hosting company.  Editing configuration files via the command line can be dangerous and you can destroy your server&#33;</p>


<h2><a name="InstallationonaserverrunningModSecurity-ModSecurity%28akamodsecurityormodsec%29"></a>ModSecurity (aka mod_security or mod_sec)</h2>

<p><a href="http://www.modsecurity.org/" class="external-link" rel="nofollow">ModSecurity</a> is an open source web application firewall that runs as an Apache server module.  It implements a comprehensive set of rules that implement general-purpose hardening, and thereby helps patch common web application security issues. It establishes an external security layer that increases security, detects, and prevents attacks before they reach web applications.  It is commonly available on cPanel systems as an EasyApache module.  It is a well-respected security module and can really help lock down your site from common attack vectors.</p>

<p>We discuss ModSecurity explicitly here because the MODX Revolution manager issues many requests that can run afoul of mod_security rules.</p>

<div class='panelMacro'><table class='warningMacro'><colgroup><col width='24'><col></colgroup><tr><td valign='top'><img src="/images/icons/emoticons/forbidden.gif" width="16" height="16" align="absmiddle" alt="" border="0"></td><td><b>The Silent Killer</b><br />The MODX manager may simply quietly fail if one of its actions is blocked by mod_security.  Know your server&#33;  Check your Apache error logs&#33; Your sanity is at stake&#33;</td></tr></table></div>


<h2><a name="InstallationonaserverrunningModSecurity-HowDoIKnowifIhaveModSecurityInstalled%3F"></a>How Do I Know if I have ModSecurity Installed?</h2>

<p>Before we discuss how to make ModSecurity and MODX play nicely together, you need to know whether or not you actually have this software installed.  The easy solution is to ask your hosting provider, and presumably they will know (if they don't know what software they are running, it's probably time to <a href="http://modx.com/partners/hosting-saas/" class="external-link" rel="nofollow">find another hosting company</a>).</p>

<p>If you are running your own server (e.g. one born of a VPS template), then you can log into the server and check this for yourself.</p>

<h3><a name="InstallationonaserverrunningModSecurity-CheckingonaWHMServer"></a>Checking on a WHM Server</h3>

<p>Many VPS's include the WHM/cPanel administration panels.  It's relatively easy to see if you are running mod_security on a WHM server.</p>

<ol>
	<li>Log into your WHM instance (typically at <a href="https://yoursite.com:2087/" class="external-link" rel="nofollow">https://yoursite.com:2087/</a>)</li>
	<li>Find the "Plugins" section in the left navigation</li>
	<li>If ModSecurity is installed, you'll see <b>Mod Security</b> listed under your plugins.</li>
</ol>


<p><span class="image-wrap" style=""><img src="/download/attachments/36634874/modSecurity+WHM.jpg?version=1&amp;modificationDate=1321901219000" style="border: 1px solid black" /></span></p>

<p>A handy cPanel/WHM mod_security module is available for visually editing your rules here: <a href="http://configserver.com/" class="external-link" rel="nofollow">http://configserver.com/</a></p>


<h3><a name="InstallationonaserverrunningModSecurity-CheckingviatheCommandLine"></a>Checking via the Command Line</h3>

<p>If you have SSH access to your server, you can check to see which modules Apache loads on startup. To print out which modules are loaded into Apache, you can use the <b>apachectl</b> utility on &#42;NIX systems, e.g.</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">apachectl -t -D DUMP_MODULES</pre>
</div></div>

<p>Or, if your <b>apachectl</b> command is not in your current $PATH, then you may need to specify a full path to the utility.  To find the path, you can search for it using the <b>find</b> command:</p>
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">find / -name apachectl</pre>
</div></div>

<p>Then once you've found the full path to the utility, you can run the command verbosely, e.g.:</p>
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">/usr/local/apache/bin/apachectl -t -D DUMP_MODULES</pre>
</div></div>

<p>The output will be something like this:</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">
Loaded Modules:
 core_module (<span class="code-keyword">static</span>)
 rewrite_module (<span class="code-keyword">static</span>)
 so_module (<span class="code-keyword">static</span>)
 suphp_module (shared)
 security2_module (shared)  # &lt;--- <span class="code-keyword">this</span> is ModSecurity
</pre>
</div></div>

<div class='panelMacro'><table class='noteMacro'><colgroup><col width='24'><col></colgroup><tr><td valign='top'><img src="/images/icons/emoticons/warning.gif" width="16" height="16" align="absmiddle" alt="" border="0"></td><td>The mod_security module is listed as <b>security2_module</b></td></tr></table></div>


<h3><a name="InstallationonaserverrunningModSecurity-OtherRecon"></a>Other Recon</h3>

<p>If you don't have the <b>apachectl</b> utility or you can't find it, you can manually check your Apache configuration files.  It can be configured differently on different servers, but in general, Apache is setup to load its main configuration file, then it will optionally scan additional directories for additional configuration files.</p>

<ol>
	<li>Check the main Apache file (often inside <b>/etc/httpd</b>, e.g. <b>/etc/httpd/conf/httpd.conf</b>)</li>
	<li>Check the additional configuration directories (often inside sub-folders of the main configuration directory).</li>
</ol>



<h2><a name="InstallationonaserverrunningModSecurity-LogFiles"></a>Log Files</h2>

<p>After you've verified that are in fact running ModSecurity, you'll want to monitor your logs to see if your actions in the MODX manager are in fact tripping security alarms.  This is best done via the command line: use SSH to log into your server and make sure you have appropriate access (e.g. root privileges) to view these log files.</p>

<p>The primary log you'll want to monitor is your Apache error log.  The exact location is configured in your Apache configuration file, but often it resides inside of <b>/usr/local/apache/logs/error_log</b> A good way to watch this file is by using the <b>tail</b> utility.  You can monitor the file in real-time by using the <b>&#45;f</b> flag, e.g.</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">tail -f /usr/local/apache/logs/error_log</pre>
</div></div>

<p>Keep that window open as you navigate the MODX manager and be alert if any errors appear in that file.  (Press ctrl-C to close the utility).</p>

<p>You may also want to watch the contents of the mod_security log.  Again, the location is configurable, but often this is stored in <b>/usr/local/apache/logs/modsec_audit.log</b></p>

<h3><a name="InstallationonaserverrunningModSecurity-SampleError"></a>Sample Error</h3>

<p>If you do see that errors are being tripped inside the Apache error log when you try a particular action in the MODX manager, chances are good that ModSecurity just prevented you from doing something in the manager.</p>

<p>Here is a sample error from the Apache error log:</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">
[Sat Nov 19 19:16:32 2011] [error] [client 123.123.123.123] ModSecurity: Access denied with code 500 (phase 2).
Pattern match <span class="code-quote">"(insert[[:space:]]+into.+values|select.*from.+[a-z|A-Z|0-9]|select.+from|bulk[[:space:]]+insert|union.+select|convert.+\\\\(.*from)"</span>
at ARGS:els.
[file <span class="code-quote">"/usr/local/apache/conf/modsec2.user.conf"</span>]
[line <span class="code-quote">"359"</span>]
[id <span class="code-quote">"300016"</span>]
[rev <span class="code-quote">"2"</span>]
[msg <span class="code-quote">"Generic SQL injection protection"</span>]
[severity <span class="code-quote">"CRITICAL"</span>]
[hostname <span class="code-quote">"yoursite.com"</span>]
[uri <span class="code-quote">"/connectors/element/tv.php"</span>]
[unique_id <span class="code-quote">"TshG4EWntHMAAAfIFmUAAAAI"</span>]
</pre>
</div></div>

<p>From this error, we need 3 pieces of information in order to whitelist a particular action.  Take note of the following 3 items:</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">
[id <span class="code-quote">"300016"</span>]
[hostname <span class="code-quote">"yoursite.com"</span>]
[uri <span class="code-quote">"/connectors/element/tv.php"</span>]
</pre>
</div></div>

<p>This tells what rule was being tripped, what domain it was tripped on, and from what location inside that domain the rule is being tripped.</p>


<h2><a name="InstallationonaserverrunningModSecurity-WhitelistingaRuleforaDomain"></a>Whitelisting a Rule for a Domain</h2>

<p>Whitelisting a rule for a specific domain is accomplished through an "includes" file.  This takes several steps to do safely.</p>


<h3><a name="InstallationonaserverrunningModSecurity-RebuildtheApacheConfiguration"></a>Rebuild the Apache Configuration</h3>

<p>The first thing to do is to back up and rebuild the httpd.conf file to make sure there are no errors (run the following commands one at a time)</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">
cd /usr/local/apache/conf
cp -p httpd.conf httpd.conf.backup
</pre>
</div></div>

<p>If you're on a cPanel server, you can then rebuild the file by running the following command:</p>
<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">
/scripts/rebuildhttpdconf
</pre>
</div></div>

<p>The goal here is to verify that your existing Apache configuration file is backed-up and working <em>before</em> we try modifying it.</p>


<h3><a name="InstallationonaserverrunningModSecurity-EdittheVirtualHostsfile"></a>Edit the Virtual Hosts file</h3>

<p>Many setups (include cPanel setups) don't want you messing directly with the main Apache configuration file.  Instead, you'll edit the vhosts file for a given domain.  Look through your main Apache configuration file (<b>httpd.conf</b>) and search for your domain name to see where it has outsourced its configuration files.  You should find some references to it inside of a <b>VirtualHost</b> block.</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">
&lt;VirtualHost 123.123.123.123&gt;
    ServerName yoursite.com
    ServerAlias www.yoursite.com
    DocumentRoot /home/youruser/public_html
    # ... more stuff here ...
    Include <span class="code-quote">"/usr/local/apache/conf/userdata/std/2/yoursite/*.conf"</span>
    Include <span class="code-quote">"/usr/local/apache/conf/userdata/std/2/yoursite/yoursite.com/*.conf"</span>
&lt;/VirtualHost&gt;
</pre>
</div></div>

<p>Based on this <b>VirtualHosts</b> directive, we can turn our attention to the 2 directories referenced:</p>

<ul>
	<li>/usr/local/apache/conf/userdata/std/2/yoursite/</li>
	<li>/usr/local/apache/conf/userdata/std/2/yoursite/yoursite.com/</li>
</ul>


<p>You can also set server-wide rules in the file:</p>

<ul>
	<li>/usr/local/apache/conf/modsec2/whitelist.conf</li>
</ul>


<p>That's where Apache will look for additional configurations.  If you know you don't need to worry additional configuration files, you can skip ahead to the next section and simply add your whitelist rules.  If you are running on a cPanel server or using some other type of setup where you either can't or shouldn't edit the main <b>httpd.conf</b> file directly, then you should place your rules into a separate configuration file.  You may need to create the directories listed above, or perhaps you'll have to rtfm a bit more to figure out where Apache will look for additional configuration files.</p>

<h2><a name="InstallationonaserverrunningModSecurity-AddtheWhitelistRule"></a>Add the Whitelist Rule</h2>

<h3><a name="InstallationonaserverrunningModSecurity-GenericExample"></a>Generic Example</h3>

<p>The general whitelist rule looks like this:</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">
&lt;LocationMatch <span class="code-quote">"/path/to/URI"</span>&gt;
  &lt;IfModule mod_security2.c&gt;
    SecRuleRemoveById (Rule number)
    SecRuleRemoveById (Rule number, <span class="code-keyword">if</span> more <span class="code-keyword">for</span> <span class="code-keyword">this</span> domain)
    SecRuleRemoveById (etc)
    SecRuleRemoveById (etc)
  &lt;/IfModule&gt;
&lt;/LocationMatch&gt;
</pre>
</div></div>

<p>You can modify this and add it to your VirtualHosts directive (either in your main <b>httpd.conf</b> or inside your external <b>vhosts.conf</b> files).  As long as Apache loads the configuration file, the whitelist rule will get registered.</p>

<h3><a name="InstallationonaserverrunningModSecurity-SpecificExample"></a>Specific Example</h3>

<p>Give our sample error message earlier which identified the following error:</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">
[id <span class="code-quote">"300016"</span>]
[hostname <span class="code-quote">"yoursite.com"</span>]
[uri <span class="code-quote">"/connectors/element/tv.php"</span>]
</pre>
</div></div>

<p>We would go to the VirtualHosts directive for <b>yoursite.com</b> and add a rule like the following:</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">
&lt;LocationMatch <span class="code-quote">"/connectors/element/tv.php"</span>&gt;
  &lt;IfModule mod_security2.c&gt;
    SecRuleRemoveById 300016
  &lt;/IfModule&gt;
&lt;/LocationMatch&gt;
</pre>
</div></div>

<p>Note that it references the MODX connector by its path and it references the ModSecurity rule by its id.</p>


<div class='panelMacro'><table class='warningMacro'><colgroup><col width='24'><col></colgroup><tr><td valign='top'><img src="/images/icons/emoticons/forbidden.gif" width="16" height="16" align="absmiddle" alt="" border="0"></td><td><b>Beware Moving your Site</b><br />If you move your site to a new directory or if you move your <b>connectors</b> directory to a non-standard location, you will have to edit your rules&#33;  They apply to a specific URL, so if your URLs change, the rules will have to be updated.</td></tr></table></div>

<h3><a name="InstallationonaserverrunningModSecurity-BroaderExample"></a>Broader Example</h3>

<p>It can be maddening going through MODX functionality one admin screen at a time, but there seems to be some difficulty in white-listing entire directories.  Consider renaming your "connectors" directory (see <a href="/display/revolution20/Hardening+MODX+Revolution" title="Hardening MODX Revolution">Hardening MODX Revolution</a>).</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">
&lt;LocationMatch <span class="code-quote">"/manager/index.php"</span>&gt;
SecRuleRemoveById 300016
&lt;/LocationMatch&gt;

&lt;LocationMatch <span class="code-quote">"/connectors/resource/index.php"</span>&gt;
  SecRuleRemoveById 300013 300014 300015 300016
&lt;/LocationMatch&gt;

&lt;LocationMatch <span class="code-quote">"/connectors/element/tv.php"</span>&gt;
  SecRuleRemoveById 300013 300016
&lt;/LocationMatch&gt;
</pre>
</div></div>



<h2><a name="InstallationonaserverrunningModSecurity-RestartApache"></a>Restart Apache</h2>

<p>Once you've made the changes to your configuration files, you will need to restart Apache in order for the configurations to be re-read.</p>

<h3><a name="InstallationonaserverrunningModSecurity-cPanel%3ARebuildConffile"></a>cPanel: Rebuild Conf file</h3>

<p>If you're not on a cPanel server, skip this step and just restart Apache.</p>

<p>On a cPanel server, you'll want to re-run the <b>rebuildhttpdconf</b> utility:</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">
cd /usr/local/apache/conf
/scripts/rebuildhttpdconf
</pre>
</div></div>

<p>Then you can check to see that the edits you made in your external files got slurped into the main file (again, this is ONLY on a cPanel setup: cPanel slurps up external configurations into the main <b>httpd.conf</b> file).  Try browsing through the file to see that the stuff you put in the external file are now included in the main file.</p>

<h3><a name="InstallationonaserverrunningModSecurity-RestartApache"></a>Restart Apache</h3>

<p>Once you're edits have been made, restart the Apache process:</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">
/etc/init.d/httpd restart
</pre>
</div></div>

<p>If there are any errors in your files, you will be alerted to them.  This can be nerve-wracking because if Apache does not come back on-line, <b>your site will be down&#33;</b></p>

<h2><a name="InstallationonaserverrunningModSecurity-StaticResources"></a>Static Resources</h2>

<p>ModSecurity can affect your MODX static resources (or any PHP script that reads a file for a user to download).  What can happen is if your file is too large, the download will get terminated prematurely, and you end up with a corrupted file.  Often the size of the downloaded file comes through as only about 64kb even though the original file may be significantly larger.  If you experience this, it might be a good hint that ModSecurity is interfering. <b>There may not be a log entry for this</b> (!!!), so it can be very difficult to track this behavior back to ModSecurity&#33;</p>

<div class='panelMacro'><table class='noteMacro'><colgroup><col width='24'><col></colgroup><tr><td valign='top'><img src="/images/icons/emoticons/warning.gif" width="16" height="16" align="absmiddle" alt="" border="0"></td><td>In WHM, you can edit ModSecurity configuration settings by clicking the "Mod Security" plugin link (pictured earlier on this page), and clicking the "Edit Config" button.</td></tr></table></div>

<p>The configuration details that can affect your downloads are the following:</p>

<ul>
	<li>SecRequestBodyAccess</li>
	<li>SecRequestBodyLimit</li>
	<li>SecRequestBodyInMemoryLimit</li>
</ul>


<p>An easy solution is to bypass ModSecurity entirely for downloads like this:</p>

<div class="code panel" style="border-width: 1px;"><div class="codeContent panelContent">
<pre class="code-java">
SecRequestBodyAccess Off
</pre>
</div></div>

<p>See <a href="http://www.modsecurity.org/documentation/modsecurity-apache/2.1.0/modsecurity2-apache-reference.html" class="external-link" rel="nofollow">http://www.modsecurity.org/documentation/modsecurity-apache/2.1.0/modsecurity2-apache-reference.html</a> for more information on the various configuration details.</p>

<p>Another cause of this enigmatic symptom can be a conflict between web servers: for example, if you have Apache and NGINX installed on the same server, <em>make sure that they both do not use gzip compression</em> &#8211; the result can look very much like ModSecurity interfering!  If NGINX compresses a large static resource and then Apache also tries to compress it, the effort fails and the file ends up clipping at 64kb.  </p>

<h2><a name="InstallationonaserverrunningModSecurity-SeeAlso"></a>See Also</h2>

<p><a href="http://www.modsecurity.org/documentation/modsecurity-apache/2.1.0/modsecurity2-apache-reference.html" class="external-link" rel="nofollow">ModSecurity Configuration Reference</a></p>


    
    

<div class="plugin_pagetree">

        
        
    <ul class="plugin_pagetree_children_list plugin_pagetree_children_list_noleftspace">
        <div class="plugin_pagetree_children">
        </div>
    </ul>

    <fieldset class="hidden">
        <input type="hidden" name="treeId" value="">
        <input type="hidden" name="treeRequestId" value="/plugins/pagetree/naturalchildren.action?decorator=none&amp;excerpt=false&amp;sort=position&amp;reverse=false&amp;disableLinks=false">
        <input type="hidden" name="treePageId" value="36634874">

        <input type="hidden" name="noRoot" value="false">
        <input type="hidden" name="rootPageId" value="18678053">

        <input type="hidden" name="rootPage" value="">
        <input type="hidden" name="startDepth" value="0">
        <input type="hidden" name="spaceKey" value="revolution20" >

        <input type="hidden" name="i18n-pagetree.loading" value="Loading...">
        <input type="hidden" name="i18n-pagetree.error.permission" value="Unable to load page tree. It seems that you do not have permission to view the root page.">
        <input type="hidden" name="i18n-pagetree.eeror.general" value="There was a problem retrieving the page tree. Please check the server log file for more information.">
        <input type="hidden" name="loginUrl" value="/login.action?os_destination=%2Fdisplay%2Frevolution20%2FInstallation%2Bon%2Ba%2Bserver%2Brunning%2BModSecurity">

                <fieldset class="hidden">
                                                <input type="hidden" name="ancestorId" value="18678053">
                                    </fieldset>
    </fieldset>
</div>



<p><br class="atl-forced-newline" /></p>

<style type='text/css'>/*<![CDATA[*/
table.ScrollbarTable  {border: none;padding: 3px;width: 100%;padding: 3px;margin: 0px;background-color: #f0f0f0}
table.ScrollbarTable td.ScrollbarPrevIcon {text-align: center;width: 16px;border: none;}
table.ScrollbarTable td.ScrollbarPrevName {text-align: left;border: none;}
table.ScrollbarTable td.ScrollbarParent {text-align: center;border: none;}
table.ScrollbarTable td.ScrollbarNextName {text-align: right;border: none;}
table.ScrollbarTable td.ScrollbarNextIcon {text-align: center;width: 16px;border: none;}

/*]]>*/</style><div class="Scrollbar"><table class='ScrollbarTable'><tr><td class='ScrollbarPrevIcon'><a href="/display/revolution20/Problems+with+WAMPServer+2.0i"><img border='0' align='middle' src='/images/icons/back_16.gif' width='16' height='16'></a></td><td width='33%' class='ScrollbarPrevName'><a href="/display/revolution20/Problems+with+WAMPServer+2.0i">Problems with WAMPServer 2.0i</a>&nbsp;</td><td width='33%' class='ScrollbarParent'><sup><a href="/display/revolution20/Basic+Installation"><img border='0' align='middle' src='/images/icons/up_16.gif' width='8' height='8'></a></sup><a href="/display/revolution20/Basic+Installation">Basic Installation</a></td><td width='33%' class='ScrollbarNextName'>&nbsp;<a href="/display/revolution20/MODX+and+Suhosin">MODX and Suhosin</a></td><td class='ScrollbarNextIcon'><a href="/display/revolution20/MODX+and+Suhosin"><img border='0' align='middle' src='/images/icons/forwd_16.gif' width='16' height='16'></a></td></tr></table></div>
        </div>

        <!--
<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
         xmlns:dc="http://purl.org/dc/elements/1.1/"
         xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
         <rdf:Description
    rdf:about="http://oldrtfm.modx.com/display/revolution20/Installation+on+a+server+running+ModSecurity"
    dc:identifier="http://oldrtfm.modx.com/display/revolution20/Installation+on+a+server+running+ModSecurity"
    dc:title="Installation on a server running ModSecurity"
    trackback:ping="http://oldrtfm.modx.com/rpc/trackback/36634874"/>
</rdf:RDF>
-->

            
    


<fieldset class="hidden parameters">
    <legend>Labels parameters</legend>
    <input type="hidden" id="editLabel" value="Edit">
    <input type="hidden" id="addLabel" value="Add Labels">
    <input type="hidden" id="domainName" value="http://oldrtfm.modx.com">
    <input type="hidden" id="pageId" value="36634874">
    <input type="hidden" id="spaceKey" value="revolution20">
</fieldset>

<div id="labels-section" class="pageSection">
    <div id="default-labels-header" class="section-header">
        <h2 id="labels-section-title" class="section-title  hidden ">Labels</h2>
            </div>

    <div class="labels-editor">
        <div id="labelsList">
                    </div>

        <span class="errorMessage error" id="errorSpan"></span>
        <form method="GET" action="" id="add-labels-form">
            <div id="labelInputSpan" class="labels-input">
                <div id="labelOperationErrorContainer" class="hidden">
                    <span class="error"><span class="errorMessage" id="labelOperationErrorMessage"></span></span>
                </div>

                <div class="caption">Enter labels to add to this page:</div>
                <div id="label-input-fields">
                    <input autocomplete="off" id="labelsString" name="labelsString" value="" size="40">
                    <input id="add-labels-editor-button" type="submit" class="add-labels" value="Add">
                    <input id="close-labels-editor-button" type="submit" class="hide-labels-editor" value="Done">
                </div>
                <div id="waitImageAndStatus">
                    <img class="waiting" alt="Please wait" src="/s/1911/69/_/images/icons/wait.gif">&nbsp;
                    <span id="labelOperationStatus" class="smalltext"></span>
                </div>
                <div id="labelsAutocompleteList" class="aui-dd-parent"></div>
                <div class="labels-tip">
                    <div id="suggestedLabelsSpan"></div>
                    Looking for a label? Just start typing.
                </div>
            </div>
        </form>
    </div>
</div>

            
            




            
    

        
<fieldset class="parameters hidden">
    <input type="hidden" id="deleteCommentConfirmMessage" value="Are you sure you want to remove the comment?">
    <input type="hidden" id="collapseTooltip" value="Click to toggle the display of this comment.">
        </fieldset>






<div id="comments-section" class="pageSection">
    
    
    
    
                                    </div>


            
</div>


    




        
        

    
    
    


<fieldset class="hidden parameters">
        <input type="hidden" id="i18n.manage.watchers.dialog.title" value="Manage Watchers">
        <input type="hidden" id="i18n.manage.watchers.unable.to.remove.error" value="Failed to remove watcher. Refresh page to see latest status.">
        <input type="hidden" id="i18n.manage.watchers.status.adding.watcher" value="Adding watcher&amp;hellip;">
</fieldset>
<script type="text/x-template" title="manage-watchers-dialog">
<div class="dialog-content">
    <div class="column page-watchers">
        <h3>Watching this page</h3>
        <p class="description">These people are notified when the page is changed. You can add or remove people from this list.</p>
        <form action="/json/addwatch.action" method="POST">
                <input type="hidden" name="atl_token" value="eLRsD4PArs">
            <input type="hidden" name="pageId" value="36634874"/>
            <input type="hidden" id="add-watcher-username" name="username" value=""/>
            <label for="add-watcher-user">User</label>
            <input id="add-watcher-user" name="userFullName" type="search" class="has-placeholder autocomplete-user"
               value="" placeholder="Full name or username" autocomplete="off"
               data-max="10" data-target="#add-watcher-username" data-dropdown-target="#add-watcher-dropdown"
               data-template="{title}" data-none-message="No matching users found.">
            <input id="add-watcher-submit" type="submit" name="add" value="Add">
            <div id="add-watcher-dropdown" class="aui-dd-parent autocomplete"></div>
            <div class="status hidden"></div>
        </form>
        <ul class="user-list">
            <li class="loading">Loading&hellip;</li>
            <li class="no-users hidden">No page watchers</li>
        </ul>
    </div>
    <div class="column space-watchers">
        <h3>Watching this space</h3>
        <p class="description">These people are notified when any content in the space is changed. You cannot modify this list.</p>
        <ul class="user-list">
            <li class="loading">Loading&hellip;</li>
            <li class="no-users hidden">No space watchers</li>
        </ul>
    </div>
</div>
</script>
<script type="text/x-template" title="manage-watchers-user">
    <li class="watch-user">
        <img class="profile-picture confluence-userlink" src="{iconUrl}" data-username="{username}">
        <a class="confluence-userlink" href="{url}" data-username="{username}">{fullName} <span class="username">({username})</span></a>
        <span class="remove-watch" title="Remove"
            data-username="{username}">Remove</span>
    </li>
</script>
<script type="text/x-template" title="manage-watchers-help-link">
    <div class="dialog-help-link">
            <a href="http://docs.atlassian.com/confluence/docs-33/Managing+Watchers" target="_blank">Help</a>
    </div>
</script>
    <br class="clear">
</div>
  
    </div>
</div>

<div id="footer">
                                                <p class="license license-opensource">
                  Powered by a free <b>Atlassian Confluence Open Source Project License</b> granted to MODx CMS / xPDO. <a href="http://www.atlassian.com/c/conf/11461">Evaluate Confluence today</a>.<br>
                </p>
                        
    <ul id="poweredby">
        <li class="noprint">Powered by <a href="http://www.atlassian.com/software/confluence" class="hover-footer-link">Atlassian Confluence</a> 3.3, the <a href="http://www.atlassian.com/software/confluence/tour/enterprise-wiki.jsp" class="hover-footer-link">Enterprise Wiki</a></li>
        <li class="print-only">Printed by Atlassian Confluence 3.3, the Enterprise Wiki.</li>        
        <li class="noprint"> &nbsp; |&nbsp; <a href="http://jira.atlassian.com/secure/BrowseProject.jspa?id=10470" class="hover-footer-link">Report a bug</a></li>
        <li class="noprint"> &nbsp;|&nbsp; <a href="http://www.atlassian.com/about/connected.jsp?s_kwcid=Confluence-stayintouch" class="hover-footer-link">Atlassian News</a></li>
    </ul>

    

            <script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-71684-1']);
  _gaq.push(['_setDomainName', 'oldrtfm.modx.com']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
    </div>    <!-- include system javascript resources -->
                        
    
    
    <!-- end system javascript resources -->
</div>
</body>
</html>
