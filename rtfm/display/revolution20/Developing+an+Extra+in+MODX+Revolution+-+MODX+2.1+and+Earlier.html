<div class="panel" style="border-width: 1px;">
<div class="panelContent">
<p>
This tutorial is part of a Series:
</p>

<ul>
<li>Part I: Getting Started and Creating the Doodles Snippet
</li>

<li>
<a href="display/revolution20/Developing+an+Extra+in+MODX+Revolution%2C+Part+II+-+MODX+2.1+and+Earlier" title="Developing an Extra in MODX Revolution, Part II - MODX 2.1 and Earlier">Part II: Creating our Custom Manager Page</a>
</li>

<li>
<a href="display/revolution20/Developing+an+Extra+in+MODX+Revolution%2C+Part+III+-+MODX+2.1+and+Earlier" title="Developing an Extra in MODX Revolution, Part III - MODX 2.1 and Earlier">Part III: Packaging Our Extra</a>
</li>
</ul>
</div>
</div>

<div>
<ul>
<li>
<a href="revolution/2.x/case-studies-and-tutorials/developing-an-extra-in-modx-revolution-modx-2.1-and-earlier#DevelopinganExtrainMODXRevolution-MODX2.1andEarlier-Overview">Overview</a>
</li>

<li>
<a href="revolution/2.x/case-studies-and-tutorials/developing-an-extra-in-modx-revolution-modx-2.1-and-earlier#DevelopinganExtrainMODXRevolution-MODX2.1andEarlier-SettingUpOurDirectories">Setting Up Our Directories</a>
</li>

<li>
<a href="revolution/2.x/case-studies-and-tutorials/developing-an-extra-in-modx-revolution-modx-2.1-and-earlier#DevelopinganExtrainMODXRevolution-MODX2.1andEarlier-CreatingtheDoodlesSnippet">Creating the Doodles Snippet</a>
</li>

<li style="list-style: none; display: inline">
<ul>
<li>
<a href="revolution/2.x/case-studies-and-tutorials/developing-an-extra-in-modx-revolution-modx-2.1-and-earlier#DevelopinganExtrainMODXRevolution-MODX2.1andEarlier-MakingtheMagicPathSettings">Making the Magic Path Settings</a>
</li>

<li>
<a href="revolution/2.x/case-studies-and-tutorials/developing-an-extra-in-modx-revolution-modx-2.1-and-earlier#DevelopinganExtrainMODXRevolution-MODX2.1andEarlier-MakingtheDoodlesBaseClass">Making the Doodles Base Class</a>
</li>

<li>
<a href="revolution/2.x/case-studies-and-tutorials/developing-an-extra-in-modx-revolution-modx-2.1-and-earlier#DevelopinganExtrainMODXRevolution-MODX2.1andEarlier-MakingtheModel">Making the Model</a>
</li>

<li>
<a href="revolution/2.x/case-studies-and-tutorials/developing-an-extra-in-modx-revolution-modx-2.1-and-earlier#DevelopinganExtrainMODXRevolution-MODX2.1andEarlier-TheSchemaParsingScript">The Schema Parsing Script</a>
</li>

<li>
<a href="revolution/2.x/case-studies-and-tutorials/developing-an-extra-in-modx-revolution-modx-2.1-and-earlier#DevelopinganExtrainMODXRevolution-MODX2.1andEarlier-TheincludeSnippet">The include Snippet</a>
</li>

<li>
<a href="revolution/2.x/case-studies-and-tutorials/developing-an-extra-in-modx-revolution-modx-2.1-and-earlier#DevelopinganExtrainMODXRevolution-MODX2.1andEarlier-BuildingtheQuery">Building the Query</a>
</li>

<li>
<a href="revolution/2.x/case-studies-and-tutorials/developing-an-extra-in-modx-revolution-modx-2.1-and-earlier#DevelopinganExtrainMODXRevolution-MODX2.1andEarlier-TheDoodlesclassgetChunkMethod">The Doodles class getChunk Method</a>
</li>
</ul>
</li>

<li>
<a href="revolution/2.x/case-studies-and-tutorials/developing-an-extra-in-modx-revolution-modx-2.1-and-earlier#DevelopinganExtrainMODXRevolution-MODX2.1andEarlier-Summary">Summary</a>
</li>
</ul>
</div>

<h2>
<a name="DevelopinganExtrainMODXRevolution-MODX2.1andEarlier-Overview" id="DevelopinganExtrainMODXRevolution-MODX2.1andEarlier-Overview"></a>Overview
</h2>

<p>
This tutorial is written as a comprehensive example on developing Extras for MODX Revolution - as well as how to setup your Extra to be easily packaged into a Transport Package, as well as able to be developed outside the MODX webroot so that source control (such as Git) can be used.
</p>

<p>
The overview will be dissecting the "Doodles" Extra, which is a simple Extra that uses a custom table to store objects called "Doodles", which have a name and a description. We'll have a Snippet that pulls them and displays a list of them that is templatable via a Chunk, a Custom Manager Page using ExtJS to have a CRUD grid for editing, and a build script for packaging. And we'll make it all i18n-compatible to allow easy translating. <b>This is an extremely comprehensive tutorial</b>, so if you're wanting only specific parts, use the Table of Contents above.
</p>

<div class="note">
The Doodles Extra in this tutorial can be found on GitHub, here: <a href="https://github.com/splittingred/Doodles/tree/2.1" class="external-link" rel="nofollow">https://github.com/splittingred/Doodles/tree/2.1</a>
</div>

<h2>
<a name="DevelopinganExtrainMODXRevolution-MODX2.1andEarlier-SettingUpOurDirectories" id="DevelopinganExtrainMODXRevolution-MODX2.1andEarlier-SettingUpOurDirectories"></a>Setting Up Our Directories
</h2>

<p>
There are many ways that you could start developing your Extra - you could do so straight out of MODX and package it with a packaging tool like <a href="display/ADDON/PackMan" title="PackMan">PackMan</a>, or you could alternatively develop it outside of the MODX webroot and put it in a source control system such as <a href="http://github.com/" class="external-link" rel="nofollow">Git</a>. This tutorial will be doing the latter method, as it is beneficial for a few reasons:
</p>

<ul>
<li>Allows immediate development straight from your Git repository
</li>

<li>Allows easy collaboration between developers, as there is no copying files or changing core files - just developing in your preferred IDE and then doing some initial setup on paths.
</li>

<li>Allows isolation of your code to be independent of MODX's core - so if you need to move it, you can do it in only one place.
</li>
</ul>

<p>
Let's start. I've created a directory in my /www/ directory at: /www/doodles/
</p>

<p>
You can do it wherever you want, but for this tutorial I'll refer to /www/doodles/. Make sure that this directory is <b>web-accessible</b> locally, as you'll need that later on. I have /www/ setup as / on my localhost environment, for example.
</p>

<div class="note">
You <b>may</b> have to add a System Setting in your MODX install called session_cookie_path and give it a value of "/" (no quotations). This will tell MODX to use the same session when you're running stuff at <a href="http://localhost/doodles/" class="external-link" rel="nofollow">http://localhost/doodles/</a>. Also, giving it a unique name via session_cookie_name (like "modxlocaldevsession") is a good idea too. That'll prevent conflicts with other MODX installs on your local machine. If you do this, empty the core/cache/ directory and relogin after doing so.
</div>

<p>
In here, we'll have quite a few directories:
</p>

<p>
<span class="image-wrap" style=""><img src="download/attachments/37683302/doodles-dir-structure.png?version=1&amp;modificationDate=1325795501000" style="border: 0px solid black" /></span>
</p>

<p>
Let's note a few things. First off, our main 3 directories are core/, assets/ and _build/. Let's explain a few things about how MODX Extras work - typically (although this does not have to be done), Extras are separated into 2 different directories when installed: core/components/myextra/ and assets/components/myextra/. Why? Well, the assets/components/ directory <b>only</b> contains the web-specific assets - JavaScript files, CSS files, etc. These are the files you want publically accessible to the web. All the PHP files, classes, maps, and other files, however, are in the core/components/ directory. This keeps those files secure in the core/ directory (which can be moved outside the webroot in some MODX installations for even more security).
</p>

<p>
They're separated into our directory structure here to mimic how they will be in the MODX installation after it's installed by the Transport Package.
</p>

<p>
The _build/ directory isn't even packaged into the zip file after we create a Transport Package for it. It's there primarily for building the Transport Package. We'll get into that near the end of the tutorial.
</p>

<p>
Let's dive deeper into each subdirectory. In the assets/ directory, the only not-obvious file is the connector.php. This file will allow us to have custom processors for our Custom Manager Page (CMP) we'll be writing. We'll get more into that later.
</p>

<p>
In the core/components/doodles/ directory, we have a few directories worth explaining:
</p>

<ul>
<li>
<b>controllers</b> - These are the controllers for our CMP. More on those later.
</li>

<li>
<b>docs</b> - Just contains a changelog, readme and license file.
</li>

<li>
<b>elements</b> - All our Snippets, Chunks, Plugins, etc.
</li>

<li>
<b>lexicon</b> - All our i18n language files. More on those later.
</li>

<li>
<b>model</b> - Where all of our classes lie, as well as our XML schema file for our custom database tables.
</li>

<li>
<b>processors</b> - All our custom processors for our CMP.
</li>
</ul>

<p>
Let's also note that this directory is <b>completely</b> outside of our MODX webroot (mine's installed in /www/modx/). So - yes. You can run "git init" and make yourself a Git repository out of the /www/doodles/ directory (or whatever you made it). And you can push that up, without having to worry about it (though there's a few files we'll talk about later you'll want to add to a .gitignore file).
</p>

<p>
There we have it. A completely isolated development environment from MODX so that we can do separate development and seamless collaboration. Let's get further in.
</p>

<h2>
<a name="DevelopinganExtrainMODXRevolution-MODX2.1andEarlier-CreatingtheDoodlesSnippet" id="DevelopinganExtrainMODXRevolution-MODX2.1andEarlier-CreatingtheDoodlesSnippet"></a>Creating the Doodles Snippet
</h2>

<p>
Okay. Go ahead and create a Snippet file in:
</p>

<p>
/www/doodles/core/components/doodles/elements/snippets/snippet.doodles.php
</p>

<p>
You'll have to make a snippets/ directory, if you haven't already. Your file should be empty, but let's add a few lines of code:
</p>

<pre class="brush: php">
    
$defaultDoodlesCorePath = $modx-&gt;getOption('core_path').'components/doodles/';
$doodlesCorePath = $modx-&gt;getOption('doodles.core_path',null,$defaultDoodlesCorePath);
$doodles = $modx-&gt;getService('doodles','Doodles',$doodlesCorePath.'model/doodles/',$scriptProperties);

    
</pre>
<p>
Okay, so first off, what is $modx-&gt;getOption? That's a method that grabs the System Setting with the key (the first parameter). In the first line, we are grabbing a 'default' path we are assuming our Doodles core path is going to be, by prefixing the MODX core path to it. It'll be: /www/modx/core/components/doodles/
</p>

<p>
Next, we'll pass that as a fallback value for the next getOption call. This one passes 3 parameters: a key named "doodles.core_path", null, and our default path var we just assigned. In getOption, the 2nd parameter is an array to search for the key (which we aren't doing, so we can set it to null), and the 3rd paramter is a default value if the key isn't found.
</p>

<p>
So, for right now, our 2nd line will return /www/modx/core/components/doodles/. But that's not where our Doodles core path is! (hint: it's at /www/doodles/core/components/doodles). We want to tell these lines to find it there. So what do we do?
</p>

<h3>
<a name="DevelopinganExtrainMODXRevolution-MODX2.1andEarlier-MakingtheMagicPathSettings" id="DevelopinganExtrainMODXRevolution-MODX2.1andEarlier-MakingtheMagicPathSettings"></a>Making the Magic Path Settings
</h3>

<p>
We set a couple System Settings (that are specific to our development environment) that tell these lines where to get our files! Go ahead and make the following System Settings and set their values:
</p>

<ul>
<li>
<b>doodles.core_path</b> - /www/doodles/core/components/doodles/
</li>

<li>
<b>doodles.assets_url</b> - /doodles/assets/components/doodles/
</li>
</ul>

<p>
If you need to change either of those to reflect your correct paths, such as the URL one, do so. Now our first line will return: /www/doodles/core/components/doodles/ Bingo! Cool, huh?
</p>

<p>
Why do we do this? Why not just refer to /www/doodles/core/components/doodles/? Well, that wouldn't work in someone else's installation. There's is most likely to be at MODXPATH/core/components/doodles/. Our Transport Package (later) will handle all of that dynamic path stuff, but we want to add an override to allow us to develop Doodles outside of the MODX path. And we just did. Coding bliss!
</p>

<p>
Now on to the third line:
</p>

<pre class="brush: php">
    
class Doodles {
    public $modx;
    public $config = array();
    function __construct(modX &amp;$modx,array $config = array()) {
        $this-&gt;modx =&amp; $modx;

        $basePath = $this-&gt;modx-&gt;getOption('doodles.core_path',$config,$this-&gt;modx-&gt;getOption('core_path').'components/doodles/');
        $assetsUrl = $this-&gt;modx-&gt;getOption('doodles.assets_url',$config,$this-&gt;modx-&gt;getOption('assets_url').'components/doodles/');
        $this-&gt;config = array_merge(array(
            'basePath' =&gt; $basePath,
            'corePath' =&gt; $basePath,
            'modelPath' =&gt; $basePath.'model/',
            'processorsPath' =&gt; $basePath.'processors/',
            'chunksPath' =&gt; $basePath.'elements/chunks/',
            'jsUrl' =&gt; $assetsUrl.'js/',
            'cssUrl' =&gt; $assetsUrl.'css/',
            'assetsUrl' =&gt; $assetsUrl,
            'connectorUrl' =&gt; $assetsUrl.'connector.php',
        ),$config);
        $this-&gt;modx-&gt;addPackage('doodles',$this-&gt;config['modelPath']);
    }
}

    
</pre>
<p>
Great! It's pretty simple for now - just creates a class object that has a constructor that sets a reference to the modX object at $doodles-&gt;modx. This is useful later. Also, it populates some basic paths we may use later on into the $doodles-&gt;config array, and it does it with our fancy System Settings trick so we can point it to our /www/doodles/ path!
</p>

<p>
Now, back to our Snippet. Let's go ahead and add some default properties to our Snippet, after the lines above, so it looks like this:
</p>

<pre class="brush: php">
    &lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;model package="doodles" baseClass="xPDOObject" platform="mysql" defaultEngine="MyISAM"&gt;
    &lt;object class="Doodle" table="doodles" extends="xPDOSimpleObject"&gt;
        &lt;field key="name" dbtype="varchar" precision="255" phptype="string" null="false" default=""/&gt;
        &lt;field key="description" dbtype="text" phptype="string" null="false" default=""/&gt;

        &lt;field key="createdon" dbtype="datetime" phptype="datetime" null="true"/&gt;
        &lt;field key="createdby" dbtype="int" precision="10" attributes="unsigned" phptype="integer" null="false" default="0" /&gt;
        &lt;field key="editedon" dbtype="datetime" phptype="datetime" null="true"/&gt;
        &lt;field key="editedby" dbtype="int" precision="10" attributes="unsigned" phptype="integer" null="false" default="0" /&gt;

        &lt;aggregate alias="CreatedBy" class="modUser" local="createdby" foreign="id" cardinality="one" owner="foreign"/&gt;
        &lt;aggregate alias="EditedBy" class="modUser" local="editedby" foreign="id" cardinality="one" owner="foreign"/&gt;
    &lt;/object&gt;
&lt;/model&gt;
    
</pre>
<p>
Ooookay. Lots of stuff here. First off, the first line:
</p>

<pre class="brush: php">
    &lt;object class="Doodle" table="doodles" extends="xPDOSimpleObject"&gt;
    
</pre>
<p>
An "object" in a xPDO schema is basically a database table. This line says, give xPDO a name for the table called '{table_prefix}<em>doodles'. Assuming your table prefix you did in your MODX install is 'modx</em>', it would translate to 'modx_doodles'. Then it says that it extends "xPDOSimpleObject". What's that? Well, xPDOObject is the base object for any xPDO table class. xPDOSimpleObject extends it, but adds a nice little "id" auto-increment field to that table. So, since we're gonna want a "id" field on our table, we use xPDOSimpleObject.
</p>

<pre class="brush: php">
    &lt;aggregate alias="CreatedBy" class="modUser" local="createdby" foreign="id" cardinality="one" owner="foreign"/&gt;
&lt;aggregate alias="EditedBy" class="modUser" local="editedby" foreign="id" cardinality="one" owner="foreign"/&gt;
    
</pre>
<p>
Okay, this is where related objects come in with xPDO. For the purposes of this tutorial, just know that this tells xPDO that the createdby field maps to a modUser, and the editedby field maps to another modUser. Cool? Now let's get into parsing that xml file and creating our classes and maps.
</p>

<h3>
<a name="DevelopinganExtrainMODXRevolution-MODX2.1andEarlier-TheSchemaParsingScript" id="DevelopinganExtrainMODXRevolution-MODX2.1andEarlier-TheSchemaParsingScript"></a>The Schema Parsing Script
</h3>

<p>
Now it's time to look at our elusive _build directory. Go ahead and create a file in there: /www/doodles/_build/build.schema.php and put this in:
</p>

<pre class="brush: php">
    
&lt;?php
define('MODX_BASE_PATH', '/www/modx/');
define('MODX_CORE_PATH', MODX_BASE_PATH . 'core/');
define('MODX_MANAGER_PATH', MODX_BASE_PATH . 'manager/');
define('MODX_CONNECTORS_PATH', MODX_BASE_PATH . 'connectors/');
define('MODX_ASSETS_PATH', MODX_BASE_PATH . 'assets/');

define('MODX_BASE_URL','/modx/');
define('MODX_CORE_URL', MODX_BASE_URL . 'core/');
define('MODX_MANAGER_URL', MODX_BASE_URL . 'manager/');
define('MODX_CONNECTORS_URL', MODX_BASE_URL . 'connectors/');
define('MODX_ASSETS_URL', MODX_BASE_URL . 'assets/');

    
</pre>
<p>
Obviously, you may need to change those paths to wherever your MODX installation is at.
</p>

<p>
Now, you can go to your _build/build.schema.php file, and run it. I do it by loading up in a web browser: <a href="http://localhost/doodles/_build/build.schema.php" class="external-link" rel="nofollow">http://localhost/doodles/_build/build.schema.php</a>. You may need to change that URL to wherever you made the doodles directory web-accessible (you did like I said to earlier, didn't you? If not, now's a good time!).
</p>

<p>
That should run and generate you some nice pretty class files and maps:
</p>

<p>
<span class="image-wrap" style=""><img src="download/attachments/37683302/doodles-maps.png?version=1&amp;modificationDate=1325795501000" style="border: 0px solid black" /></span>
</p>

<p>
Bravo! You've just made your maps and classes. Let's go make an adjustment to our Doodles base class, so it automatically adds in the Doodles xPDO package whenever we load the class. Add this line after the $this-&gt;config = array_merge part, at the end of the constructor:
</p>

<pre class="brush: php">
    
$dood = $modx-&gt;getService('doodles','Doodles',$modx-&gt;getOption('doodles.core_path',null,$modx-&gt;getOption('core_path').'components/doodles/').'model/doodles/',$scriptProperties);
if (!($dood instanceof Doodles)) return '';

/* setup default properties */
$tpl = $modx-&gt;getOption('tpl',$scriptProperties,'rowTpl');
$sort = $modx-&gt;getOption('sort',$scriptProperties,'name');
$dir = $modx-&gt;getOption('dir',$scriptProperties,'ASC');

$output = '';

return $output;

    
</pre>
<p>
Pretty lame snippet, eh? Well, all we're doing right now is setting up the Doodles class object into a variable called $dood, and setting up some defaults for properties we'll use later. $scriptProperties is an array, by the way, of all the properties passed into the Snippet. The getOption calls here parse it to find the properties in them, and if not set, gives them default values.
</p>

<h3>
<a name="DevelopinganExtrainMODXRevolution-MODX2.1andEarlier-TheincludeSnippet" id="DevelopinganExtrainMODXRevolution-MODX2.1andEarlier-TheincludeSnippet"></a>The include Snippet
</h3>

<p>
You're probably also thinking, "It's not even in the MODX manager yet! Who is this guy and who does he think he's kidding?" Good question. Well, let's do that then!
</p>

<p>
Now, to preserve our custom System Setting-based paths we did earlier, we're not going to want to actually create a Doodles snippet in our manager, and paste its code in there. That'd make it pretty annoying to develop - lots of copy+paste, etc. So, we're going to make a generic "include" snippet that looks like this:
</p>

<pre class="brush: php">
    [[!include? &amp;file=`[[++doodles.core_path]]elements/snippets/snippet.doodles.php`]]
    
</pre>
<p>
This says, "Include and run the file in the Doodles core path System Setting we set at earlier, plus concatenate to the end of that path 'elements/snippets/snippet.doodles.php'". That'll resolve to:
</p>

<p>
/www/doodles/core/components/doodles/elements/snippets/snippet.doodles.php
</p>

<p>
Which works perfect for us! Then we can edit our Snippet in our favorite IDE and go about our business. It'll also pass any properties we pass into the include snippet call into our Doodles snippet as well. Cool! Back to the Snippet.
</p>

<h3>
<a name="DevelopinganExtrainMODXRevolution-MODX2.1andEarlier-BuildingtheQuery" id="DevelopinganExtrainMODXRevolution-MODX2.1andEarlier-BuildingtheQuery"></a>Building the Query
</h3>

<p>
First off, we need to create the table. This will be done in a resolver later, but for now, just add this to your snippet, before the return statement:
</p>

<pre class="brush: php">
    $doodles = $modx-&gt;getCollection('Doodle');
$output = count($doodles);
    
</pre>
<p>
That's going to grab an array of Doodle objects, or in non-xPDO terms, a bunch of rows from the database. Go ahead and save your snippet, then run it in the browser at <a href="http://localhost/modx/doodles.html" class="external-link" rel="nofollow">http://localhost/modx/doodles.html</a> (or wherever the Resource was). You should get this:
</p>

<blockquote>
<p>
0
</p>
</blockquote>

<p>
Ha, tricked you! In reality, the first time it runs it wont grab anything, since we don't have any data in the table. Let's go put some data in the table.
</p>

<p>
Use whatever DB editing software (such as phpMyAdmin) you want, and find the 'modx_doodles' table in your database. Add a few rows to it (just add name/description values for now). That should give you some data. Let's assume you added 2 rows. Go ahead and run your snippet, and you should get:
</p>

<blockquote>
<p>
2
</p>
</blockquote>

<p>
Great! Your custom database query works! Let's make it more complex. We can use xPDO's <a href="display/xPDO20/xPDOQuery" title="xPDOQuery">xPDOQuery</a> to create some pretty complex queries. For now, let's just add a sort command to it:
</p>

<pre class="brush: php">
    
    public function getChunk($name,$properties = array()) {
        $chunk = null;
        if (!isset($this-&gt;chunks[$name])) {
            $chunk = $this-&gt;_getTplChunk($name);
            if (empty($chunk)) {
                $chunk = $this-&gt;modx-&gt;getObject('modChunk',array('name' =&gt; $name));
                if ($chunk == false) return false;
            }
            $this-&gt;chunks[$name] = $chunk-&gt;getContent();
        } else {
            $o = $this-&gt;chunks[$name];
            $chunk = $this-&gt;modx-&gt;newObject('modChunk');
            $chunk-&gt;setContent($o);
        }
        $chunk-&gt;setCacheable(false);
        return $chunk-&gt;process($properties);
    }

    private function _getTplChunk($name,$postfix = '.chunk.tpl') {
        $chunk = false;
        $f = $this-&gt;config['chunksPath'].strtolower($name).$postfix;
        if (file_exists($f)) {
            $o = file_get_contents($f);
            $chunk = $this-&gt;modx-&gt;newObject('modChunk');
            $chunk-&gt;set('name',$name);
            $chunk-&gt;setContent($o);
        }
        return $chunk;
    }
    
</pre>
<p>
For now, all you need to know is that these methods will look for Chunks in your /www/doodles/core/components/doodles/elements/chunks/ directory, postfixed with '.chunk.tpl' and all in lowercase. If it doesn't find them on the filesystem, it looks for them in MODX. So, if we called:
</p>

<pre class="brush: php">
    &lt;li&gt;&lt;strong&gt;[[+name]]&lt;/strong&gt; - [[+description]]&lt;/li&gt;
    
</pre>
<p>
Now add this below your query but above the return line in your Snippet:
</p>

<pre class="brush: php">
    &lt;?php
$dood = $modx-&gt;getService('doodles','Doodles',$modx-&gt;getOption('doodles.core_path',null,$modx-&gt;getOption('core_path').'components/doodles/').'model/doodles/',$scriptProperties);
if (!($dood instanceof Doodles)) return '';

/* setup default properties */
$tpl = $modx-&gt;getOption('tpl',$scriptProperties,'rowTpl');
$sort = $modx-&gt;getOption('sort',$scriptProperties,'name');
$dir = $modx-&gt;getOption('dir',$scriptProperties,'ASC');

/* build query */
$c = $modx-&gt;newQuery('Doodle');
$c-&gt;sortby($sort,$dir);
$doodles = $modx-&gt;getCollection('Doodle',$c);

/* iterate */
$output = '';
foreach ($doodles as $doodle) {
    $doodleArray = $doodle-&gt;toArray();
    $output .= $dood-&gt;getChunk($tpl,$doodleArray);
}

return $output;
    
</pre>
<p>
And we've got it loading our custom base class from our System Setting-defined paths, adding our custom xPDO db package, pulling from our custom database table, and outputting it via a Chunk. Cool, huh?
</p>

<h2>
<a name="DevelopinganExtrainMODXRevolution-MODX2.1andEarlier-Summary" id="DevelopinganExtrainMODXRevolution-MODX2.1andEarlier-Summary"></a>Summary
</h2>

<p>
We've got ourselves a nice custom database model, which our Doodles Snippet using to grab Doodles records from our database. We also have looked at the basic structure for a comprehensive MODX Extra.
</p>

<p>
But we're gonna want some way of editing that data in the MODX manager, right? Well, that's where Custom Manager Pages (CMPs) come in. Go on and proceed to the <a href="display/revolution20/Developing+an+Extra+in+MODX+Revolution%2C+Part+II+-+MODX+2.1+and+Earlier" title="Developing an Extra in MODX Revolution, Part II - MODX 2.1 and Earlier">next part of this tutorial</a>.
</p>

<div class="panel" style="border-width: 1px;">
<div class="panelContent">
<p>
This tutorial is part of a Series:
</p>

<ul>
<li>Part I: Getting Started and Creating the Doodles Snippet
</li>

<li>
<a href="display/revolution20/Developing+an+Extra+in+MODX+Revolution%2C+Part+II+-+MODX+2.1+and+Earlier" title="Developing an Extra in MODX Revolution, Part II - MODX 2.1 and Earlier">Part II: Creating our Custom Manager Page</a>
</li>

<li>
<a href="display/revolution20/Developing+an+Extra+in+MODX+Revolution%2C+Part+III+-+MODX+2.1+and+Earlier" title="Developing an Extra in MODX Revolution, Part III - MODX 2.1 and Earlier">Part III: Packaging Our Extra</a>
</li>
</ul>
</div>
</div>