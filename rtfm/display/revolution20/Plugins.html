<div>
<ul>
<li>
<a href="revolution/2.x/developing-in-modx/basic-development/plugins#Plugins-WhatisaPlugin%3F">What is a Plugin?</a>
</li>

<li>
<a href="revolution/2.x/developing-in-modx/basic-development/plugins#Plugins-TheEventModel">The Event Model</a>
</li>

<li>
<a href="revolution/2.x/developing-in-modx/basic-development/plugins#Plugins-HandlinganEvent">Handling an Event</a>
</li>

<li>
<a href="revolution/2.x/developing-in-modx/basic-development/plugins#Plugins-PluginExamples">Plugin Examples</a>
</li>

<li style="list-style: none; display: inline">
<ul>
<li>
<a href="revolution/2.x/developing-in-modx/basic-development/plugins#Plugins-MessagetheUser%3A">Message the User:</a>
</li>

<li>
<a href="revolution/2.x/developing-in-modx/basic-development/plugins#Plugins-CustomValidation">Custom Validation</a>
</li>

<li>
<a href="revolution/2.x/developing-in-modx/basic-development/plugins#Plugins-WordFilter">Word Filter</a>
</li>

<li>
<a href="revolution/2.x/developing-in-modx/basic-development/plugins#Plugins-PageNotFoundRedirector%3A">Page-Not-Found Redirector:</a>
</li>
</ul>
</li>

<li>
<a href="revolution/2.x/developing-in-modx/basic-development/plugins#Plugins-SeeAlso">See Also</a>
</li>
</ul>
</div>

<h2>
<a name="Plugins-WhatisaPlugin%3F"></a>What is a Plugin?
</h2>

<p>
Plugins are similar to Snippets in that they are bits of PHP code that have access to the MODx API. The big difference, however, is in <em>when</em> the code executes. You put Snippets inside of a page or inside a template and they run when the page is viewed, whereas Plugins are set to execute during certain system events, e.g. saving a Chunk, or emptying the cache. So when a given event "fires", any Plugin "listening" for that event is executed. Once the Plugin's code has executed, control returns to the point after the spot where the System Event was triggered.
</p>

<div class="info">
<strong>Other CMSs</strong>
<br />
Every CMS uses some concept of "plugin", but the exact nomenclature may differ. In WordPress, for example, plugins are "hooked" to events called "actions" or "filters".
</div>

<p>
Since they execute during various events, Plugins aren't limited to front-end processing. Many events are triggered by events that take place only within the MODx Manager. There is a list of MODx System Events <a href="http://wiki.modxcms.com/index.php/System_Events" title="MODx System Events" class="external-link" rel="nofollow">here</a>.
</p>

<div class="info">
Any closing PHP tag ?&gt; will be stripped from your plugin code when it is saved. It's unnecessary (and unwanted) because the plugin code will end up inside other PHP code when executed.
</div>

<h2>
<a name="Plugins-TheEventModel" id="Plugins-TheEventModel"></a>The Event Model
</h2>

<p>
MODx invokes System Events across its code processes to allow you to modify core functionality without hacking the core. These System Events can have any number of Plugins attached to them, and will execute each Plugin in rank according to its priority (lowest numbers first).
</p>

<h2>
<a name="Plugins-HandlinganEvent" id="Plugins-HandlinganEvent"></a>Handling an Event
</h2>

<p>
In your Plugin, how you handle the output depends on the System Event you are in. For some system events, you return a value from the Plugin. For others, you access the output by reference and modify it.
</p>

<p>
If you need to know which event triggered your plugin (say, for a plugin that listens to more than one event), you can access the Event's name like so:
</p>

<pre class="brush: php">
$eventName = $modx-&gt;event-&gt;name;
</pre>
<p>
The code for a Plugin listening to more than one event looks like this:
</p>

<pre class="brush: php">
$eventName = $modx-&gt;event-&gt;name;
switch($eventName) {
    case 'OnWebPageInit':
        /* do something */
        break;
    case 'OnWebPagePrerender':
        /* do something else */
        break;
}
</pre>
<h2>
<a name="Plugins-PluginExamples" id="Plugins-PluginExamples"></a>Plugin Examples
</h2>

<p>
Plugins can be used for a variety of different applications, below are a couple of examples:
</p>

<h3>
<a name="Plugins-MessagetheUser%3A"></a>Message the User:
</h3>

<p>
<strong>Description:</strong> Send a custom message to the user as they create/edit a page... a custom header.
<br />
<strong>System Events:</strong> OnDocFormPrerender
</p>

<pre class="brush: php">
$modx-&gt;event-&gt;output('Hi there user!');
</pre>
<h3>
Custom Validation
</h3>

<p>
<strong>Description:</strong> Do some custom validation on saving a page resource
</p>

<p>
<strong>System Events:</strong> OnBeforeDocFormSave
</p>

<pre class="brush: php">
// Do some logical stuff.... if validation failed:
$modx-&gt;event-&gt;output('Something did not validate!');
return "This goes to the logs";&lt;br&gt;
</pre>
<p>
The trick here is that what you want to message the user has to be passed to the <strong>$modx-&gt;event-&gt;output()</strong> function; any text you want to write to the logs can simply be returned by the plugin. If you pass validation, simply return null.
</p>

<div class="warning">
<strong>No HTML Allowed</strong>
<br />
The output you set in <strong>$modx-&gt;event-&gt;output()</strong> must not contain any HTML! Use plain text only! This is because the message is passed to the user via a Javascript modal window.
</div>

<hr />

<h3>
<a name="Plugins-WordFilter" id="Plugins-WordFilter"></a>Word Filter
</h3>

<p>
<strong>Description:</strong> Filter words from a document before it's displayed on the web
<br />
<strong>System Events:</strong> OnWebPagePrerender
</p>

<pre class="brush: php">
$words = array("snippet", "template"); // words to filter
$output = &amp;$modx-&gt;resource-&gt;_output; // get a reference to the output
$output = str_replace($words,"&lt;b&gt;[filtered]&lt;/b&gt;",$output);
</pre>
<h3>
Page-Not-Found Redirector:
</h3>

<p>
<strong>Description:</strong> Redirects a user to selected document and sends a message
<br />
<strong>System Events:</strong> OnPageNotFound
<br />
<strong>System Settings:</strong>
</p>

<ul>
<li>
<em>pnf.page</em>: Error Resource ID
</li>

<li>
<em>pnf.mailto</em>: Mail To Address
</li>

<li>
<em>pnf.mailfrom</em>: Mail From Address
</li>
</ul>

<pre class="brush: php">
if ($modx-&gt;event-&gt;name == 'OnPageNotFound') {     
   $errorPage = $modx-&gt;getOption('pnf.page');
     if (empty($errorPage)) {
         $modx-&gt;sendErrorPage();
     } else {
         $mailto = $modx-&gt;getOption('pnf.mailto');
         if (!empty($mailto)) {
            // send a message to a local account
            $resourceId = $modx-&gt;resource-&gt;get('id');
            $subject = 'Page not found';
            $body = 'Someone tried to access document id '.$resourceId;
            $modx-&gt;getService('mail', 'mail.modPHPMailer');
            $modx-&gt;mail-&gt;set(modMail::MAIL_BODY, $body);
            $modx-&gt;mail-&gt;set(modMail::MAIL_FROM, '$modx-&gt;getOption('pnf.mailfrom'));
            $modx-&gt;mail-&gt;set(modMail::MAIL_FROM_NAME, 'MODx');
            $modx-&gt;mail-&gt;set(modMail::MAIL_SENDER, 'MODx');
            $modx-&gt;mail-&gt;set(modMail::MAIL_SUBJECT, $subject);
            $modx-&gt;mail-&gt;address('to',$mailto);
            $modx-&gt;mail-&gt;setHTML(true);
            $modx-&gt;mail-&gt;send();
         }
         $url = $this-&gt;makeUrl($scriptProperties['page']);
         $modx-&gt;sendRedirect($url, 1);
         exit;
    }
}
</pre>
<h2>
<a name="Plugins-SeeAlso" id="Plugins-SeeAlso"></a>See Also
</h2>

<ol class="ug-toc">
<li>
<a href="revolution/2.x/developing-in-modx/basic-development/plugins/system-events">System Events</a>
</li>
</ol>