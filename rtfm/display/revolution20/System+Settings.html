<p>
<br class="atl-forced-newline" />
</p>

<div>
<ul>
<li>
<a href='#SystemSettings-CreatingnewSystemSettings%28viatheGUI%29'>Creating new System Settings (via the GUI)</a>
</li>

<li style="list-style: none; display: inline">
<ul>
<li>
<a href='#SystemSettings-Parameters'>Parameters</a>
</li>

<li>
<a href='#SystemSettings-Localization'>Localization</a>
</li>
</ul>
</li>

<li>
<a href='#SystemSettings-UsingSystemSettingsinyourCode'>Using System Settings in your Code</a>
</li>

<li style="list-style: none; display: inline">
<ul>
<li>
<a href='#SystemSettings-GettingaSystemSetting%28programmatically%29'>Getting a System Setting (programmatically)</a>
</li>

<li>
<a href='#SystemSettings-SavingaSystemSetting%28programmatically%29'>Saving a System Setting (programmatically)</a>
</li>

<li>
<a href='#SystemSettings-RetrievingaSetting%27sMetaData'>Retrieving a Setting's Meta Data</a>
</li>
</ul>
</li>

<li>
<a href='#SystemSettings-RetrievingalistofRelatedSettings'>Retrieving a list of Related Settings</a>
</li>

<li>
<a href='#SystemSettings-CreatingaSystemSettingProgrammatically'>Creating a System Setting Programmatically</a>
</li>

<li>
<a href='#SystemSettings-TypesofSystemSettings'>Types of System Settings</a>
</li>

<li>
<a href='#SystemSettings-SettingsList'>Settings List</a>
</li>
</ul>
</div>

<p>
MODx comes with a flexible amount of system settings. They are found in System -&gt; System Settings, and can easily be edited and changed. All system settings are available in your templates by using the [[++placeholder]] notation. See <a href="http://rtfm.modx.com/display/revolution20/Commonly+Used+Template+Tags" class="external-link" rel="nofollow">Template Tags</a> for more information.
</p>
<object width="780" height="500">
<param name="movie" value="http://vimeo.com/moogaloop.swf?clip_id=10433411&amp;amp;server=vimeo.com&amp;amp;show_title=1&amp;amp;show_byline=1&amp;amp;show_portrait=0&amp;amp;color=&amp;amp;fullscreen=1" />
<param name="allowFullScreen" value="true" />
<param name="allowscriptaccess" value="always" />
<embed src="http://vimeo.com/moogaloop.swf?clip_id=10433411&amp;amp;server=vimeo.com&amp;amp;show_title=1&amp;amp;show_byline=1&amp;amp;show_portrait=0&amp;amp;color=&amp;amp;fullscreen=1" type="application/x-shockwave-flash" allowfullscreen="true" allowscriptaccess="always" width="780" height="500" flashvars="$flashVars" />
</object>
<h2>
<a name="SystemSettings-CreatingnewSystemSettings%28viatheGUI%29"></a>Creating new System Settings (via the GUI)
</h2>

<p>
To create a new system setting, click the "Create New Settings" link under System -&gt; System Settings.
</p>

<p>
<span class="image-wrap" style="display: block; text-align: center"><img src="/download/attachments/18678127/system+settings+annotated.png?version=1&amp;modificationDate=1303174387000" style="border: 0px solid black" /></span>
</p>

<h3>
<a name="SystemSettings-Parameters"></a>Parameters
</h3>

<ul>
<li>Key: This is ultimately the unique name of your [[++placeholder]]
</li>

<li>Name: This is the label displayed in the "Name" column while viewing all system settings. This value can be localized (see below).
</li>

<li>Field Type: There are currently 3 supported input types: TextField, TextArea, Yes/No
</li>

<li>Namespace: as with <a href="/display/revolution20/Custom+Manager+Pages" title="Custom Manager Pages">Custom Manager Pages</a>, the namespace defines a folder inside core/components/.
</li>

<li>Area Lexicon Entry: this value affects the grouping of system settings; create multiple system settings that share the "Area Lexicon Entry" and they will be grouped together.
</li>

<li>Value: The default value.
</li>

<li>Description: This value can be localized (see below).
</li>
</ul>

<h3>
<a name="SystemSettings-Localization"></a>Localization
</h3>

<p>
The values used to describe system settings can be optionally localized (i.e. translated) by referencing a specific localization file. The lexicon keys follow a specific format:
</p>

<ul>
<li>Name: <tt>setting_</tt> + <em>Key</em>
</li>

<li>Description: <tt>setting_</tt> + <em>Key</em> + <tt>_desc</tt>
</li>
</ul>

<p>
For example, if we look at Quip's [[++quip.emailsFrom]] setting, we see that it uses the the <b>quip</b> namespace. The expected folder structure is to look for localization files in the namespace's folder, then in a "lexicon" folder, then in folders divided by language codes, and then in the <b>default.inc.php</b> file, for example <b>core/components/quip/lexicon/en/default.inc.php</b>
</p>

<p>
In our Quip example, we see a name of <em>setting_quip.emailsFrom</em> and a description of <em>setting_quip.emailsFrom_desc</em>. These two values correspond to keys in the <b>$_lang</b> array inside of <b>default.inc.php</b>:
</p>

<div class="code panel" style="border-width: 1px;">
<div class="codeContent panelContent">
<pre class="code-java">
$_lang['setting_quip.emailsFrom'] = 'From Email';
$_lang['setting_quip.emailsFrom_desc'] = 'The email address to send system emails from.';
</pre>
</div>
</div>

<p>
We encourage you to right-click an existing system setting and choose to "Update System Setting" to get an idea of how this works.
</p>

<h2>
<a name="SystemSettings-UsingSystemSettingsinyourCode"></a>Using System Settings in your Code
</h2>

<p>
Frequently, you'll want to be able to retrieve the values for your system settings in your Snippets or Plugins. There's more information <a href="/display/revolution20/Settings" title="Settings">on this page</a>.
</p>

<h3>
<a name="SystemSettings-GettingaSystemSetting%28programmatically%29"></a>Getting a System Setting (programmatically)
</h3>

<p>
In a nutshell, you do it using the <a href="/display/xPDO20/getOption" title="getOption">getOption</a> function and passing it the unique key for the option, for example:
</p>

<div class="code panel" style="border-width: 1px;">
<div class="codeContent panelContent">
<pre class="code-java">
$siteStartId = $modx-&gt;getOption('site_start');
</pre>
</div>
</div>

<div class='panelMacro'>
<table class='noteMacro'>
<colgroup>
<col width='24' />
<col />
</colgroup>

<tr>
<td valign='top'>
<img src="/images/icons/emoticons/warning.gif" width="16" height="16" align="absmiddle" alt="" border="0" />
</td>
<td>
In WordPress, the comparable API function is <b>get_option()</b>.
</td>
</tr>
</table>
</div>

<p>
This function retrieves the value from the settings cache.
</p>

<h3>
<a name="SystemSettings-SavingaSystemSetting%28programmatically%29"></a>Saving a System Setting (programmatically)
</h3>

<p>
Here's where things get a little bit more complicated: when we retrieve the value using <a href="/display/xPDO20/getOption" title="getOption">getOption</a>, we are retrieving the object from the settings cache. This has the distinct advantage of speed, but it means that we essentially have a read-only copy of the setting's value.
</p>

<p>
This is for architectural reasons: the system settings are meant to defined as <em>configurations</em>, <b>NOT runtime dynamic values</b>. They are typically set at the time of install and then not often updated. However, there may be legitimate times when you need to update system settings programmatically, e.g. perhaps you have written a <a href="/display/revolution20/Custom+Manager+Pages+Tutorial" title="Custom Manager Pages Tutorial">Custom Manager Page</a> that offers a customized form to your users for its system settings.
</p>

<p>
If we want to update a system setting, we default to the powerful xPDO <a href="/display/xPDO20/xPDO.getObject" title="xPDO.getObject">getObject</a> function. So let's revisit our retrieval of a simple site setting and compare it side by side with the more verbose (and more flexible) xPDO counterpart:
</p>

<div class="code panel" style="border-width: 1px;">
<div class="codeContent panelContent">
<pre class="code-java">
print $modx-&gt;getOption('site_name');

<span class="code-comment">// prints the same thing as <span class="code-keyword">this</span>:
</span>
$Setting = $modx-&gt;getObject('modSystemSetting', 'site_name');
print $Setting-&gt;get('value');
</pre>
</div>
</div>

<p>
The difference is that using <b>getObject</b> retrieves the object from the database uncached, and we can do far more things with an object, including saving that object. So here's how we would retrieve and save a system setting:
</p>

<div class="code panel" style="border-width: 1px;">
<div class="codeContent panelContent">
<pre class="code-java">
$Setting = $modx-&gt;getObject('modSystemSetting', 'site_name');
$Setting-&gt;set('value', 'My New Site Name');
$Setting-&gt;save();
</pre>
</div>
</div>

<p>
However, note that this does not clear the settings cache, so any subsequent calls to <b>getOption</b> will still return the older cached version of the setting.
</p>

<p>
To rectify this in MODx 2.0.x, you have to clear the <em>entire</em> cache, including your page cache. Clearing your entire cache frequently could slow down your system because it would keep having to rebuild it:
</p>

<div class="code panel" style="border-width: 1px;">
<div class="codeContent panelContent">
<pre class="code-java">
<span class="code-comment">// clear cache in MODx 2.0.x
</span>$modx-&gt;cacheManager-&gt;clearCache();
</pre>
</div>
</div>

<p>
MODx 2.1.x offers more granular caching, which helps us in this case:
</p>

<div class="code panel" style="border-width: 1px;">
<div class="codeContent panelContent">
<pre class="code-java">
<span class="code-comment">// clear cache in MODx 2.1.x
</span>$cacheRefreshOptions =  array( 'system_settings' =&gt; array() );
$modx-&gt;cacheManager-&gt; refresh($cacheRefreshOptions);
</pre>
</div>
</div>

<div class='panelMacro'>
<table class='noteMacro'>
<colgroup>
<col width='24' />
<col />
</colgroup>

<tr>
<td valign='top'>
<img src="/images/icons/emoticons/warning.gif" width="16" height="16" align="absmiddle" alt="" border="0" />
</td>
<td>
In WordPress, the comparable API function is <b>update_option()</b>.
</td>
</tr>
</table>
</div>

<h3>
<a name="SystemSettings-RetrievingaSetting%27sMetaData"></a>Retrieving a Setting's Meta Data
</h3>

<p>
Once we start retrieving the <em>Objects</em> that represent the system settings instead of just their value, we can see all of the meta data for any given setting (i.e. all of the attributes). Look at this code as an example:
</p>

<div class="code panel" style="border-width: 1px;">
<div class="codeContent panelContent">
<pre class="code-java">
$Setting = $modx-&gt;getObject('modSystemSetting', 'site_name');
print_r( $Setting-&gt;toArray() );
/* 
prints out something like <span class="code-keyword">this</span>:
Array ( 
        [key] =&gt; site_name 
        [value] =&gt; My Skiphop Site 
        [xtype] =&gt; textfield 
        [namespace] =&gt; core 
        [area] =&gt; site 
        [editedon] =&gt; 2010-10-24 21:53:55 
)
*/
</pre>
</div>
</div>

<p>
Once you understand how to manipulate objects using MODx and xPDO, you'll be able to retrieve and modify just about everything inside of MODx, because just about everything is an object.
</p>

<h2>
<a name="SystemSettings-RetrievingalistofRelatedSettings"></a>Retrieving a list of Related Settings
</h2>

<p>
If you have noticed in the GUI above, MODx allows for some very logical grouping of system settings. The most useful groupings are <b>area</b> and by the prefix of the <b>key</b>. Using xPDO's <a href="/display/xPDO20/xPDO.getCollection" title="xPDO.getCollection">getCollection</a> method, we can easily supply some search criteria to get the settings that we want.
</p>

<p>
Here's how we would pull up all settings from the 'Mail' area:
</p>

<div class="code panel" style="border-width: 1px;">
<div class="codeContent panelContent">
<pre class="code-java">
$relatedSettings = $modx-&gt;getCollection('modSystemSetting', array('area'=&gt;'Mail'));
foreach ( $relatedSettings as $Setting ) {
        print $Setting-&gt;get('value');
}
</pre>
</div>
</div>

<p>
This leads us naturally to one of xPDO's other features: the <a href="/display/xPDO20/xPDOQuery" title="xPDOQuery">Query</a> object. We can use it to pass more complex criteria to our <b>getCollection call</b>. Here's how we would pull up all settings that used the prefix of "quip.":
</p>

<div class="code panel" style="border-width: 1px;">
<div class="codeContent panelContent">
<pre class="code-java">
$query = $modx-&gt;newQuery('modSystemSetting');
$query-&gt;where(array('key:LIKE' =&gt; 'quip.%') );
$relatedSettings = $modx-&gt;getCollection('modSystemSetting', $query);
foreach ( $relatedSettings as $Setting ) {
        print $Setting-&gt;get('value');
}
</pre>
</div>
</div>

<p>
You may not have been expecting an introduction to xPDO while you were simply trying to retrieve and set system settings, but it's in there.
</p>

<h2>
<a name="SystemSettings-CreatingaSystemSettingProgrammatically"></a>Creating a System Setting Programmatically
</h2>

<p>
You may desire to create a System Setting programmatically in order to provide your users with a cleaner UX/UI. In your code, you can put something like the following:
</p>

<div class="code panel" style="border-width: 1px;">
<div class="codeContent panelContent">
<pre class="code-java">
$MySetting = $modx-&gt;newObject('modSystemSetting');
$MySetting-&gt;set('key', 'mykey');
$MySetting-&gt;set('value', 'my_value');
$MySetting-&gt;set('xtype', 'textfield');
$MySetting-&gt;set('namespace', 'my_namespace');
$MySetting-&gt;set('area', 'MyArea');

$MySetting-&gt;save();

<span class="code-comment">// Clear the cache:
</span>$cacheRefreshOptions =  array( 'system_settings' =&gt; array() );
$modx-&gt;cacheManager-&gt; refresh($cacheRefreshOptions);
</pre>
</div>
</div>

<p>
Note that you must create lexicon entries that match your key name (see the section above on Localization):
</p>

<ul>
<li>Name: <tt>setting_</tt> + <em>Key</em>
</li>

<li>Description: <tt>setting_</tt> + <em>Key</em> + <tt>_desc</tt>
</li>
</ul>

<p>
So in this example, you would need to add the following lexicon entries to a lexicon that you have loaded:
</p>

<div class="code panel" style="border-width: 1px;">
<div class="codeContent panelContent">
<pre class="code-java">
$_lang['setting_mykey'] = 'Name of My Setting';
$_lang['setting_mykey_desc'] = 'Description of my key';
</pre>
</div>
</div>

<p>
MODX will populate the values for the name and description based on those lexicon entries.
</p>

<h2>
<a name="SystemSettings-TypesofSystemSettings"></a>Types of System Settings
</h2>

<p>
The <b>xtype</b> attribute defines what type of field the GUI will use when rendering the interface for this field:
</p>

<ul>
<li>
<b>combo-boolean</b> : stored values are 1 and 0; the GUI will display "Yes" and "No"
</li>

<li>
<b>textfield</b> : standard text field
</li>

<li>
<b>textarea</b> : standard textearea
</li>

<li>
<b>text-password</b> : standard password field (input is masked)
</li>

<li>
<b>numberfield</b> : used for entering numbers
</li>

<li>
<b>modx-combo-language</b> : allows user to select a language
</li>

<li>
<b>modx-combo-source</b> :
</li>

<li>
<b>modx-combo-template</b> : allows user to select a template
</li>

<li>
<b>modx-combo-content-type</b> : allows user to select a content type
</li>

<li>
<b>modx-combo-charset</b> : allows user to select a character set
</li>

<li>
<b>modx-combo-rte</b> : like the textarea, but with formatting controls
</li>

<li>
<b>modx-combo-context</b> : allows user to select a context
</li>
</ul>

<h2>
<a name="SystemSettings-SettingsList"></a>Settings List
</h2>

<p>
A description of each setting follows:
</p>

<div class="plugin_pagetree">
<div style="margin-left: 2em" class="plugin_pagetree_children_list plugin_pagetree_children_list_noleftspace">
<div class="plugin_pagetree_children">
</div>
</div>

<fieldset class="hidden">
<input type="hidden" name="treeId" value="" /> <input type="hidden" name="treeRequestId" value="/plugins/pagetree/naturalchildren.action?decorator=none&amp;excerpt=false&amp;sort=alpha&amp;reverse=false&amp;disableLinks=false" /> <input type="hidden" name="treePageId" value="18678127" /> <input type="hidden" name="noRoot" value="false" /> <input type="hidden" name="rootPageId" value="18678127" /> <input type="hidden" name="rootPage" value="" /> <input type="hidden" name="startDepth" value="4" /> <input type="hidden" name="spaceKey" value="revolution20" /> <input type="hidden" name="i18n-pagetree.loading" value="Loading..." /> <input type="hidden" name="i18n-pagetree.error.permission" value="Unable to load page tree. It seems that you do not have permission to view the root page." /> <input type="hidden" name="i18n-pagetree.eeror.general" value="There was a problem retrieving the page tree. Please check the server log file for more information." /> <input type="hidden" name="loginUrl" value="/login.action?os_destination=%2Fdisplay%2Frevolution20%2FSystem%2BSettings" />
<fieldset class="hidden">
<input type="hidden" name="ancestorId" value="18678127" />
</fieldset>
</fieldset>
</div>