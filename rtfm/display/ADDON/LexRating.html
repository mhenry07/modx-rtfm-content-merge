<div>
<ul>
<li>
<a href="#LexRating-Description">Description</a>
</li>

<li>
<a href="#LexRating-LexRating">LexRating</a>
<ul>
<li>
<a href="#LexRating-Properties">Properties</a>
</li>

<li>
<a href="#LexRating-Placeholders">Placeholders</a>
</li>

<li>
<a href="#LexRating-Example">Example</a>
</li>
</ul>
</li>

<li>
<a href="#LexRating-LexRatingList">LexRatingList</a>
<ul>
<li>
<a href="#LexRating-Properties">Properties</a>
</li>

<li>
<a href="#LexRating-Placeholders">Placeholders</a>
</li>

<li>
<a href="#LexRating-Example">Example</a>
</li>
</ul>
</li>

<li>
<a href="#LexRating-LexRatingQuipPostHook">LexRatingQuipPostHook</a>
</li>
</ul>
</div>

<h1 id="LexRating-Description">
Description
</h1>

<p>
LexRating (by <a href="http://twitter.com/_goldsky">goldsky</a>) is a jQuery's star rating plugin, based on <a href="http://rateit.codeplex.com">rateit.codeplex.com</a> (by <a href="http://twitter.com/gjunge">gidon</a>).
</p>

<p>
For MODX implementation, this extra uses AJAX to store the rating.
</p>

<p>
All issues can be notified in its <a href="https://github.com/goldsky/LexRating/issues">github's page</a>.
</p>

<p>
You can get it by downloading it via Package Manager.
</p>

<p>
There are 2 snippets for this package:
</p>

<ol>
<li>
<strong>LexRating</strong>,
</li>

<li>
<strong>LexRatingList</strong>, to list the rating results.
</li>
</ol>

<p>
There is a Quip's hook:&nbsp;<strong>LexRatingQuipPostHook</strong>, to create a star rating on each comment.
<br />
Think about a comment based star rating.
</p>

<p>
<a class="confluence-thumbnail-link 697x1105" href="/download/attachments/43417740/comment%20based%20rating.jpg"><img src="/download/thumbnails/43417740/comment%20based%20rating.jpg" style="border: 1px solid black" /></a>
</p>

<h1 id="LexRating-LexRating">
LexRating
</h1>

<p>
This snippet offers web visitor to give a rating into an object/item, based on the given name.
<br />
This snippet checks the visitor's IP address, and if visitor logged in, the visitor's ID
</p>

<h2 id="LexRating-Properties">
Properties
</h2>

<table>
<tbody>
<tr>
<th>
Name
</th>
<th>
Description
</th>
<th>
Example
</th>
<th>
Default Value
</th>
<th>
Options
</th>
</tr>

<tr>
<td>
name
</td>
<td>
Defines the name of the rating's item
</td>
<td>
&amp;name=`[[*pagetitle]]`
</td>
<td>
[[*id]]
</td>
<td>
string
</td>
</tr>

<tr>
<td>
group
</td>
<td>
Defines the rating's group name.
<br />
This will be useful to compare the results using LexRatingList
</td>
<td>
&amp;group=`articles`
</td>
<td>
modResource
</td>
<td>
string
</td>
</tr>

<tr>
<td>
userGroups
</td>
<td>
Defines who is able to vote.
</td>
<td>
&amp;userGroups=`Members`
</td>
<td>
empty
</td>
<td>
comma separated group names
</td>
</tr>

<tr>
<td>
extended
</td>
<td>
(@since 1.0.0-beta.2) To set and get an additional extended parameter of individual vote account
</td>
<td>
&amp;extended=`{"quipReplyId":"[<span class="error">[+idprefix]</span>][<span class="error">[+id]</span>]"}`
</td>
<td>
empty
</td>
<td>
practically any string
</td>
</tr>

<tr>
<td>
initialAjax
</td>
<td>
Load the initial values using Ajax
</td>
<td>
&amp;initialAjax=`1`
</td>
<td>
1
</td>
<td>
1 | 0
</td>
</tr>

<tr>
<td>
readOnly
</td>
<td>
(@since 1.0.0-beta.2) read only mode
</td>
<td>
&amp;readOnly=`1`
</td>
<td>
1
</td>
<td>
1 | 0
</td>
</tr>

<tr>
<td>
tpl
</td>
<td>
Template chunk for the output, can be chunk or file based chunk.
</td>
<td>
&amp;tpl=`[[++core_path]]templates/blabla.tpl`
</td>
<td>
lexrating
</td>
<td>
chunk name or file path
</td>
</tr>

<tr>
<td>
css
</td>
<td>
CSS filename
</td>
<td>
&amp;css=`assets/templates/css/blabla.css`
</td>
<td>
assets/components/lexrating/default/css/lexrating.css
</td>
<td>
string | empty - disabling
</td>
</tr>

<tr>
<td>
js
</td>
<td>
Javascript filename
</td>
<td>
&amp;css=`assets/templates/js/blabla.js`
</td>
<td>
assets/components/lexrating/default/js/lexrating.js
</td>
<td>
string | empty - disabling
</td>
</tr>

<tr>
<td>
loadjQuery
</td>
<td>
Auto load/disable jQuery
</td>
<td>
&amp;loadjQuery=`0`
</td>
<td>
1
</td>
<td>
1 | 0
</td>
</tr>

<tr>
<td>
phsPrefix
</td>
<td>
Prefix for placeholders
</td>
<td>
&amp;phsPrefix=`blabla.`
</td>
<td>
lexrating.
</td>
<td>
string
</td>
</tr>

<tr>
<td>
toArray
</td>
<td>
Return an array of placeholders
</td>
<td>
&amp;toArray=`1`
</td>
<td>
null
</td>
<td>
1 | 0 | null
</td>
</tr>

<tr>
<td>
toPlaceholder
</td>
<td>
Save the output into the given name placeholder
</td>
<td>
&amp;toPlaceholder=`my_rating`
</td>
<td>
null
</td>
<td>
string
</td>
</tr>
</tbody>
</table>

<h2 id="LexRating-Placeholders">
Placeholders
</h2>

<p>
To get the complete placeholders, just use <strong>&amp;toArray=`1`</strong> to spit out the keys.
</p>

<table>
<tbody>
<tr>
<th>
Name
</th>
<th>
Description
</th>
</tr>

<tr>
<td>
[[+lexrating.name]]
</td>
<td>
The name you specify in the snippet
</td>
</tr>

<tr>
<td>
[[+lexrating.group]]
</td>
<td>
The group name you specify in the snippet
</td>
</tr>

<tr>
<td>
[[+lexrating.total.voters]]
</td>
<td>
Total number of the voters
</td>
</tr>

<tr>
<td>
[[+lexrating.initialAjax]]
</td>
<td>
The property you set in the snippet call
</td>
</tr>
</tbody>
</table>

<h2 id="LexRating-Example">
Example
</h2>

<pre class="brush: php">
[[LexRating?
&amp;name=`[[*pagetitle]]`
&amp;group=`articles`
&amp;userGroups=`Members`
]]
</pre>
<p>
If you just want to display a rating of an item, use this
</p>

<pre class="brush: php">
[[LexRating?
&amp;name=`[[*pagetitle]]`
&amp;group=`articles`
&amp;initialAjax=`0`
&amp;readOnly=`1`
]]
</pre>
<h1 id="LexRating-LexRatingList">
LexRatingList
</h1>

<p>
This snippet retrieves the items of the LexRating's results based on the given group name.
</p>

<h2 id="LexRating-Properties">
Properties
</h2>

<table>
<tbody>
<tr>
<th>
Name
</th>
<th>
Description
</th>
<th>
Example
</th>
<th>
Default Value
</th>
<th>
Options
</th>
</tr>

<tr>
<td>
group
</td>
<td>
The group name to be retrieved
</td>
<td>
&amp;group=`articles`
</td>
<td>
modResource
</td>
<td>
string
</td>
</tr>

<tr>
<td>
limit
</td>
<td>
Limit the number of ouput
</td>
<td>
&amp;limit=`10`
</td>
<td>
10
</td>
<td>
int
</td>
</tr>

<tr>
<td>
offset
</td>
<td>
Query's limit offset
</td>
<td>
&amp;offset=`10`
</td>
<td>
0
</td>
<td>
int
</td>
</tr>

<tr>
<td>
sort
</td>
<td>
Sorting direction
</td>
<td>
&amp;sort=`asc`
</td>
<td>
desc
</td>
<td>
asc (lo-hi) | desc (hi-lo)
</td>
</tr>

<tr>
<td>
tplListWrapper
</td>
<td>
Template chunk for wrapper, can be chunk or file based chunk
</td>
<td>
&amp;tplListWrapper=`lexratinglist.wrapper`
</td>
<td>
lexratinglist.wrapper
</td>
<td>
chunk name or file path
</td>
</tr>

<tr>
<td>
tplListItem
</td>
<td>
Template chunk for each item, can be chunk or file based chunk
</td>
<td>
&amp;tplListItem=`lexratinglist.item`
</td>
<td>
lexratinglist.item
</td>
<td>
chunk name or file path
</td>
</tr>

<tr>
<td>
css
</td>
<td>
CSS filename
</td>
<td>
&amp;css=`assets/templates/css/blabla.css`
</td>
<td>
assets/components/lexrating/default/css/lexrating.css
</td>
<td>
string | empty - disabling
</td>
</tr>

<tr>
<td>
js
</td>
<td>
Javascript filename
</td>
<td>
&amp;css=`assets/templates/js/blabla.js`
</td>
<td>
assets/components/lexrating/default/js/lexrating.js
</td>
<td>
string | empty - disabling
</td>
</tr>

<tr>
<td>
loadjQuery
</td>
<td>
Auto load/disable jQuery
</td>
<td>
&amp;loadjQuery=`0`
</td>
<td>
1
</td>
<td>
1 | 0
</td>
</tr>

<tr>
<td>
phsPrefix
</td>
<td>
Prefix for placeholders
</td>
<td>
&amp;phsPrefix=`blabla.`
</td>
<td>
lexrating.
</td>
<td>
string
</td>
</tr>

<tr>
<td>
toArray
</td>
<td>
Return an array of placeholders
</td>
<td>
&amp;toArray=`1`
</td>
<td>
null
</td>
<td>
1 | 0 | null
</td>
</tr>

<tr>
<td>
toPlaceholder
</td>
<td>
Save the output into the given name placeholder
</td>
<td>
&amp;toPlaceholder=`my_rating`
</td>
<td>
null
</td>
<td>
string
</td>
</tr>
</tbody>
</table>

<h2 id="LexRating-Placeholders">
Placeholders
</h2>

<p>
To get the complete placeholders, just use <strong>&amp;toArray=`1`</strong> to spit out the keys.
</p>

<p>
<strong>WRAPPER</strong>
</p>

<table>
<tbody>
<tr>
<th>
Name
</th>
<th>
Description
</th>
</tr>

<tr>
<td>
[[+lexrating.list.items]]
</td>
<td>
The holder of the list of the items
</td>
</tr>
</tbody>
</table>

<p>
<strong>LIST</strong>
</p>

<table>
<tbody>
<tr>
<th>
Name
</th>
<th>
Description
</th>
</tr>

<tr>
<td>
[[+lexrating.name]]
</td>
<td>
The name you specify in the snippet
</td>
</tr>

<tr>
<td>
[[+lexrating.group]]
</td>
<td>
The group name you specify in the snippet
</td>
</tr>

<tr>
<td>
[[+lexrating.total.voters]]
</td>
<td>
Total number of the voters
</td>
</tr>

<tr>
<td>
[[+lexrating.initialAjax]]
</td>
<td>
The property you set in the snippet call
</td>
</tr>
</tbody>
</table>

<h2 id="LexRating-Example">
Example
</h2>

<pre class="brush: php">
[[LexRatingList? &amp;group=`articles`]]
</pre>
<h1 id="LexRating-LexRatingQuipPostHook">
LexRatingQuipPostHook
</h1>

<p>
This hook requires quip's thread name.
<br />
This only works once for each IP Address + userID.
<br />
So any logged in user can not vote twice.
</p>

<p>
On the quip's call, try to use this as an example:
</p>

<pre class="brush: html">
&lt;p&gt;Total Rating:&lt;/p&gt;
[[!LexRatingList?
&amp;name=`threadNameHere`
&amp;group=`Overall Rating`
]]
&lt;br /&gt;
[[!Quip?
&amp;thread=`threadNameHere`
&amp;tplComment=`lexrating.quipComment`
]]
&lt;br /&gt;
[[!QuipReply?
&amp;thread=`threadNameHere`
&amp;postHooks=`LexRatingQuipPostHook`
&amp;tplAddComment=`lexrating.quipAddComment`
&amp;redirectTo=`[[*id]]`
]]
</pre>
<p>
You can sync the connection between the thread's name (eg:<strong>threadNameHere</strong>) with the <strong>LexRating</strong> inside the other chunk, <strong>lexrating.quipComment</strong>.
<br />
Basically, it only adds up the <strong>LexRating</strong> call but with the proper properties to make this works:
</p>

<pre class="brush: html">
[[!LexRating?
&amp;group=`Overall Rating`
&amp;name=`[[+thread]]`
&amp;extended=`{"quipReplyId":"[[+idprefix]][[+id]]"}`
&amp;readOnly=`1`
&amp;tpl=`lexrating.quip`
&amp;js=``
&amp;loadjQuery=`0`
&amp;initialAjax=`0`
&amp;_toArray=`1`
]]
</pre>
<div class="note">
&amp;group is for the title,
<br />
&amp;name must be as same as the quip's thread name
</div>

<p>
What <strong>&amp;extended</strong> does is only to identify each of the vote. You can change it anything, as long as it's the same with what the <strong>lexrating.quip</strong> needs for its placeholder.
</p>

<pre class="brush: php">
data-rateit-extended="[[+lexrating.extended]]"
</pre>
<p>
You must specify different names for the quip's thread names, remember to change/duplicate part of the chunks:
</p>

<p>
the duplicate of <strong>lexrating.quipAddComment</strong>
</p>

<pre class="brush: html">
        &lt;!-- replace lexrating_groupName's value with what you have as the &amp;group --&gt;
        &lt;input type="hidden" name="lexrating_groupName" value="Overall Rating" /&gt;

        &lt;!-- but leave this one untouched because the &amp;name is using the same placeholder [[+thread]] anyway --&gt;
        &lt;input type="hidden" name="lexrating_objectName" value="[[+thread]]" /&gt;
</pre>
<p>
the duplicate of <strong>lexrating.quipComment</strong>
</p>

<pre class="brush: php">
&amp;group=`Overall Rating` // &lt;== replace this
</pre>
<div class="warning">
You need to empty out the database when testing, because LexRating fills up the data automatically, while the access is limited to once per IP/user ID
</div>