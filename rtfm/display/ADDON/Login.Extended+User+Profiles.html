<div>
<ul>
<li>
<a href='#Login.ExtendedUserProfiles-Outline'>Outline</a>
</li>

<li>
<a href='#Login.ExtendedUserProfiles-VerifythatyouhavetheRequiredPages'>Verify that you have the Required Pages</a>
</li>

<li>
<a href='#Login.ExtendedUserProfiles-OrientYourself'>Orient Yourself</a>
</li>

<li>
<a href='#Login.ExtendedUserProfiles-UpdatePages'>Update Pages</a>
</li>

<li style="list-style: none; display: inline">
<ul>
<li>
<a href='#Login.ExtendedUserProfiles-RequestMembership%286%29'>Request Membership (6)</a>
</li>

<li>
<a href='#Login.ExtendedUserProfiles-UpdateProfile%2810%29'>Update Profile (10)</a>
</li>

<li>
<a href='#Login.ExtendedUserProfiles-ViewProfile%2811%29'>View Profile (11)</a>
</li>
</ul>
</li>

<li>
<a href='#Login.ExtendedUserProfiles-Testing%3AMakingitallWork'>Testing: Making it all Work</a>
</li>

<li style="list-style: none; display: inline">
<ul>
<li>
<a href='#Login.ExtendedUserProfiles-Login'>Login</a>
</li>

<li>
<a href='#Login.ExtendedUserProfiles-ViewProfile%2811%29'>View Profile (11)</a>
</li>

<li>
<a href='#Login.ExtendedUserProfiles-UpdateProfile%2810%29'>Update Profile (10)</a>
</li>
</ul>
</li>

<li>
<a href='#Login.ExtendedUserProfiles-Variations'>Variations</a>
</li>
</ul>
</div>

<h2>
<a name="Login.ExtendedUserProfiles-Outline"></a>Outline
</h2>

<p>
This tutorial builds the <a href="/display/ADDON/Login.User+Profiles" title="Login.User Profiles">Basic Setup</a> and <a href="/display/ADDON/Login.User+Profiles" title="Login.User Profiles">User Profiles</a> tutorials. Do not attempt this tutorial until you've gotten the other login flows setup and working on your site! In this tutorial, you will see how to add extended fields to your users' profiles.
</p>

<p>
So what going to do in this tutorial is to modify the Snippets that we've already put in place in the standard <a href="/display/ADDON/Login.User+Profiles" title="Login.User Profiles">User Profiles</a> tutorial.
</p>

<h2>
<a name="Login.ExtendedUserProfiles-VerifythatyouhavetheRequiredPages"></a>Verify that you have the Required Pages
</h2>

<p>
We're not creating any new pages here, but for reference, here are the pages we're dealing with (same as the previous tutorials):
</p>

<ul>
<li>
<b>Login Page (1)</b> : the page containing your login form
</li>

<li>
<b>Forgot Password (2)</b> : the page where users can go when they forgot their password
</li>

<li>
<b>Reset Password Handler (3)</b> : the hidden page that will actually do the resetting of the password
</li>

<li>
<b>Members Home Page (4)</b> : the secret clubhouse, available only to valid members
</li>

<li>
<b>Come Again Soon (5)</b> : the page displayed upon successful logout
</li>

<li>
<b>Request Membership (6)</b> : the page where users can request membership, i.e. the "Become a Member" page.
</li>

<li>
<b>Request Pending (7)</b> : notifies the user that the user's request has been received
</li>

<li>
<b>Membership Confirmation Handler (8)</b> : the hidden page that will actually register the user
</li>

<li>
<b>Home Page (9)</b> : we're just being thorough – you probably already some page designated as your home page.
</li>

<li>
<b>Update Profile (10)</b> – where the user can edit their profile
</li>

<li>
<b>View Profile (11)</b> – where the user can view their profile
</li>

<li>
<b>Change Password (12)</b> – where the user can change their password.
</li>
</ul>

<h2>
<a name="Login.ExtendedUserProfiles-OrientYourself"></a>Orient Yourself
</h2>

<p>
Just so you know what we're talking about here, we're talking about a user's <em>extended</em> fields. If you edit a user, e.g. the one you created while testing out your login process (<b>Security -&gt; Manage Users -&gt; Right-click your user</b>), head over to the Extended Fields tab and you can see any custom user fields.
</p>

<p>
<span class="image-wrap" style=""><img src="/download/attachments/39355781/user_extended_fields.jpg?version=1&amp;modificationDate=1339739076000" style="border: 0px solid black" /></span>
</p>

<p>
In the screenshot, you can see that our earlier shenanigans created a few extra fields! See this <a href="http://forums.modx.com/thread/72395/update-profile-created-bogus-extended-fields#dis-post-426733" class="external-link" rel="nofollow">forum post</a>.
</p>

<p>
The point is this: any field you add here will be available as a placeholder in your profile.
</p>

<h2>
<a name="Login.ExtendedUserProfiles-UpdatePages"></a>Update Pages
</h2>

<h3>
<a name="Login.ExtendedUserProfiles-RequestMembership%286%29"></a>Request Membership (6)
</h3>

<div class='panelMacro'>
<table class='infoMacro'>
<colgroup>
<col width='24' />
<col />
</colgroup>

<tr>
<td valign='top'>
<img src="/images/icons/emoticons/information.gif" width="16" height="16" align="absmiddle" alt="" border="0" />
</td>
<td>
You will probably want to add the extended fields to your membership sign-up form so they can be created from the get-go. If you only want users to be able to add extended fields after they've registered, then you can skip this.
</td>
</tr>
</table>
</div>

<p>
Your request membership form will look a lot like what we're going to build for the Update Profile form. We're merely adding the extra fields to the form that was already in place from the previous tutorial. Here we've added a field named "custom_field":
</p>

<div class="code panel" style="border-width: 1px;">
<div class="codeContent panelContent">
<pre class="code-java">
[[!Register?
    &amp;submitVar=`registerbtn`
    &amp;activationResourceId=`8`
    &amp;activationEmailTpl=`lgnActivateEmailTpl`
    &amp;activationEmailSubject=`Thanks <span class="code-keyword">for</span> Registering!`
    &amp;submittedResourceId=`7`
    &amp;usergroups=`Members`
    &amp;excludeExtended=`email:required:email,login-updprof-btn`
]]

&lt;div class=<span class="code-quote">"register"</span>&gt;
    &lt;div class=<span class="code-quote">"registerMessage"</span>&gt;[[+error.message]]&lt;/div&gt;
      
    &lt;form class=<span class="code-quote">"form"</span> action=<span class="code-quote">"[[~[[*id]]]]"</span> method=<span class="code-quote">"post"</span>&gt;
        &lt;input type=<span class="code-quote">"hidden"</span> name=<span class="code-quote">"nospam:blank"</span> value="" /&gt;
          
        &lt;label <span class="code-keyword">for</span>=<span class="code-quote">"username"</span>&gt;[[%register.username? &amp;namespace=`login` &amp;topic=`register`]]
            &lt;span class=<span class="code-quote">"error"</span>&gt;[[+error.username]]&lt;/span&gt;
        &lt;/label&gt;
        &lt;input type=<span class="code-quote">"text"</span> name=<span class="code-quote">"username:required:minLength=6"</span> id=<span class="code-quote">"username"</span> value=<span class="code-quote">"[[+username]]"</span> /&gt;
          
        &lt;label <span class="code-keyword">for</span>=<span class="code-quote">"password"</span>&gt;[[%register.password]]
            &lt;span class=<span class="code-quote">"error"</span>&gt;[[+error.password]]&lt;/span&gt;
        &lt;/label&gt;
        &lt;input type=<span class="code-quote">"password"</span> name=<span class="code-quote">"password:required:minLength=6"</span> id=<span class="code-quote">"password"</span> value=<span class="code-quote">"[[+password]]"</span> /&gt;
          
        &lt;label <span class="code-keyword">for</span>=<span class="code-quote">"password_confirm"</span>&gt;[[%register.password_confirm]]
            &lt;span class=<span class="code-quote">"error"</span>&gt;[[+error.password_confirm]]&lt;/span&gt;
        &lt;/label&gt;
        &lt;input type=<span class="code-quote">"password"</span> name=<span class="code-quote">"password_confirm:password_confirm=`password`"</span> id=<span class="code-quote">"password_confirm"</span> value=<span class="code-quote">"[[+password_confirm]]"</span> /&gt;
          
        &lt;label <span class="code-keyword">for</span>=<span class="code-quote">"fullname"</span>&gt;[[%register.fullname]]
            &lt;span class=<span class="code-quote">"error"</span>&gt;[[+error.fullname]]&lt;/span&gt;
        &lt;/label&gt;
        &lt;input type=<span class="code-quote">"text"</span> name=<span class="code-quote">"fullname:required"</span> id=<span class="code-quote">"fullname"</span> value=<span class="code-quote">"[[+fullname]]"</span> /&gt;
          
        &lt;label <span class="code-keyword">for</span>=<span class="code-quote">"email"</span>&gt;[[%register.email]]
            &lt;span class=<span class="code-quote">"error"</span>&gt;[[+error.email]]&lt;/span&gt;
        &lt;/label&gt;
        &lt;input type=<span class="code-quote">"text"</span> name=<span class="code-quote">"email:email"</span> id=<span class="code-quote">"email"</span> value=<span class="code-quote">"[[+email]]"</span> /&gt;

        &lt;label <span class="code-keyword">for</span>=<span class="code-quote">"custom_field"</span>&gt;Custom Field
            &lt;span class=<span class="code-quote">"error"</span>&gt;[[+error.custom_field]]&lt;/span&gt;
        &lt;/label&gt;
        &lt;input type=<span class="code-quote">"text"</span> name=<span class="code-quote">"custom_field"</span> id=<span class="code-quote">"custom_field"</span> value=<span class="code-quote">"[[+custom_field]]"</span> /&gt;

          
        &lt;br class=<span class="code-quote">"clear"</span> /&gt;
          
        &lt;div class=<span class="code-quote">"form-buttons"</span>&gt;
            &lt;input type=<span class="code-quote">"submit"</span> name=<span class="code-quote">"registerbtn"</span> value=<span class="code-quote">"Register"</span> /&gt;
        &lt;/div&gt;
    &lt;/form&gt;
&lt;/div&gt;
</pre>
</div>
</div>

<p>
Make sure you reference the correct Email Chunk in the <b>&amp;activationEmailTpl</b> parameter. In this example, we're using Login's default name, <b>lgnActivateEmailTpl</b>.
</p>

<h3>
<a name="Login.ExtendedUserProfiles-UpdateProfile%2810%29"></a>Update Profile (10)
</h3>

<p>
We're gonna edit this page to use some more of features of the <a href="/display/ADDON/Login.UpdateProfile" title="Login.UpdateProfile">UpdateProfile</a> Snippet. We're going to add a "custom_field". We're going to verbosely set the <b>&amp;useExtended</b> parameter. This ensures that any extra fields posted here end up getting tracked as extended fields.
</p>

<div class="code panel" style="border-width: 1px;">
<div class="codeContent panelContent">
<pre class="code-java">
[[!UpdateProfile? &amp;excludeExtended=`email:required:email,login-updprof-btn` &amp;useExtended=`1`]]

&lt;div class=<span class="code-quote">"update-profile"</span>&gt;
    &lt;div class=<span class="code-quote">"updprof-error"</span>&gt;[[+error.message]]&lt;/div&gt;
    [[+login.update_success:<span class="code-keyword">if</span>=`[[+login.update_success]]`:is=`1`:then=`[[%login.profile_updated? &amp;namespace=`login` &amp;topic=`updateprofile`]]`]]
 
    &lt;form class=<span class="code-quote">"form"</span> action=<span class="code-quote">"[[~[[*id]]]]"</span> method=<span class="code-quote">"post"</span>&gt;
        &lt;input type=<span class="code-quote">"hidden"</span> name=<span class="code-quote">"nospam:blank"</span> value="" /&gt;
 
        &lt;label <span class="code-keyword">for</span>=<span class="code-quote">"fullname"</span>&gt;[[!%login.fullname? &amp;namespace=`login` &amp;topic=`updateprofile`]]
            &lt;span class=<span class="code-quote">"error"</span>&gt;[[+error.fullname]]&lt;/span&gt;
        &lt;/label&gt;
        &lt;input type=<span class="code-quote">"text"</span> name=<span class="code-quote">"fullname"</span> id=<span class="code-quote">"fullname"</span> value=<span class="code-quote">"[[+fullname]]"</span> /&gt;
 
        &lt;label <span class="code-keyword">for</span>=<span class="code-quote">"email"</span>&gt;[[!%login.email]]
            &lt;span class=<span class="code-quote">"error"</span>&gt;[[+error.email]]&lt;/span&gt;
        &lt;/label&gt;
        &lt;input type=<span class="code-quote">"text"</span> name=<span class="code-quote">"email:required:email"</span> id=<span class="code-quote">"email"</span> value=<span class="code-quote">"[[+email]]"</span> /&gt;
 

        &lt;label <span class="code-keyword">for</span>=<span class="code-quote">"custom_field"</span>&gt;Custom Field
            &lt;span class=<span class="code-quote">"error"</span>&gt;[[+error.custom_field]]&lt;/span&gt;
        &lt;/label&gt;
        &lt;input type=<span class="code-quote">"text"</span> name=<span class="code-quote">"custom_field"</span> id=<span class="code-quote">"custom_field"</span> value=<span class="code-quote">"[[+custom_field]]"</span> /&gt;&lt;br/&gt;
 
                &lt;br class=<span class="code-quote">"clear"</span> /&gt;
 
        &lt;div class=<span class="code-quote">"form-buttons"</span>&gt;
            &lt;input type=<span class="code-quote">"submit"</span> name=<span class="code-quote">"login-updprof-btn"</span> value=<span class="code-quote">"[[!%login.update_profile]]"</span> /&gt;
        &lt;/div&gt;
    &lt;/form&gt;
&lt;/div&gt;

&lt;p&gt;&lt;a href=<span class="code-quote">"[[~12]]"</span>&gt;Change Password&lt;/a&gt;&lt;/p&gt;
</pre>
</div>
</div>

<p>
Why are we using the <b>&amp;excludeExtended</b> parameter? Well... there seems to be a bug in the Login Snippet where these fields with validation rules.
</p>

<h3>
<a name="Login.ExtendedUserProfiles-ViewProfile%2811%29"></a>View Profile (11)
</h3>

<p>
As before, we will be featuring the <a href="/display/ADDON/Login.Profile" title="Login.Profile">Profile</a> Snippet. We just need to add placeholders for the extra fields. In our example we added a <b>custom_field</b> field:
</p>

<div class="code panel" style="border-width: 1px;">
<div class="codeContent panelContent">
<pre class="code-java">
[[!Profile]]
 
&lt;p&gt;Username: [[+username]]&lt;/p&gt;
&lt;p&gt;Full Name: [[+fullname]]&lt;/p&gt;
&lt;p&gt;Email: [[+email]]&lt;/p&gt;
&lt;p&gt;Custom Field: [[+custom_field]]&lt;/p&gt;

&lt;p&gt;&lt;a href=<span class="code-quote">"[[~10]]"</span>&gt;Edit&lt;/a&gt;&lt;/p&gt;
</pre>
</div>
</div>

<h2>
<a name="Login.ExtendedUserProfiles-Testing%3AMakingitallWork"></a>Testing: Making it all Work
</h2>

<h3>
<a name="Login.ExtendedUserProfiles-Login"></a>Login
</h3>

<p>
Using a separate browser, you need to log into the front-end. This stuff should work from the previous tutorial.
</p>

<h3>
<a name="Login.ExtendedUserProfiles-ViewProfile%2811%29"></a>View Profile (11)
</h3>

<ol>
<li>
<b>CHECK:</b> This page should display your info, including the custom_field value (or values).
</li>
</ol>

<h3>
<a name="Login.ExtendedUserProfiles-UpdateProfile%2810%29"></a>Update Profile (10)
</h3>

<p>
Try changing your info.
</p>

<ol>
<li>
<b>CHECK:</b> Can you edit your info? Try changing the custom_field value(s) and saving.
</li>
</ol>

<h2>
<a name="Login.ExtendedUserProfiles-Variations"></a>Variations
</h2>

<p>
The FormIt Snippet has a useful helper Snippet: <a href="/display/ADDON/FormIt.FormItCountryOptions" title="FormIt.FormItCountryOptions">FormItCountryOptions</a>. If you want to track a user's country, it can be a great way to add a country dropdown.
</p>

<div class="code panel" style="border-width: 1px;">
<div class="codeContent panelContent">
<pre class="code-java">
&lt;select name=<span class="code-quote">"country"</span>&gt;
[[!FormItCountryOptions? &amp;selected=`[[!+country]]` &amp;prioritized=`US,GB,CA,AU` &amp;prioritizedGroupText=`Frequent Visitors` &amp;allGroupText=`Other Countries`]]
&lt;/select&gt;
</pre>
</div>
</div>

<p>
There is a similar Snippet for US State options: <a href="/display/ADDON/FormIt.FormItStateOptions" title="FormIt.FormItStateOptions">FormItStateOptions</a>
</p>