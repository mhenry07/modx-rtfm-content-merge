<div class="tip">
This feature is available since v.1.0.0-pl
</div>

<div>
<ul>
<li>
<a href="extras/revo/filedownload-r/filedownload-r.plugins#FileDownloadR.Plugins-Events">Events</a>
</li>

<li>
<a href="extras/revo/filedownload-r/filedownload-r.plugins#FileDownloadR.Plugins-Properties">Properties</a>
</li>

<li>
<a href="extras/revo/filedownload-r/filedownload-r.plugins#FileDownloadR.Plugins-APIs">APIs</a>
</li>
</ul>
</div>

<h2>
<a name="FileDownloadR.Plugins-Events" id="FileDownloadR.Plugins-Events"></a>Events
</h2>

<p>
There are still a few events that have been provided, because again, this is small script.
<br />
But the event spots are really useful:
</p>

<ul>
<li>
<b>OnLoad</b>
<br />
Just when the script is loaded, this event trigger also calls all the plugins that want to do their dependencies, for instance
</li>

<li>
<b>BeforeDirOpen</b>
<br />
Before the folder is scanned/opened
</li>

<li>
<b>AfterDirOpen</b>
<br />
After the folder is scanned/opened
</li>

<li>
<b>BeforeFileDownload</b>
<br />
Before the file is downloaded
</li>

<li>
<b>AfterFileDownload</b>
<br />
After the file is downloaded
</li>
</ul>

<p>
The complete reference actually is written directly in the <b>core/components/filedownload/plugins/filedownloadplugin.events.php</b> file, including their available properties and the expected results.
</p>

<pre class="brush: php">
    
[[!FileDownload?
&amp;getDir=`assets/files`
&amp;plugins=`[
    {
        "name":"[[++core_path]]components/filedownload/plugins/formit.formsave.plugin.php"
        ,"event":"OnLoad"
        ,"strict":true
    },{
        "name":"[[++core_path]]components/filedownload/plugins/formit.formsave.plugin.php"
        ,"event":"AfterFileDownload"
    },{
        "name":"FileDownloadEmailPlugin"
        ,"event":"AfterFileDownload"
    }
]`
&amp;emailProps=`{
    "emailTpl":"FileDownloadEmailChunk",
    "emailSubject":"New Downloader",
    "emailTo":"your@email.com",
    "emailCC":"your@other.email.com",
    "emailBCC":"your@secret.email.com",
    "emailBCCName":"secret"
}`
]]

    
</pre>
<p>
In this example, I'm using 2 default plugins for examples, <b><a href="display/ADDON/FormSave" title="FormSave">FormSave</a></b> (as file based) and <b>Email</b> (as a snippet), which are both depend on <a href="display/ADDON/FormIt" title="FormIt">FormIt</a>.
<br />
These plugins will do:
</p>

<ul>
<li>OnLoad
<br />
Checks whether FormSave and Formit are available. If not, halt.
</li>

<li>AfterFileDownload
<br />
After the file is downloaded, store the information into FormSave, and then send email to the given addresses, with the chunk as provided
</li>
</ul>

<p>
The email's properties are using the <a href="display/ADDON/FormIt" title="FormIt">FormIt</a>'s properties, because it IS the <a href="display/ADDON/FormIt" title="FormIt">FormIt</a>'s hook.
</p>

<p>
The structure of the JSON is:
</p>

<ul>
<li>
<b>name</b>
<br />
The snippet's name or file path to the plugin file
</li>

<li>
<b>event</b>
<br />
Name of the event you want this to be applied
</li>

<li>
<b>strict</b> <em>(optional)</em>
<br />
Boolean (TRUE|FALSE), sets this particular plugin in a strict mode, which means if the return is <ins><b>FALSE</b></ins> the script should stop to process. This stopping process is only available on several particular events, so please refer to the Event triggers above.
</li>
</ul>

<p>
Multiple plugins and events must be called repeatedly, because they have different strictness statuses.
</p>

<h2>
<a name="FileDownloadR.Plugins-APIs" id="FileDownloadR.Plugins-APIs"></a>APIs
</h2>

<p>
These are the APIs that can be used inside your plugin script:
</p>

<div class='table-wrap'>
<table class='confluenceTable'>
<tbody>
<tr>
<th class='confluenceTh'>
Instance
</th>
<th class='confluenceTh'>
Method
</th>
<th class='confluenceTh'>
Description
</th>
</tr>

<tr>
<td class='confluenceTd'>
$modx
</td>
<td class='confluenceTd'>
all modx's methods
</td>
<td class='confluenceTd'>
default MODX instance
</td>
</tr>

<tr>
<td class='confluenceTd'>
$fileDownload
</td>
<td class='confluenceTd'>
getConfig($key), getConfigs()
</td>
<td class='confluenceTd'>
gets the scriptProperties, eg the <b>&amp;emailProps</b> above
</td>
</tr>

<tr>
<td class='confluenceTd'>
$plugin
</td>
<td class='confluenceTd'>
getProperties()
</td>
<td class='confluenceTd'>
gets the custom properties of the plugin
</td>
</tr>

<tr>
<td class='confluenceTd'>
&nbsp;
</td>
<td class='confluenceTd'>
getAllEvents()
</td>
<td class='confluenceTd'>
gets all event triggers
</td>
</tr>

<tr>
<td class='confluenceTd'>
&nbsp;
</td>
<td class='confluenceTd'>
getAppliedEvents()
</td>
<td class='confluenceTd'>
gets the applied events for the particular plugin in the run-time process
</td>
</tr>
</tbody>
</table>
</div>

<p>
Now, you can use your imagination to add more features for this snippet.
</p>