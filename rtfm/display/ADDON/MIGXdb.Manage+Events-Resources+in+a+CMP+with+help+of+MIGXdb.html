<div>
<ul>
<li>
<a href="extras/revo/migxdb/migxdb.tutorials/migxdb.manage-events-resources-in-a-cmp-with-help-of-migxdb#MIGXdb.ManageEvents-ResourcesinaCMPwithhelpofMIGXdb-ManageEventsResourcesinaCMPwithhelpofMIGXdb">Manage Events-Resources in a CMP with help of MIGXdb</a>
</li>

<li>
<a href="extras/revo/migxdb/migxdb.tutorials/migxdb.manage-events-resources-in-a-cmp-with-help-of-migxdb#MIGXdb.ManageEvents-ResourcesinaCMPwithhelpofMIGXdb-Requirements">Requirements</a>
</li>

<li>
<a href="extras/revo/migxdb/migxdb.tutorials/migxdb.manage-events-resources-in-a-cmp-with-help-of-migxdb#MIGXdb.ManageEvents-ResourcesinaCMPwithhelpofMIGXdb-CreatetheConfiguration">Create the Configuration</a>
</li>

<li>
<a href="extras/revo/migxdb/migxdb.tutorials/migxdb.manage-events-resources-in-a-cmp-with-help-of-migxdb#MIGXdb.ManageEvents-ResourcesinaCMPwithhelpofMIGXdb-Createaparentresourceforourevents.">Create a parent-resource for our events.</a>
</li>

<li>
<a href="extras/revo/migxdb/migxdb.tutorials/migxdb.manage-events-resources-in-a-cmp-with-help-of-migxdb#MIGXdb.ManageEvents-ResourcesinaCMPwithhelpofMIGXdb-CreatesomeeventTVs">Create some event-TVs</a>
</li>

<li>
<a href="extras/revo/migxdb/migxdb.tutorials/migxdb.manage-events-resources-in-a-cmp-with-help-of-migxdb#MIGXdb.ManageEvents-ResourcesinaCMPwithhelpofMIGXdb-CreateaTemplateforourevents.">Create a Template for our events.</a>
</li>

<li>
<a href="extras/revo/migxdb/migxdb.tutorials/migxdb.manage-events-resources-in-a-cmp-with-help-of-migxdb#MIGXdb.ManageEvents-ResourcesinaCMPwithhelpofMIGXdb-SettheTemplateforourevents.">Set the Template for our events.</a>
</li>

<li>
<a href="extras/revo/migxdb/migxdb.tutorials/migxdb.manage-events-resources-in-a-cmp-with-help-of-migxdb#MIGXdb.ManageEvents-ResourcesinaCMPwithhelpofMIGXdb-RegistertheTVsforourprocessors%28getlist%2Cfields%29">Register the TVs for our processors (getlist,fields)</a>
</li>

<li>
<a href="extras/revo/migxdb/migxdb.tutorials/migxdb.manage-events-resources-in-a-cmp-with-help-of-migxdb#MIGXdb.ManageEvents-ResourcesinaCMPwithhelpofMIGXdb-dropdownTVforoureventsfilter">dropdown-TV for our events-filter</a>
</li>

<li>
<a href="extras/revo/migxdb/migxdb.tutorials/migxdb.manage-events-resources-in-a-cmp-with-help-of-migxdb#MIGXdb.ManageEvents-ResourcesinaCMPwithhelpofMIGXdb-snippetforoureventsfilter">snippet for our events-filter</a>
</li>

<li>
<a href="extras/revo/migxdb/migxdb.tutorials/migxdb.manage-events-resources-in-a-cmp-with-help-of-migxdb#MIGXdb.ManageEvents-ResourcesinaCMPwithhelpofMIGXdb-Filters">Filters</a>
</li>

<li style="list-style: none; display: inline">
<ul>
<li>
<a href="extras/revo/migxdb/migxdb.tutorials/migxdb.manage-events-resources-in-a-cmp-with-help-of-migxdb#MIGXdb.ManageEvents-ResourcesinaCMPwithhelpofMIGXdb-DropdownFilterforfilteringcurrent%2Cupcoming%2Cexpiredevents">Dropdown Filter for filtering current,upcoming,expired events</a>
</li>

<li>
<a href="extras/revo/migxdb/migxdb.tutorials/migxdb.manage-events-resources-in-a-cmp-with-help-of-migxdb#MIGXdb.ManageEvents-ResourcesinaCMPwithhelpofMIGXdb-TextboxFilterforsearchinginsomefields">Textbox Filter for searching in some fields</a>
</li>
</ul>
</li>

<li>
<a href="extras/revo/migxdb/migxdb.tutorials/migxdb.manage-events-resources-in-a-cmp-with-help-of-migxdb#MIGXdb.ManageEvents-ResourcesinaCMPwithhelpofMIGXdb-Hidingchildsfromtree">Hiding childs from tree</a>
</li>

<li>
<a href="extras/revo/migxdb/migxdb.tutorials/migxdb.manage-events-resources-in-a-cmp-with-help-of-migxdb#MIGXdb.ManageEvents-ResourcesinaCMPwithhelpofMIGXdb-CreateamenutoyourCMP">Create a menu to your CMP</a>
</li>
</ul>
</div>

<h2>
<a name="MIGXdb.ManageEvents-ResourcesinaCMPwithhelpofMIGXdb-ManageEventsResourcesinaCMPwithhelpofMIGXdb" id="MIGXdb.ManageEvents-ResourcesinaCMPwithhelpofMIGXdb-ManageEventsResourcesinaCMPwithhelpofMIGXdb"></a>Manage Events-Resources in a CMP with help of MIGXdb
</h2>

<p>
Often we have the problem with lots of Resources, in the Resource-Tree to be very confused at some point and we wish, we would have a better way to manage them in a paginated grid view.
</p>

<p>
In this Tuorial we will learn how to create a CMP (custom manager page),
<br />
where you can manage events, which are child-resources of a resource-folder.
</p>

<h2>
<a name="MIGXdb.ManageEvents-ResourcesinaCMPwithhelpofMIGXdb-Requirements" id="MIGXdb.ManageEvents-ResourcesinaCMPwithhelpofMIGXdb-Requirements"></a>Requirements
</h2>

<p>
First off we will need to install <a href="/extras/revo/migx" title="MIGX">MIGX</a> by package-management, if not allready done, and do some <a href="/extras/revo/migxdb/migxdb.configuration" title="MIGXdb.Configuration">basic configurations</a>.
<br />
Minimum Required version: MIGX 2.3.2 (10.09.2012)
</p>

<h2>
<a name="MIGXdb.ManageEvents-ResourcesinaCMPwithhelpofMIGXdb-CreatetheConfiguration" id="MIGXdb.ManageEvents-ResourcesinaCMPwithhelpofMIGXdb-CreatetheConfiguration"></a>Create the Configuration
</h2>

<p>
Now we want to create our configuration for the MIGXdb-TV.
</p>

<p>
Go to the main-tab 'MIGX'
</p>

<p>
There should be an grid with some buttons.
</p>

<p>
We click 'Add item'
</p>

<p>
In the opening window we add:
</p>

<p>
Name: events - this is the name of our configuration. Make sure to use unique configuration-names.
<br />
"Add Item" Replacement: Add Event - this is the text on our 'Add Item' - Button
<br />
unique MIGX ID: events - Its a good idea to have a unique MIGX - id for all your MIGX-configs.
</p>

<p>
Click 'Done'
</p>

<p>
We should see a new created record in our grid.
<br />
We could edit this record and add grid-columns and tabs and other stuff by right-clicking and choose 'edit', but we want to go the faster way by just importing our example-configuration.
</p>

<p>
Right-Click our record and choose 'Export/Import'
</p>

<p>
Add this code into the one field 'Json' :
</p>

<pre class="brush: php">
{"formtabs":"[{\"MIGX_id\":\"1\",\"caption\":\"Event\",\"fields\":\"[{\\\"MIGX_id\\\":\\\"1\\\",\\\"field\\\":\\\"pagetitle\\\",\\\"caption\\\":\\\"Pagetitle\\\",\\\"inputTV\\\":\\\"\\\",\\\"inputTVtype\\\":\\\"\\\",\\\"configs\\\":\\\"\\\",\\\"sourceFrom\\\":\\\"config\\\",\\\"sources\\\":\\\"\\\",\\\"inputOptionValues\\\":\\\"\\\",\\\"default\\\":\\\"\\\"},{\\\"MIGX_id\\\":\\\"7\\\",\\\"field\\\":\\\"location\\\",\\\"caption\\\":\\\"Location\\\",\\\"inputTV\\\":\\\"\\\",\\\"inputTVtype\\\":\\\"\\\",\\\"configs\\\":\\\"\\\",\\\"sourceFrom\\\":\\\"config\\\",\\\"sources\\\":\\\"\\\",\\\"inputOptionValues\\\":\\\"\\\",\\\"default\\\":\\\"\\\"},{\\\"MIGX_id\\\":\\\"3\\\",\\\"field\\\":\\\"eventstart\\\",\\\"caption\\\":\\\"Start\\\",\\\"inputTV\\\":\\\"\\\",\\\"inputTVtype\\\":\\\"date\\\",\\\"configs\\\":\\\"\\\",\\\"sourceFrom\\\":\\\"config\\\",\\\"sources\\\":\\\"\\\",\\\"inputOptionValues\\\":\\\"\\\",\\\"default\\\":\\\"\\\"},{\\\"MIGX_id\\\":\\\"4\\\",\\\"field\\\":\\\"eventend\\\",\\\"caption\\\":\\\"End\\\",\\\"inputTV\\\":\\\"\\\",\\\"inputTVtype\\\":\\\"date\\\",\\\"configs\\\":\\\"\\\",\\\"sourceFrom\\\":\\\"config\\\",\\\"sources\\\":\\\"\\\",\\\"inputOptionValues\\\":\\\"\\\",\\\"default\\\":\\\"\\\"},{\\\"MIGX_id\\\":\\\"5\\\",\\\"field\\\":\\\"template\\\",\\\"caption\\\":\\\"\\\",\\\"inputTV\\\":\\\"\\\",\\\"inputTVtype\\\":\\\"hidden\\\",\\\"configs\\\":\\\"\\\",\\\"sourceFrom\\\":\\\"config\\\",\\\"sources\\\":\\\"\\\",\\\"inputOptionValues\\\":\\\"\\\",\\\"default\\\":\\\"6\\\"},{\\\"MIGX_id\\\":\\\"2\\\",\\\"field\\\":\\\"parent\\\",\\\"caption\\\":\\\"\\\",\\\"inputTV\\\":\\\"\\\",\\\"inputTVtype\\\":\\\"hidden\\\",\\\"configs\\\":\\\"\\\",\\\"sourceFrom\\\":\\\"config\\\",\\\"sources\\\":\\\"\\\",\\\"inputOptionValues\\\":\\\"\\\",\\\"default\\\":\\\"25\\\"},{\\\"MIGX_id\\\":\\\"6\\\",\\\"field\\\":\\\"context_key\\\",\\\"caption\\\":\\\"\\\",\\\"inputTV\\\":\\\"\\\",\\\"inputTVtype\\\":\\\"hidden\\\",\\\"configs\\\":\\\"\\\",\\\"sourceFrom\\\":\\\"config\\\",\\\"sources\\\":\\\"\\\",\\\"inputOptionValues\\\":\\\"\\\",\\\"default\\\":\\\"web\\\"}]\"},{\"MIGX_id\":\"2\",\"caption\":\"Content\",\"fields\":\"[{\\\"MIGX_id\\\":\\\"1\\\",\\\"field\\\":\\\"content\\\",\\\"caption\\\":\\\"Content\\\",\\\"inputTV\\\":\\\"\\\",\\\"inputTVtype\\\":\\\"richtext\\\",\\\"configs\\\":\\\"\\\",\\\"sourceFrom\\\":\\\"config\\\",\\\"sources\\\":\\\"\\\",\\\"inputOptionValues\\\":\\\"\\\",\\\"default\\\":\\\"\\\"}]\"}]","contextmenus":"","actionbuttons":"addItem||toggletrash","columnbuttons":"update||publish||unpublish||recall_remove_delete","filters":"[{\"MIGX_id\":\"1\",\"name\":\"eventsfilter\",\"label\":\"eventsfilter\",\"emptytext\":\"-- Filter Events --\",\"type\":\"combobox\",\"getlistwhere\":\"[[migxFilterevents]]\",\"getcomboprocessor\":\"getTVcombo\",\"combotextfield\":\"eventsfiltercombo\",\"comboidfield\":\"\",\"comboparent\":\"\"}]","extended":{"migx_add":"Create Event","formcaption":"Event","win_id":"events","multiple_formtabs":"","packageName":"migxresourceevents","classname":"modResource","task":"childresources","getlistsort":"","getlistsortdir":"","use_custom_prefix":"0","prefix":"","grid":"","gridload_mode":"1","check_resid":"1","check_resid_TV":"","join_alias":"","getlistwhere":"{\"parent\":\"25\"}","joins":"","cmpmaincaption":"Events","cmptabcaption":"Events","cmptabdescription":"Manage your events here","cmptabcontroller":""},"columns":"[{\"MIGX_id\":\"1\",\"header\":\"ID\",\"dataIndex\":\"id\",\"width\":\"10\",\"renderer\":\"\",\"sortable\":\"true\",\"show_in_grid\":\"1\"},{\"MIGX_id\":\"2\",\"header\":\"Pagetitle\",\"dataIndex\":\"pagetitle\",\"width\":\"30\",\"renderer\":\"this.renderRowActions\",\"sortable\":\"true\",\"show_in_grid\":\"1\"},{\"MIGX_id\":\"7\",\"header\":\"Location\",\"dataIndex\":\"location\",\"width\":\"20\",\"renderer\":\"\",\"sortable\":\"false\",\"show_in_grid\":\"1\"},{\"MIGX_id\":\"5\",\"header\":\"Start\",\"dataIndex\":\"eventstart\",\"width\":\"20\",\"renderer\":\"this.renderDate\",\"sortable\":\"true\",\"show_in_grid\":\"1\"},{\"MIGX_id\":\"6\",\"header\":\"End\",\"dataIndex\":\"eventend\",\"width\":\"20\",\"renderer\":\"this.renderDate\",\"sortable\":\"true\",\"show_in_grid\":\"1\"},{\"MIGX_id\":\"4\",\"header\":\"Published\",\"dataIndex\":\"published\",\"width\":\"10\",\"renderer\":\"this.renderCrossTick\",\"sortable\":\"false\",\"show_in_grid\":\"1\"},{\"MIGX_id\":\"3\",\"header\":\"\",\"dataIndex\":\"deleted\",\"width\":\"\",\"renderer\":\"\",\"sortable\":\"false\",\"show_in_grid\":\"0\"}]"}
</pre>
<p>
click 'done'
</p>

<p>
you can check what it has done by right-clicking the record and choose 'edit' and go thrue the tabs and its nested grids.
</p>

<h2>
<a name="MIGXdb.ManageEvents-ResourcesinaCMPwithhelpofMIGXdb-Createaparentresourceforourevents." id="MIGXdb.ManageEvents-ResourcesinaCMPwithhelpofMIGXdb-Createaparentresourceforourevents."></a>Create a parent-resource for our events.
</h2>

<p>
Just create a new Resource, which will be the parent for all our event-resources.
</p>

<p>
Don't forget to set the resource-id into the getlist-where in the MIGX-manager
<br />
tab: MIGXdb-settings
<br />
field where:
</p>

<pre class="brush: php">
{"parent":"XX"}
</pre>
<h2>
<a name="MIGXdb.ManageEvents-ResourcesinaCMPwithhelpofMIGXdb-CreatesomeeventTVs" id="MIGXdb.ManageEvents-ResourcesinaCMPwithhelpofMIGXdb-CreatesomeeventTVs"></a>Create some event-TVs
</h2>

<p>
Create two date-TVs with names: 'eventstart' and 'eventend'
<br />
Create a text-TV with name: 'location'
</p>

<h2>
<a name="MIGXdb.ManageEvents-ResourcesinaCMPwithhelpofMIGXdb-CreateaTemplateforourevents." id="MIGXdb.ManageEvents-ResourcesinaCMPwithhelpofMIGXdb-CreateaTemplateforourevents."></a>Create a Template for our events.
</h2>

<p>
Create a template with some basic content and place at least this placeholders somewhere in this template:
</p>

<pre class="brush: php">
[[*eventstart]],[[*eventend]],[[*location]],[[*pagetitle]],[[*content]]
</pre>
<p>
don't forget to assign all this TVs to this template.
</p>

<h2>
<a name="MIGXdb.ManageEvents-ResourcesinaCMPwithhelpofMIGXdb-SettheTemplateforourevents." id="MIGXdb.ManageEvents-ResourcesinaCMPwithhelpofMIGXdb-SettheTemplateforourevents."></a>Set the Template for our events.
</h2>

<p>
We want all our events have the template created above. So we need to set the template-value somehow.
<br />
This can be done by a hidden-field in our form.
<br />
To do so:
<br />
1. right-click our events - record in the MIGX-configurator-grid and click 'Edit'
<br />
2. open the tab 'formtabs'
<br />
3. right-click on 'Event' and click 'Edit'
<br />
4. right-click on 'template' and click 'Edit'
<br />
5. open the tab 'Input Options' and change the Default-Value to the template-ID, which our events-resources should have.
<br />
6. click done to save the values
</p>

<p>
Do the same for parent (add the ID of the parent-resource created above into as default-value) and context_key, if you need another one, than 'web'
</p>

<p>
Close all windows with 'Done'
</p>

<h2>
<a name="MIGXdb.ManageEvents-ResourcesinaCMPwithhelpofMIGXdb-RegistertheTVsforourprocessors%28getlist%2Cfields%29"></a>Register the TVs for our processors (getlist,fields)
</h2>

<p>
We need to register TVs to include them in the getlist- and fields-processors.
<br />
Todo so we need a new config-file under /core/components/migx/configs/
</p>

<p>
with the same name as our MIGX-configuration: events.config.inc.php (should allready be installed with the MIGX-package)
<br />
and this content:
</p>
<strong>/core/components/migx/configs/events.config.inc.php</strong>

<pre class="brush: php">
&lt;?php
$this-&gt;customconfigs['includeTVs'] = 1;
$this-&gt;customconfigs['includeTVList'] = 'eventstart,eventend,location';
</pre>
<p>
All TVs you want to edit or you want to show in the grid needs to be in the includeTVList - customconfig
</p>

<h2>
<a name="MIGXdb.ManageEvents-ResourcesinaCMPwithhelpofMIGXdb-dropdownTVforoureventsfilter" id="MIGXdb.ManageEvents-ResourcesinaCMPwithhelpofMIGXdb-dropdownTVforoureventsfilter"></a>dropdown-TV for our events-filter
</h2>

<p>
Create a new TV:
</p>

<p>
Name: eventsfiltercombo
<br />
Type: listbox
<br />
Input-option-values:
<br />
current||upcoming||expired
</p>

<h2>
<a name="MIGXdb.ManageEvents-ResourcesinaCMPwithhelpofMIGXdb-snippetforoureventsfilter" id="MIGXdb.ManageEvents-ResourcesinaCMPwithhelpofMIGXdb-snippetforoureventsfilter"></a>snippet for our events-filter
</h2>

<p>
Create a snippet:
</p>

<p>
Name: migxFilterevents
<br />
content:
</p>

<pre class="brush: php">
$now = strftime('%Y-%m-%d %H:%M:%S');
switch ($_REQUEST['eventsfilter']){
    case 'current':
        return 'tvFilter::eventstart&lt;='.$now.',eventend&gt;='.$now;
    break;    
    case 'upcoming':
        return 'tvFilter::eventstart&gt;&gt;'.$now;
    break;
    case 'expired':
        return 'tvFilter::eventend&lt;&lt;'.$now;
    break;
}
return '';
</pre>
<h2>
<a name="MIGXdb.ManageEvents-ResourcesinaCMPwithhelpofMIGXdb-Filters" id="MIGXdb.ManageEvents-ResourcesinaCMPwithhelpofMIGXdb-Filters"></a>Filters
</h2>

<p>
Go to MIGX-Management and open our configuration (events)
<br />
Open the TAB 'DB-Filters'
</p>

<h3>
<a name="MIGXdb.ManageEvents-ResourcesinaCMPwithhelpofMIGXdb-DropdownFilterforfilteringcurrent%2Cupcoming%2Cexpiredevents"></a>Dropdown Filter for filtering current,upcoming,expired events
</h3>

<p>
with the configuration above we have allready created this filter
</p>

<p>
filter Name: eventsfilter
<br />
label: eventsfilter
<br />
empty text: - filter events -
<br />
filter type: combobox
<br />
getlist-where:
</p>

<pre class="brush: php">
[[migxFilterevents]]
</pre>
<p>
getcombo processor: getTVcombo
<br />
getcombo textfield: eventsfiltercombo (this is used in our getTVcombo-processor to get the input-options of the TV 'eventsfiltercombo' for our filter-dropdown)
</p>

<h3>
<a name="MIGXdb.ManageEvents-ResourcesinaCMPwithhelpofMIGXdb-TextboxFilterforsearchinginsomefields" id="MIGXdb.ManageEvents-ResourcesinaCMPwithhelpofMIGXdb-TextboxFilterforsearchinginsomefields"></a>Textbox Filter for searching in some fields
</h3>

<p>
you can add additional filters, for example this one:
</p>

<p>
filter Name: search
<br />
label: search
<br />
empty text: search...
<br />
getlist-where:
</p>

<pre class="brush: php">
{"pagetitle:LIKE":"%[[+search]]%","OR:longtitle:LIKE":"%[[+search]]%","OR:content:LIKE":"%[[+search]]%"}
</pre>
<p>
Save them all with clicking 'Done' on all windows
</p>

<p>
Now you should be able to filter the child-resources by searching and/or choosing current,upcoming,expired from dropdown
</p>

<h2>
<a name="MIGXdb.ManageEvents-ResourcesinaCMPwithhelpofMIGXdb-Hidingchildsfromtree" id="MIGXdb.ManageEvents-ResourcesinaCMPwithhelpofMIGXdb-Hidingchildsfromtree"></a>Hiding childs from tree
</h2>

<p>
Hiding our child-resources from resource-tree is very easy.
</p>

<p>
go to the MIGX-Configurator and add a new field to one of the formtabs:
</p>

<p>
Fieldname: show_in_tree
<br />
Caption: Show in Tree
<br />
inputTVtype: listbox
</p>

<p>
inputOptionValues: no==0||yes==1
</p>

<p>
You can also show the status of this field in the grid by adding a new column:
</p>

<p>
Header: Show in Tree
<br />
Field: show_in_tree
<br />
width: 20
<br />
Renderer: this.RenderCrossTick
</p>

<h2>
<a name="MIGXdb.ManageEvents-ResourcesinaCMPwithhelpofMIGXdb-CreateamenutoyourCMP" id="MIGXdb.ManageEvents-ResourcesinaCMPwithhelpofMIGXdb-CreateamenutoyourCMP"></a>Create a menu to your CMP
</h2>

<p>
System -&gt; Actions
</p>

<p>
menu-tree:
<br />
Components-&gt;MIGX-&gt;right-click-&gt;Place Action here
</p>

<p>
Lexicon-key: Events Manager
<br />
Action: migx-index
<br />
parameters &amp;configs=events
</p>

<p>
click 'save'
</p>

<p>
Now we have created a very basic event-resources-management, which should allready work for basic requirements.
<br />
This can easy be extended to your needs.
</p>