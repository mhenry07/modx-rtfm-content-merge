<p>
<br class="atl-forced-newline" />
</p>

<div>
<ul>
<li>
<a href='#ImportX-WhatisImportX%3F'>What is ImportX?</a>
</li>

<li>
<a href='#ImportX-Requirements'>Requirements</a>
</li>

<li>
<a href='#ImportX-History'>History</a>
</li>

<li style="list-style: none; display: inline">
<ul>
<li>
<a href='#ImportX-PublicReleases'>Public Releases</a>
</li>
</ul>
</li>

<li>
<a href='#ImportX-Usage'>Usage</a>
</li>

<li style="list-style: none; display: inline">
<ul>
<li>
<a href='#ImportX-CSVInputtab'>CSV Input tab</a>
</li>

<li>
<a href='#ImportX-DefaultSettings'>Default Settings</a>
</li>

<li>
<a href='#ImportX-Doingthemagic%28andtroubleshootingerrors%29'>Doing the magic (and troubleshooting errors)</a>
</li>

<li>
<a href='#ImportX-ExampleCSVandsomeCSVrelatednotes'>Example CSV and some CSV-related notes</a>
</li>

<li>
<a href='#ImportX-ExecutionTimeIssues'>Execution Time Issues</a>
</li>

<li>
<a href='#ImportX-UpdatingDatainsteadofcreatingnewResources'>Updating Data instead of creating new Resources</a>
</li>
</ul>
</li>

<li>
<a href='#ImportX-OtherformatsthanCSV'>Other formats than CSV</a>
</li>

<li>
<a href='#ImportX-Andnow...'>And now...</a>
</li>
</ul>
</div>

<h2>
<a name="ImportX-WhatisImportX%3F"></a>What is ImportX?
</h2>

<p>
ImportX is a MODX extra that can be used to quickly create new resources from CSV input. This can be either pasted in a textarea, or by uploading a .txt or .csv file.
</p>

<p>
Development was funded by Working Party, a Sydney based Digital Agency.
</p>

<h2>
<a name="ImportX-Requirements"></a>Requirements
</h2>

<ul>
<li>MODX 2.0.x or 2.1.x (developed on 2.0.8 and 2.1-rc3, quick tests on 2.2 gave no issues)
</li>
</ul>

<h2>
<a name="ImportX-History"></a>History
</h2>

<p>
Initial development started in April 2011 by Mark Hamstra.&nbsp;
</p>

<h3>
<a name="ImportX-PublicReleases"></a>Public Releases
</h3>

<div class='table-wrap'>
<table class='confluenceTable'>
<tbody>
<tr>
<th class='confluenceTh'>
Version
</th>
<th class='confluenceTh'>
Date
</th>
<th class='confluenceTh'>
Author
</th>
<th class='confluenceTh'>
Highlights
<br class="atl-forced-newline" />
</th>
</tr>

<tr>
<td class='confluenceTd'>
1.0.0-rc
<br class="atl-forced-newline" />
</td>
<td class='confluenceTd'>
2/5/2011
<br class="atl-forced-newline" />
</td>
<td class='confluenceTd'>
Mark Hamstra
<br class="atl-forced-newline" />
</td>
<td class='confluenceTd'>
CSV File Upload, upload to context root other then 'web'
<br class="atl-forced-newline" />
</td>
</tr>

<tr>
<td class='confluenceTd'>
0.9.0-alpha
<br class="atl-forced-newline" />
</td>
<td class='confluenceTd'>
25/4/2011
<br class="atl-forced-newline" />
</td>
<td class='confluenceTd'>
Mark Hamstra
<br class="atl-forced-newline" />
</td>
<td class='confluenceTd'>
Console working in 2.0.8+, translateable
<br class="atl-forced-newline" />
</td>
</tr>

<tr>
<td class='confluenceTd'>
0.2.0-alpha
<br class="atl-forced-newline" />
</td>
<td class='confluenceTd'>
23/4/2011
<br class="atl-forced-newline" />
</td>
<td class='confluenceTd'>
Mark Hamstra
<br class="atl-forced-newline" />
</td>
<td class='confluenceTd'>
&nbsp;
</td>
</tr>

<tr>
<td class='confluenceTd'>
0.1.0-alpha1
<br class="atl-forced-newline" />
</td>
<td class='confluenceTd'>
7/4/2011
<br class="atl-forced-newline" />
</td>
<td class='confluenceTd'>
Mark Hamstra
<br class="atl-forced-newline" />
</td>
<td class='confluenceTd'>
&nbsp;
</td>
</tr>
</tbody>
</table>
</div>

<h2>
<a name="ImportX-Usage"></a>Usage
</h2>

<p>
<span class="image-wrap" style="float: right"><a class="confluence-thumbnail-link 557x316" href='http://oldrtfm.modx.com/download/attachments/35094766/menu.png'><img src="/download/thumbnails/35094766/menu.png" style="border: 1px solid black" /></a></span>
<br />
Using ImportX is as simple as presenting it with your CSV values and setting a few options depending on your situation.
</p>

<p>
After installation through the Package Manager, refresh the page and find ImportX in the Components menu (see image to the right). Open it and have a look at what options are available. Most of it is pretty self explanatory.
</p>

<h3>
<a name="ImportX-CSVInputtab"></a>CSV Input tab
</h3>

<p>
<span class="image-wrap" style=""><img src="/download/attachments/35094766/import.png?version=1&amp;modificationDate=1305658581000" style="border: 1px solid black" /></span>
</p>

<p>
The image to the left shows the screen available to you (ImportX 1.0-rc). Most notably, you can find a big textarea where you can enter raw CSV or choose to upload a csv file in the input field below that.
</p>

<p>
You will also see a field for the "Separator", which is the string between two columns of the CSV. This could be anything including multiple characters long, but is a semi-colon by default ";".
</p>

<p>
The last thing you should know about this tab and the component in general is where to find the submit button.. if you haven't noticed yet, it's in the top right of the workspace.&nbsp;
</p>

<p>
ImportX doesn't really care about what format your CSV is, as long as:
</p>

<ul>
<li>It knows what separator to use. By default it uses ";" (semi-colon) but you can change it on the CSV Input tab.
</li>

<li>The first row contains the "heading", in other words tells you where the columns should be filed under. This can contain resource fields (example: pagetitle;alias;richtext) but also Template Variables. Template Variables need to be listed as "tvN" where N is the ID of the template variable it needs to be filled in. An example header row could be pagetitle;alias;richtext;tv3;content;tv4.
</li>

<li>There needs to be at least one value row.
</li>

<li>Every row has the same number of elements. An element or cell is the value of a certain record that needs to be added as the value of a certain field.
</li>

<li>The header row needs to have the same amount of elements as the value rows.&nbsp;
</li>
</ul>

<h3>
<a name="ImportX-DefaultSettings"></a>Default Settings
</h3>

<p>
The Default Settings tab contains a couple of settings you can set by default. <span class="image-wrap" style="float: right"><a class="confluence-thumbnail-link 1041x316" href='http://oldrtfm.modx.com/download/attachments/35094766/import-tab.png'><img src="/download/thumbnails/35094766/import-tab.png" style="border: 1px solid black" /></a></span>
</p>

<div class='panelMacro'>
<table class='noteMacro'>
<colgroup>
<col width='24' />
<col />
</colgroup>

<tr>
<td valign='top'>
<img src="/images/icons/emoticons/warning.gif" width="16" height="16" align="absmiddle" alt="" border="0" />
</td>
<td>
It is important to note that this sets the default behavior - also when you did not specify it, as it will then default to being false!
</td>
</tr>
</table>
</div>

<p>
As of 1.0.0-rc you can set:
</p>

<ul>
<li>Parent: either an integer referencing an existing resource ID, or a context_key to import to the root of the context_key context, or 0 to import to the root of the default web context.
</li>

<li>Published: whether the resource should be published by default.
</li>

<li>Searchable: whether the resource should be searchable by default
</li>

<li>Hide from menus: whether the resource should be hidden from menus by default.
</li>
</ul>

<h3>
<a name="ImportX-Doingthemagic%28andtroubleshootingerrors%29"></a>Doing the magic (and troubleshooting errors)
</h3>

<p>
After clicking the "Start Import" button, the script will get to action and start parsing your CSV. If all is good, this is how the resulting output could look:
</p>

<p>
<span class="image-wrap" style=""><img src="/download/attachments/35094766/console.png?version=1&amp;modificationDate=1305658576000" style="border: 0px solid black" /></span>
<br />
At that point you can choose to download the output, or just close the window. The resource tree will refresh automagically after that to show what has happened.
</p>

<p>
If you get any other output, see the below table and what you could do to fix it.
</p>

<div class='table-wrap'>
<table class='confluenceTable'>
<tbody>
<tr>
<th class='confluenceTh'>
Error
<br class="atl-forced-newline" />
</th>
<th class='confluenceTh'>
Cause
<br class="atl-forced-newline" />
</th>
<th class='confluenceTh'>
How to fix
<br class="atl-forced-newline" />
</th>
</tr>

<tr>
<td class='confluenceTd'>
Please choose a Parent to import to. Specify 0 to put new resources in the root of the site.
</td>
<td class='confluenceTd'>
The "parent" field on the Default settings tab was empty. You will always need to specify either 0, a valid resource ID or a context_key.
<br class="atl-forced-newline" />
</td>
<td class='confluenceTd'>
Adjust the value in the "Parent" field on the default settings tab.
<br class="atl-forced-newline" />
</td>
</tr>

<tr>
<td class='confluenceTd'>
Parent not numeric or valid context key.
</td>
<td class='confluenceTd'>
<ol>
<li>The "parent" field is not numeric.
</li>

<li>A context_key value passed in the Default settings tab does not exist.
</li>
</ol>
</td>
<td class='confluenceTd'>
<ol>
<li>Change the parent field to a numeric value.
</li>

<li>Check the spelling of your context_key.
</li>
</ol>
</td>
</tr>

<tr>
<td class='confluenceTd'>
Parent needs to be a positive integer.
</td>
<td class='confluenceTd'>
You specified a negative number in the parent field.
<br class="atl-forced-newline" />
</td>
<td class='confluenceTd'>
Specify 0 or a positive number in the parent field.
<br class="atl-forced-newline" />
</td>
</tr>

<tr>
<td class='confluenceTd'>
Please add your CSV values in order for them to be processed.
</td>
<td class='confluenceTd'>
You didn't specify any CSV values.
<br class="atl-forced-newline" />
</td>
<td class='confluenceTd'>
Add some manual input or upload a file.
<br class="atl-forced-newline" />
</td>
</tr>

<tr>
<td class='confluenceTd'>
Error reading the uploaded file.
</td>
<td class='confluenceTd'>
You uploaded a file but there was an error reading it. This could be caused by an error in the file or an error on your server reading from the temporary folder.
<br class="atl-forced-newline" />
</td>
<td class='confluenceTd'>
Make sure your file is not corrupt. Possibly check your open_basedir settings.
<br class="atl-forced-newline" />
</td>
</tr>

<tr>
<td class='confluenceTd'>
Invalid CSV value posted.
</td>
<td class='confluenceTd'>
The total length of the CSV you posted was under 10 characters, and is considered invalid.
<br class="atl-forced-newline" />
</td>
<td class='confluenceTd'>
Make sure your CSV input is at least 10 characters long.
<br class="atl-forced-newline" />
</td>
</tr>

<tr>
<td class='confluenceTd'>
Not enough data given. Expecting at least one header row, and one data row.
</td>
<td class='confluenceTd'>
The script expects at least a header and value row and you didn't pass this. Note that a row is expected to be separated by a newline (\n).
<br class="atl-forced-newline" />
</td>
<td class='confluenceTd'>
Check your CSV input to make sure the rows are seperated with a newline.
<br class="atl-forced-newline" />
</td>
</tr>

<tr>
<td class='confluenceTd'>
Element count do not match. Please check for correct syntax on line [[+line]].
</td>
<td class='confluenceTd'>
One row has more or less elements, while this needs to be exactly the same for every row. A common cause would be the occurrence of the separator in a value field.
<br class="atl-forced-newline" />
</td>
<td class='confluenceTd'>
Make sure you use trailing separators consistently and your separator is not used in a field value. If it is, use a different seperataro.
<br class="atl-forced-newline" />
</td>
</tr>

<tr>
<td class='confluenceTd'>
An unexpected error occurred saving the resource.
</td>
<td class='confluenceTd'>
The MODX Processor returned an error. Prior to 1.0.0-pl this would only say "Array", but this was fixed in 1.0.0-pl. Various causes can cause this to show, but it will often involve security.
<br class="atl-forced-newline" />
</td>
<td class='confluenceTd'>
Depends on the specific error.
<br class="atl-forced-newline" />
</td>
</tr>

<tr>
<td class='confluenceTd'>
Your header has one or more invalid fieldnames. The invalid fieldname(s) is (are): [[+fields]].
</td>
<td class='confluenceTd'>
The header row has unrecognized fieldnames. It will output the errors. Make sure you spelled all the fields properly. In some cases when uploading a file encoding issues can arise due to the way it is being processed.
<br class="atl-forced-newline" />
</td>
<td class='confluenceTd'>
Fix the fieldnames (and use TVs in the form "tvN" where N is the id of the TV itself), or open your file in notepad and paste the content in the Raw CSV textarea.
<br class="atl-forced-newline" />
</td>
</tr>

<tr>
<td class='confluenceTd'>
[[+field]] ([[+int]] is expected to be an integer
</td>
<td class='confluenceTd'>
A header element was found that started with "tv", however [[+int]] is not a number and can't be used to find the TV to add data to.
<br class="atl-forced-newline" />
</td>
<td class='confluenceTd'>
Fix the header row element.
<br class="atl-forced-newline" />
</td>
</tr>

<tr>
<td class='confluenceTd'>
[[+field]] (no TV with an ID of [[+id]])
</td>
<td class='confluenceTd'>
A header element referencing a TV was found, but there was no TV with that ID.
<br class="atl-forced-newline" />
</td>
<td class='confluenceTd'>
Fix the header row element.
<br class="atl-forced-newline" />
</td>
</tr>
</tbody>
</table>
</div>

<h3>
<a name="ImportX-ExampleCSVandsomeCSVrelatednotes"></a>Example CSV and some CSV-related notes
</h3>

<div class="code panel" style="border-width: 1px;">
<div class="codeContent panelContent">
<pre class="code-java">
pagetitle;alias;isfolder
Analysing;analysing;1
Communicating;communicating;0
Rock solid copy;sepiariverstudios;0
Editing your resources remotely;modxmobile;0
</pre>
</div>
</div>

<p>
(Real basic bogus example, I welcome a better example!)
</p>

<p>
Here's some CSV-related notes:
</p>

<ol>
<li>Make sure you don't use the separator in the content field. You could use a separator like ";;;" when importing lots of content that may contain the default separator ";".
</li>

<li>When importing data which includes a template or user (createdby etc) column, make sure your CSV passes the ID of the related object, and not the name.
</li>

<li>You can import <b>TV Values</b> by creating column headings as "tv4" where 4 is the ID of the TV.
</li>
</ol>

<h3>
<a name="ImportX-ExecutionTimeIssues"></a>Execution Time Issues
</h3>

<p>
As of ImportX 1.1 the import will attempt to set the time limit and report you of the results.
</p>

<p>
If you are on Windows/IIS and suffer the script timing out after roughly 30 seconds, <a href="http://forums.modx.com/thread/71118/can-importx-import-7-000-records#dis-post-397394" class="external-link" rel="nofollow">check out the solutions posted on the forums</a>.
</p>

<h3>
<a name="ImportX-UpdatingDatainsteadofcreatingnewResources"></a>Updating Data instead of creating new Resources
</h3>

<p>
As of 1.1 you can change the importx.processor system setting from "create" to "update" to update resources based on the ID you pass along with the query. If the resource can't be find it will be created.
</p>

<h2>
<a name="ImportX-OtherformatsthanCSV"></a>Other formats than CSV
</h2>

<p>
As of 1.1, it is possible to add more formats as the addon has been somewhat normalized.
</p>

<p>
This can be achieved by writing a new class (see core/components/importx/processors/prepare/ - the prepare.class.php is the base class which you should extend, and csv.php is the current one in use) and changing the new importx.datatype system setting to the name of your file (minus the ".php" parts).
</p>

<p>
At this point there's only the CSV file, but I will very very very much appreciate someone coming up with XML or other formats. Feel free to contact me (hello@markhamstra.com) if you're interested but need some help figuring out what to do.
</p>

<h2>
<a name="ImportX-Andnow..."></a>And now...
</h2>

<p>
Go use it!
</p>

<p>
If you encounter any issues that were not mentioned above, please do let me know on Github: <a href="https://github.com/Mark-H/importX" class="external-link" rel="nofollow">https://github.com/Mark-H/importX</a>
</p>

<p>
Github is also the place to report Bugs and Feature requests. The issue tracker shows an overview of what features are planned for a later release as well.
</p>