<div>
<ul>
<li>
<a href="extras/revo/virtunewsletter#virtuNewsletter-virtuNewsletter">virtuNewsletter</a>
</li>

<li style="list-style: none; display: inline">
<ul>
<li>
<a href="extras/revo/virtunewsletter#virtuNewsletter-Download">Download</a>
</li>

<li>
<a href="extras/revo/virtunewsletter#virtuNewsletter-DevelopmentandBugReporting">Development and Bug Reporting</a>
</li>

<li>
<a href="extras/revo/virtunewsletter#virtuNewsletter-Howitworks">How it works</a>
</li>
</ul>
</li>

<li>
<a href="extras/revo/virtunewsletter#virtuNewsletter-EmailTemplates">Email Templates</a>
</li>

<li style="list-style: none; display: inline">
<ul>
<li>
<a href="extras/revo/virtunewsletter#virtuNewsletter-Tpl%3AThankyouforyoursubscription">Tpl: Thank you for your subscription</a>
</li>

<li>
<a href="extras/revo/virtunewsletter#virtuNewsletter-Tpl%3AYoursubscriptionhasbeenactivatedsuccessfully.">Tpl: Your subscription has been activated successfully.</a>
</li>

<li>
<a href="extras/revo/virtunewsletter#virtuNewsletter-Tpl%3AYouhavebeenunsubscribedsuccessfully.">Tpl: You have been unsubscribed successfully.</a>
</li>
</ul>
</li>

<li>
<a href="extras/revo/virtunewsletter#virtuNewsletter-SystemSettings">System Settings</a>
</li>

<li>
<a href="extras/revo/virtunewsletter#virtuNewsletter-Resources%2CSnippets%26aChunk">Resources, Snippets &amp; a Chunk</a>
</li>

<li style="list-style: none; display: inline">
<ul>
<li>
<a href="extras/revo/virtunewsletter#virtuNewsletter-1.Subscribe">1. Subscribe</a>
</li>

<li>
<a href="extras/revo/virtunewsletter#virtuNewsletter-2.Confirm">2. Confirm</a>
</li>

<li>
<a href="extras/revo/virtunewsletter#virtuNewsletter-3.Read">3. Read</a>
</li>

<li>
<a href="extras/revo/virtunewsletter#virtuNewsletter-4.aChunk">4. a Chunk</a>
</li>

<li>
<a href="extras/revo/virtunewsletter#virtuNewsletter-5.TheNewsletters">5. The Newsletters</a>
</li>
</ul>
</li>

<li>
<a href="extras/revo/virtunewsletter#virtuNewsletter-CustomManagerPage%28CMP%29">Custom Manager Page (CMP)</a>
</li>

<li style="list-style: none; display: inline">
<ul>
<li>
<a href="extras/revo/virtunewsletter#virtuNewsletter-Newsletters">Newsletters</a>
</li>

<li style="list-style: none; display: inline">
<ul>
<li>
<a href="extras/revo/virtunewsletter#virtuNewsletter-Category">Category</a>
</li>
</ul>
</li>

<li>
<a href="extras/revo/virtunewsletter#virtuNewsletter-Subscribers">Subscribers</a>
</li>
</ul>
</li>

<li>
<a href="extras/revo/virtunewsletter#virtuNewsletter-Cron">Cron</a>
</li>
</ul>
</div>

<h1>
<a name="virtuNewsletter-virtuNewsletter" id="virtuNewsletter-virtuNewsletter"></a>virtuNewsletter
</h1>

<p>
virtuNewsletter is another newsletter system for MODX Revolution.
</p>

<p>
If you want to read the old doc, please see here <a href="http://oldrtfm.modx.com/display/ADDON/virtuNewsletter.">http://oldrtfm.modx.com/display/ADDON/virtuNewsletter.</a>
</p>

<h2>
<a name="virtuNewsletter-Download" id="virtuNewsletter-Download"></a>Download
</h2>

<p>
It can be downloaded from within the MODx Revolution manager via <a href="display/revolution20/Package+Management" title="Package Management">Package Management</a>, or from the MODx Extras Repository, available here: <a href="http://modx.com/extras/package/virtunewsletter" class="external-link" rel="nofollow">http://modx.com/extras/package/virtunewsletter</a>
</p>

<h2>
<a name="virtuNewsletter-DevelopmentandBugReporting" id="virtuNewsletter-DevelopmentandBugReporting"></a>Development and Bug Reporting
</h2>

<p>
virtuNewsletteris stored and developed in GitHub, and can be found here: <a href="https://github.com/virtudraft/virtuNewsletter" class="external-link" rel="nofollow">https://github.com/virtudraft/virtuNewsletter</a>
</p>

<h2>
<a name="virtuNewsletter-Howitworks" id="virtuNewsletter-Howitworks"></a>How it works
</h2>

<p>
1. Set up a newsletter format using common Resource on the left tree
<br />
2. On the CMP, add a Category, as the newsletter group. In here, you may or may not apply usergroups to this category.
<br />
3. Then add a Newsletter, to this Category
<br />
4. <strong><em>is recurring</em></strong>, means that newsletter will be used recursively based on the given time range (weekly, monthly, or yearly), and split into the number of recurring (1 - monthly, 7 - weekly =&gt; means daily).
</p>

<p>
This system using web-accessible gateway for the cron to initiate.
<br />
This is useful for 3rd party web cron service outside of the web hosting.
<br />
Particularly, modxcloud doesn't provide cron job for its host service.
</p>

<p>
Read how to set it up in the Cron section below.
</p>

<h1>
<a name="virtuNewsletter-EmailTemplates" id="virtuNewsletter-EmailTemplates"></a>Email Templates
</h1>

<p>
You need to provide some email templates for confirmations.
<br />
These templates are resources, not chunks.
<br />
Leave them unpublished or hidden, it doesn't matter.
<br />
Its <strong>pagetitle</strong> will be the <em>subject</em> of the email.
<br />
Its <strong>content</strong> will be the <em>body</em> of the email.
<br />
<strong>ALL SNIPPETS AND CHUNKS</strong> will be processed.
</p>

<p>
So you can leave ,eg: getResources, snippets to give more update about your site inside the email's body.
</p>

<p>
By using resources, non-techie user won't be horrified with HTML tags if they want to edit the email's content.
</p>

<h2>
<a name="virtuNewsletter-Tpl:Thankyouforyoursubscription" id="virtuNewsletter-Tpl:Thankyouforyoursubscription"></a>Tpl: Thank you for your subscription
</h2>

<p>
Email template for subscribe confirmation.
<br />
The default is in <strong>core/components/virtunewsletter/elements/emails/activation-email.tpl</strong>
</p>

<pre class="brush: php">
[[!virtuNewsletter.confirm]]
</pre>
<h2>
<a name="virtuNewsletter-Tpl:Yoursubscriptionhasbeenactivatedsuccessfully." id="virtuNewsletter-Tpl:Yoursubscriptionhasbeenactivatedsuccessfully."></a>Tpl: Your subscription has been activated successfully.
</h2>

<p>
Email template for confirmed subscription.
<br />
The default is in <strong>core/components/virtunewsletter/elements/emails/activated-email.tpl</strong>
</p>

<pre class="brush: php">
    &lt;p&gt;Thank you.&lt;/p&gt;
&lt;p&gt;Your subscription has been cancelled successfully.&lt;/p&gt;
&lt;p&gt;We will no longer send you the upcoming newsletters.&lt;/p&gt;
&lt;p&gt; &lt;/p&gt;
&lt;p&gt;Regards,&lt;/p&gt;
&lt;p&gt;&lt;a href="http://www.example.com" target="_blank"&gt;Example.com&lt;/a&gt;&lt;/p&gt;
</pre>
<p>
At this point, the subscriber won't be removed from the system.
<br />
Only be deactivated.
</p>

<h1>
<a name="virtuNewsletter-SystemSettings" id="virtuNewsletter-SystemSettings"></a>System Settings
</h1>

<div class="table-wrap">
<table class="confluenceTable">
<tbody>
<tr>
<th class="confluenceTh">
Settings
</th>
<th class="confluenceTh">
description
</th>
</tr>

<tr>
<td class="confluenceTd">
virtunewsletter.usergroups
</td>
<td class="confluenceTd">
Fill up names of usergroups, delimited by comma, to make these usergroups will be automatically subscribed
</td>
</tr>

<tr>
<td class="confluenceTd">
<strong>virtunewsletter.email_debug</strong>
</td>
<td class="confluenceTd">
<strong>Turn this on to dump the email's placeholders to MODX's error log without sending the email</strong>
</td>
</tr>

<tr>
<td class="confluenceTd">
virtunewsletter.email_limit
</td>
<td class="confluenceTd">
Number of emails per hour for the cron job. Please consult your webhost about this. 0 (zero) or empty value means unlimited which will send all emails in 1 (one) batch. Default: 50.
</td>
</tr>

<tr>
<td class="confluenceTd">
virtunewsletter.email_sender
</td>
<td class="confluenceTd">
From whom the newsletter comes from as the Email's header. Default is any value in the System Setting's <strong>emailsender</strong>
</td>
</tr>

<tr>
<td class="confluenceTd">
virtunewsletter.subscribe_confirmation_tpl
</td>
<td class="confluenceTd">
Resource's ID as the email template for the new subscription, as the above <em>Tpl: Thank you for your subscription</em>
</td>
</tr>

<tr>
<td class="confluenceTd">
virtunewsletter.subscribe_succeeded_tpl
</td>
<td class="confluenceTd">
Resource's ID as the email template for the unsubscription confirmation
</td>
</tr>

<tr>
<td class="confluenceTd">
virtunewsletter.unsubscribe_confirmation_tpl
</td>
<td class="confluenceTd">
Resource's ID as the email template for the unsubscription
</td>
</tr>

<tr>
<td class="confluenceTd">
virtunewsletter.unsubscribe_succeeded_tpl
</td>
<td class="confluenceTd">
Resource's ID as the email template for the completed confirmation of the unsubscription
</td>
</tr>

<tr>
<td class="confluenceTd">
virtunewsletter.readerpage
</td>
<td class="confluenceTd">
Resource's ID where visitor can access the newsletter via web
</td>
</tr>
</tbody>
</table>
</div>

<h1>
<a name="virtuNewsletter-Resources,Snippets&amp;aChunk"></a>Resources, Snippets &amp; a Chunk
</h1>

<p>
You need to create 3 more resources with its own snippet in it:
</p>

<h2>
<a name="virtuNewsletter-1.Subscribe" id="virtuNewsletter-1.Subscribe"></a>1. Subscribe
</h2>

<p>
<strong>Example: this is the ID# 61 for the subscribe form below.</strong>
</p>

<pre class="brush: php">
    [[!virtuNewsletter.confirm]]
</pre>
<h2>
<a name="virtuNewsletter-3.Read" id="virtuNewsletter-3.Read"></a>3. Read
</h2>

<p>
<strong>Example: this is the ID# 63 for the link in the email's body of the newsletter below.</strong>
<br />
This resource will be the website's newsletter reader page.
<br />
Use the MODX's original <strong>BaseTemplate</strong>, without any CSS styles.
</p>

<pre class="brush: php">
    [[!virtuNewsletter.reader? &amp;toArray=`1`]]
</pre>
<h2>
<a name="virtuNewsletter-4.aChunk" id="virtuNewsletter-4.aChunk"></a>4. a Chunk
</h2>

<p>
The subscribe form (can be a chunk) is simply like this:
</p>

<pre class="brush: php">
&lt;form action="[[~61]]" method="POST"&gt;
    &lt;p&gt;Email: &lt;input type="email" name="email"&gt;&lt;/p&gt;
    &lt;input type="hidden" name="category" value="Customer News"&gt;
    &lt;p&gt;&lt;input type="submit" name="submit" value="Subscribe"&gt;&lt;/p&gt;
&lt;/form&gt;
</pre>
<p>
<strong>NO FORMIT, NO HOOK!</strong>
<br />
Simply point the action to the Subscribe page above.
<br />
The <strong>category</strong> field is required to set the subscriber to the appropriate <strong>Category</strong> inside the CMP.
<br />
The name itself can be changed, but make sure you have to apply this also to the <strong>[[!virtuNewsletter.subscribe? &amp;categoryKey=`category`]]</strong>
</p>

<h2>
5. The Newsletters
</h2>

<p>
You are now ready to create the newsletters using the common resource.
</p>

<p>
1. Create another template that will be acting as the email's body, means without &lt;!DOCTYPE&gt; and &lt;head&gt; tags.
</p>

<p>
2. Put the CSS styles inside the tag, and it will parsed automatically inline to the email's body.
</p>

<p>
3. You might also want to add these placeholders as the unsubscribe link, or link to read this on your website:
</p>

<pre class="brush: php">
&lt;!-- unsubscribe link --&gt;
&lt;a href="[[~62? 
&amp;subid=`[[+virtuNewsletter.email.id]]` 
&amp;h=`[[+virtuNewsletter.email.hash]]`
&amp;act=`unsubscribe`
&amp;scheme=`full`
]]"&gt;
Unsubscribe
&lt;/a&gt;
&lt;!-- read the newsletter on the website --&gt;
&lt;a href="[[~63?
&amp;newsid=`[[+virtuNewsletter.email.id]]`
&amp;scheme=`full`
]]"&gt;read this newsletter on the website&lt;/a&gt;
</pre>
<p>
Just remember to always put <strong>&amp;scheme=`full`</strong> to all link tags, so they will be appended with the full URL of the website.
</p>

<h1>
<a name="virtuNewsletter-CustomManagerPage(CMP)"></a>Custom Manager Page (CMP)
</h1>

<h2>
<a name="virtuNewsletter-Newsletters" id="virtuNewsletter-Newsletters"></a>Newsletters
</h2>

<h3>
<a name="virtuNewsletter-Category" id="virtuNewsletter-Category"></a>Category
</h3>

<p>
Category is a group definition of subscribers.
<br />
The subscriber can be from usergroups, or anonymous subscriber from web page, whom registered using the subscription form.
<br />
Because this is required for newsletter, then the subscription form <strong>MUST</strong> have category field (or anything you define which matches with [[!virtuNewsletter.subscriber? &amp;categoryKey=`category`]] controller snippet).
</p>

<p>
So in CMP, you have to create a Category first.
</p>

<h2>
<a name="virtuNewsletter-Subscribers" id="virtuNewsletter-Subscribers"></a>Subscribers
</h2>

<h1>
<a name="virtuNewsletter-Cron" id="virtuNewsletter-Cron"></a>Cron
</h1>

<p>
To use cron in your own hosting, set this command:
</p>

<pre class="brush: php">
php -q /home/xxx[absolute_path]xxx/public_html/assets/components/virtunewsletter/conn/web.php?action=web/crons/queues/process&amp;site_id=modx12abc345678d90.12345678
</pre>
<p>
If you use 3rd party cron service, point the address to:
</p>

<pre class="brush: php">
&lt;a href="http://www.your_cool_website.com/assets/components/virtunewsletter/conn/web.php?action=web/crons/queues/process&amp;site_id=modx12abc345678d90.12345678"&gt;http://www.your_cool_website.com/assets/components/virtunewsletter/conn/web.php?action=web/crons/queues/process&amp;site_id=modx12abc345678d90.12345678&lt;/a&gt;
</pre>
<p>
<strong>site_id</strong> is required!
<br />
Replace <strong>site_id=modx12abc345678d90.12345678</strong> with your site's ID.
<br />
Look for it inside the core/config/config.inc.php, check the <strong>$site_id</strong> variable.
</p>

<div class="warning">
<strong>Heads Up</strong>
<br />
Do not share this site_id to anybody else!
<br />
This is the MODX's secret to prevent cross-site scripting.
<br />
If you want to ask something on the forum, remember to REPLACE THIS VALUE!
</div>