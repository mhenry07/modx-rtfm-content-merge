<p>
The bdListings snippet can be used to present search results, a generic listing overview and more.
</p>

<h2>
<a name="bdListings.bdListings-SnippetProperties" id="bdListings.bdListings-SnippetProperties"></a>Snippet Properties
</h2>

<h3>
<a name="bdListings.bdListings-GeneralProperties" id="bdListings.bdListings-GeneralProperties"></a>General Properties
</h3>

<div class='table-wrap'>
<table class='confluenceTable'>
<tbody>
<tr>
<th class='confluenceTh'>
Property Name
</th>
<th class='confluenceTh'>
Description
</th>
<th class='confluenceTh'>
Default Value
</th>
</tr>

<tr>
<td class='confluenceTd'>
limit
</td>
<td class='confluenceTd'>
Maximum number of results, or 0 for all listings.
</td>
<td class='confluenceTd'>
0
</td>
</tr>

<tr>
<td class='confluenceTd'>
offset
</td>
<td class='confluenceTd'>
Optional offset (for use with pagination, you can use getPage for that).
</td>
<td class='confluenceTd'>
0
</td>
</tr>

<tr>
<td class='confluenceTd'>
sort
</td>
<td class='confluenceTd'>
JSON string to allow sorting on multiple factors with different directions. Fields you can use in this property and &amp;sortby are:
<ul>
<li>id
</li>

<li>title
</li>

<li>description
</li>

<li>keywords
</li>

<li>price
</li>

<li>createdon
</li>

<li>publisheduntil
</li>

<li>featured
</li>

<li>companyname
</li>

<li>contactinfo
</li>

<li>address
</li>

<li>phone
</li>

<li>email
</li>

<li>neighborhood
</li>

<li>zip
</li>

<li>city
</li>

<li>country
</li>

<li>website
</li>

<li>latitude
</li>

<li>longitude
</li>

<li>category_name
</li>

<li>category_description
</li>

<li>subcategory_name (may not exist)
</li>

<li>subcategory_description (may not exist)
</li>

<li>target_name (may not exist)
</li>

<li>pricegroup_display (may not exist)
</li>
</ul>
</td>
<td class='confluenceTd'>
<div class="preformatted panel" style="border-width: 1px;">
<div class="preformattedContent panelContent">
<pre>
{"city": "ASC", "neighborhood": "ASC", "companyname": "ASC" }
</pre>
</div>
</div>
</td>
</tr>

<tr>
<td class='confluenceTd'>
sortby
</td>
<td class='confluenceTd'>
When &amp;sort is empty or not a valid JSON string (hint: use &amp;sort=`` to overrule the default), you can define a property to sort on with this.
</td>
<td class='confluenceTd'>
title
</td>
</tr>

<tr>
<td class='confluenceTd'>
sortdir
</td>
<td class='confluenceTd'>
[ASC|DESC] When &amp;sort is empty or not a valid JSON string you can define ascending or descending sort order with this property.
</td>
<td class='confluenceTd'>
ASC
</td>
</tr>

<tr>
<td class='confluenceTd'>
activeOnly
</td>
<td class='confluenceTd'>
[1|0] If 1 (true) will only show active items.
</td>
<td class='confluenceTd'>
1
</td>
</tr>

<tr>
<td class='confluenceTd'>
featuredOnly
</td>
<td class='confluenceTd'>
[1|0] If 1 (true) will only show featured items.
</td>
<td class='confluenceTd'>
0
</td>
</tr>

<tr>
<td class='confluenceTd'>
where
</td>
<td class='confluenceTd'>
Optional JSON encoded limits.
</td>
<td class='confluenceTd'>
&nbsp;
</td>
</tr>

<tr>
<td class='confluenceTd'>
acceptUrlParams
</td>
<td class='confluenceTd'>
[1|0] Allow specific url params (see acceptedUrlParams) to override properties you set in the snippet call / default values.
</td>
<td class='confluenceTd'>
1
</td>
</tr>

<tr>
<td class='confluenceTd'>
acceptedUrlParams
</td>
<td class='confluenceTd'>
Comma separated list of properties that are allowed to override what's set in the snippet call or default values.
</td>
<td class='confluenceTd'>
query, keyword, target, pricegroup, city, category, subcategory, sort, listings
</td>
</tr>

<tr>
<td class='confluenceTd'>
redirectResource
</td>
<td class='confluenceTd'>
<b>Required if using click tracking.</b> The Resource ID to use as redirect resource. See <a href="display/ADDON/bdListings.bdRedirect" title="bdListings.bdRedirect">bdRedirect</a> as well.
</td>
<td class='confluenceTd'>
39
</td>
</tr>

<tr>
<td class='confluenceTd'>
rowSeparator
</td>
<td class='confluenceTd'>
Separator to use between listings.
</td>
<td class='confluenceTd'>
a line break (\n)
</td>
</tr>

<tr>
<td class='confluenceTd'>
imageSeparator
</td>
<td class='confluenceTd'>
Separator to use between images of a listing.
</td>
<td class='confluenceTd'>
a line break (\n)
</td>
</tr>

<tr>
<td class='confluenceTd'>
emptyValue
</td>
<td class='confluenceTd'>
A value (hint: could be a chunk tag) to display when there are no results.
</td>
<td class='confluenceTd'>
&lt;p&gt;No listings found :(&lt;/p&gt; (bdlistings.noresults lexicon key)
</td>
</tr>

<tr>
<td class='confluenceTd'>
trackViews
</td>
<td class='confluenceTd'>
[1|0] When 1, the snippet will increment the "views" field for listings in the displayed result set. Can be useful if you have certain lists you don't want to influence the view count. Added in 1.1.1-pl.
</td>
<td class='confluenceTd'>
1
</td>
</tr>
</tbody>
</table>
</div>

<h2>
<a name="bdListings.bdListings-FilteringProperties" id="bdListings.bdListings-FilteringProperties"></a>Filtering Properties
</h2>

<div class='table-wrap'>
<table class='confluenceTable'>
<tbody>
<tr>
<th class='confluenceTh'>
Property Name
</th>
<th class='confluenceTh'>
Description
</th>
</tr>

<tr>
<td class='confluenceTd'>
query
</td>
<td class='confluenceTd'>
Full-text search that uses a loose match against the title and description of a listing.
</td>
</tr>

<tr>
<td class='confluenceTd'>
keyword
</td>
<td class='confluenceTd'>
Full-text search that uses a loose match against the keyword field.
</td>
</tr>

<tr>
<td class='confluenceTd'>
target
</td>
<td class='confluenceTd'>
ID of a target as defined in the component to match against.
</td>
</tr>

<tr>
<td class='confluenceTd'>
pricegroup
</td>
<td class='confluenceTd'>
ID of a price group as defined in the component to match against.
</td>
</tr>

<tr>
<td class='confluenceTd'>
city
</td>
<td class='confluenceTd'>
Loose match against the city field.
</td>
</tr>

<tr>
<td class='confluenceTd'>
category
</td>
<td class='confluenceTd'>
Either the category name (exact match) or ID to filter on. As of 1.1.2 this will also search subcategories (name or ID).
</td>
</tr>

<tr>
<td class='confluenceTd'>
subcategory
</td>
<td class='confluenceTd'>
Either the subcategory name (exact match) or ID to filter on.
</td>
</tr>

<tr>
<td class='confluenceTd'>
listings
</td>
<td class='confluenceTd'>
If you want to show only a specific set of listings, this can be a comma separated list of their IDs.
</td>
</tr>
</tbody>
</table>
</div>

<p>
Tip: by default each of these are accepted as URL properties (or POST values) so they are great to offer as filtering options to your site visitor.
</p>

<h2>
<a name="bdListings.bdListings-TemplatingChunks" id="bdListings.bdListings-TemplatingChunks"></a>Templating Chunks
</h2>

<h3>
<a name="bdListings.bdListings-tplOuter" id="bdListings.bdListings-tplOuter"></a>tplOuter
</h3>

<p>
Wraps around all the individual items.
</p>

<p>
Default:
</p>

<pre class="brush: php">
    &lt;div&gt;
    &lt;h2&gt;
        [[+redirect_url:notempty=`&lt;a href="[[+redirect_url]]"&gt;[[+title]]&lt;/a&gt;`:default=`[[+title]]`]]
    &lt;/h2&gt;
    [[+images:notempty=`&lt;p&gt;[[+primaryimage:notempty=`&lt;img src="[[+primaryimage:phpthumbof=`w=300&amp;h=200`]]" alt="[[+title]]" /&gt;&lt;br /&gt;`]] [[+images]]&lt;/p&gt;`]]
    &lt;p&gt;In [[+city]] - [[+neighborhood]] - [[+companyname]] - &lt;a href="[[+redirect_url]]"&gt;[[+companyname]]&lt;/a&gt;&lt;/p&gt;
    [[+description:notempty=`&lt;p&gt;[[+description:nl2br]]&lt;/p&gt;`]]
    [[+googlemap_url:notempty=`&lt;a href="[[+googlemap_url]]" title="View on Google Maps"&gt;&lt;img src="[[+googlemap_static]]" alt="Google Maps"&gt;&lt;/a&gt;`]]
&lt;/div&gt;

    
</pre>
<p>
There's a lot of placeholders you can use there, and some properties have a direct influence on their value. Especially think of the redirect_url (which is influenced by &amp;redirectResource) and the googlemap_static placeholder which is a link generated based on the staticMap* properties (see further below).
</p>

<p>
Placeholders:
</p>

<ul>
<li>title
</li>

<li>description
</li>

<li>keywords
</li>

<li>price
</li>

<li>pricegroup / pricegroup_id (id)
</li>

<li>pricegroup_display
</li>

<li>category / category_id (id)
</li>

<li>category_name
</li>

<li>category_description
</li>

<li>subcategory / subcategory_id (id)
</li>

<li>subcategory_name
</li>

<li>subcategory_description
</li>

<li>target / target_id (id)
</li>

<li>target_name
</li>

<li>createdon (use with strtotime and date output modifiers)
</li>

<li>publisheduntil (use with strtotime and date output modifiers)
</li>

<li>active (1/0)
</li>

<li>featured (1/0)
</li>

<li>extended (1/0)
</li>

<li>companyname
</li>

<li>contactinfo
</li>

<li>address
</li>

<li>phone
</li>

<li>email
</li>

<li>neighborhood
</li>

<li>zip
</li>

<li>city
</li>

<li>country
</li>

<li>website
</li>

<li>latitude
</li>

<li>longitude
</li>

<li>clicks
</li>

<li>views
</li>

<li>googlemap_static: url to a static google map image (based on your map snippet properties, see further below). Empty if no lat/long is set.
</li>

<li>googlemap_url: url to maps.google.com/maps?q=LATITUDE,LONGITUDE. Empty if no lat/long is set.
</li>

<li>redirect_url: url to the &amp;redirectResource resource with the "lid" property and the listing ID as its value, used to redirect to the website set for the listing while tracking clicks. Empty if no website is set.
</li>

<li>images: filled with individual images templated with the tplImage chunk, separated by the imageSeparator property.
</li>

<li>primaryimage: if you have an image marked as primary, this will have the link (so not the tplImage tpl) to the image. If you don't have an image marked as primary it will attempt to use the first image.
</li>

<li>primaryimagepath: path to the image set in primaryimage.
</li>
</ul>

<h3>
<a name="bdListings.bdListings-tplImage%28lowerLthenupperi%29"></a>tplImage (lower L then upper i)
</h3>

<p>
Used to wrap around images inside a listing. (not used for the primaryimage property in the tplRow chunk)
</p>

<p>
Default:
</p>

<pre class="brush: php">
    http://chart.apis.google.com/chart?chst=d_map_pin_icon&amp;chld=cafe%7C996600

    
</pre>
<table>
<tr>
<td class='confluenceTd'>
&nbsp;
</td>
</tr>

<tr>
<td class='confluenceTd'>
staticMapMarkerIconShadow
</td>
<td class='confluenceTd'>
["true" or "false", actual text so NOT 1 or 0] To use shadow or not when using a custom icon.
</td>
<td class='confluenceTd'>
true
</td>
</tr>
</table>

<h2>
<a name="bdListings.bdListings-Examples" id="bdListings.bdListings-Examples"></a>Examples
</h2>

<p>
Last 5 listings, simple list format:
</p>

<pre class="brush: php">
    &lt;li&gt;
  &lt;a href="[[~14? &amp;listings=`[[+id]]`]]" title="[[+title]]"&gt;[[+title]]&lt;/a&gt;
&lt;/li&gt;

    
</pre>